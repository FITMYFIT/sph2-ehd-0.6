cscope 15 $HOME/sph201909/sph2-ehd-0.3               0000237492
	@BaseGridNode.cpp

1 
	~"Ba£GridNode.h
"

3 
	gCBa£GridNode
::
	$CBa£GridNode
(
ID
)

4 :
	`_ID
(
ID
),
	`_Cs
(0.0),
	`_div
(0.0),
	$_C
(0.0)

6 
	}
}

8 
	gCBa£GridNode
::~
	$CBa£GridNode
()

10 
	}
}

	@BaseGridNode.h

16 #iâdeà
_BASEGRIDNODE_H_


17 
	#_BASEGRIDNODE_H_


	)

19 şas 
	cCBa£GridNode


21 
	mpublic
:

23 
CBa£GridNode
(
ID
=0);

25 ~
CBa£GridNode
();

27 
	m_ID
;

29 
	m_x
;

31 
	m_y
;

33 
	m_z
;

35 
	m_C
;

37 
	m_Cs
;

39 
	m_div
;

41 
	m´iv©e
:

	@BasePt.cpp

1 
	~"Ba£Pt.h
"

4 
	gCBa£Pt
::
	$CBa£Pt
()

6 
	}
}

8 
CBa£Pt
::
	$CBa£Pt
(
’PTTYPE
 
±ty³
,
ID
, 
PID
)

9 :
	`_Ty³
(
±ty³
),
	`_ID
(
ID
),
	$_PID
(
PID
)

11 
	}
}

14 
	gCBa£Pt
::
	$CBa£Pt
(
ID
, 
PID
)

15 :
	`_ID
(
ID
),
	$_PID
(
PID
)

17 
	}
}

19 
	gCBa£Pt
::~
	$CBa£Pt
()

21 
	}
}

	@BasePt.h

16 #iâdeà
_BASEPT_H_


17 
	#_BASEPT_H_


	)

19 
	e’PTTYPE
 {
	m’SPHPt
=1, 
	m’NULLPt
,
	m’BndPt
,
	m’Gho¡1Pt
,
	m’Gho¡2Pt
,
	m’DumPt
,
	m’EHDDumPt
,
	m’EHDBndPt
};

21 şas 
	cCBa£Pt


23 
	mpublic
:

25 
CBa£Pt
();

27 
CBa£Pt
(
’PTTYPE
 
±ty³
,
ID
, 
PID
);

29 
CBa£Pt
(
ID
, 
PID
);

31 ~
CBa£Pt
();

33 
’PTTYPE
 
	m_Ty³
;

35 
	m_Iæag
;

37 
	m_ID
;

39 
	m_ID2
;

40 
	m_ID3
;

42 
	m_PID
;

44 
	m_x
;

46 
	m_y
;

48 
	m_z
;

51 
	m_m
;

53 
	m_rho
;

55 
	m_rho0
;

57 
	m_mrho
;

60 
	m_p
;

62 
	m_u
;

63 
	m_v
;

64 
	m_w
;

67 
	m_T
;

69 
	m_Cs
;

71 
	m_h
;

72 
	m_H
;

74 
	m_r
;

75 
	m_¼
;

77 
	m_VŞume
;

80 
	m_drho
;

81 
	m_du
;

82 
	m_dv
;

83 
	m_dw
;

85 
	m_rhoHf
;

86 
	m_uHf
;

87 
	m_vHf
;

88 
	m_wHf
;

91 
	m_hHf
;

92 
	m_dh
;

94 
	m_VisE
;

96 
	m_VisGamma
;

99 
	m_uXSPHCÛf
;

100 
	m_vXSPHCÛf
;

101 
	m_wXSPHCÛf
;

104 
	m_e
;

105 
	m_de
;

106 
	m_eHf
;

109 
	m_nx
,
	m_ny
,
	m_nz
;

110 
	m_Nnx
,
	m_Nny
,
	m_Nnz
;

111 
	m_Curv©u»
;

112 
	m_midcurve
;

113 
	m_midcÜ»ù
;

116 
	m_C0
;

117 
	m_C
;

119 
	m_CSPMCÛf
;

121 
	m_CSPMAxx
;

122 
	m_CSPMAxy
;

123 
	m_CSPMAxz
;

124 
	m_CSPMAyx
;

125 
	m_CSPMAyy
;

126 
	m_CSPMAyz
;

127 
	m_CSPMAzx
;

128 
	m_CSPMAzy
;

129 
	m_CSPMAzz
;

131 
	m_CSPMmšLambda
;

135 
	m_sxx
;

136 
	m_sxy
;

137 
	m_sxz
;

138 
	m_syy
;

139 
	m_syz
;

140 
	m_szz
;

143 
	m_AccBndx
;

144 
	m_AccBndy
;

146 
	m_Di¡ªûBnd
;

148 
	m_uw®l
;

149 
	m_vw®l
;

152 
	m_NumNegbÜ
;

153 
	m_r0
;

154 
	m_PtSháCÛfu
;

155 
	m_PtSháCÛfv
;

156 
	m_PtSháCÛfw
;

159 
	m_eEpsÚ
;

160 
	m_eK­·
;

161 
	m_ePhi
;

162 
	m_eEx
;

163 
	m_eEy
;

164 
	m_eRho
;

165 
	m_deRho
;

166 
	m_geEpsÚx
;

167 
	m_geEpsÚy
;

169 
	m_Fex
,
	m_Fey
;

171 
	m´iv©e
:

	@BndForce.cpp

1 
	~"BndFÜû.h
"

3 
	gCBndFÜû
::
	$CBndFÜû
()

5 
	}
}

7 
CBndFÜû
::~
	$CBndFÜû
()

9 
	}
}

11 
CBndFÜû
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

15 
uij
,
vij
;

16 
njx
,
njy
;

17 
xij
,
yij
;

18 
bndnÜm
;

19 
cs
;

20 
hij
;

21 
IDi
,
IDj
;

23 
pi
,
pj
;

24 
mi
,
mj
;

25 
rhoi
,
rhoj
;

26 
moduËv
;

111 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

113 ià(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHDumPtPaœ
)

115 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

116 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

118 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

120 
njx
=
PtjPŒ
->
_Nnx
;

121 
njy
=
PtjPŒ
->
_Nny
;

123 
pi
=
PtiPŒ
->
_p
;

124 
pj
=
PtjPŒ
->
_p
;

126 
mi
=
PtiPŒ
->
_m
;

127 
mj
=
PtjPŒ
->
_m
;

129 
rhoi
=
PtiPŒ
->
_rho
;

130 
rhoj
=
PtjPŒ
->
_rho
;

132 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

133 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

135 
moduËv
=
	`sq¹
(
PtiPŒ
->
_u
*PtiPŒ->_u+PtiPŒ->
_v
*PtiPtr->_v);

139 ià(
pi
+
pj
>0)

141 
bndnÜm
=
mj
*(
pi
+
pj
)/
rhoi
/
rhoj
*(
KÆPŒ
->
_Wx
*
njx
+KÆPŒ->
_Wy
*
njy
);

144 
PtiPŒ
->
_du
-=
bndnÜm
*
njx
;

145 
PtiPŒ
->
_dv
-=
bndnÜm
*
njy
;

147 
PtiPŒ
->
_AccBndx
-=
bndnÜm
*
njx
;

148 
PtiPŒ
->
_AccBndy
-=
bndnÜm
*
njy
;

154 
	}
}

	@BndForce.h

16 #iâdeà
_BNDFORCE_H_


17 
	#_BNDFORCE_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"O³¿tÜ.h
"

23 şas 
	cCBndFÜû


25 
	mpublic
:

26 
CBndFÜû
();

28 ~
CBndFÜû
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
);

32 
	m´iv©e
:

33 
CO³¿tÜ
 
_O³¿tÜB
;

	@Box.cpp

1 
	~"Box.h
"

2 
	~<cm©h
>

4 
	gCBox
::
	$CBox
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
)

5 :
	`_C–lNumx
(
C–lNumx
),
	`_C–lNumy
(
C–lNumy
),
	`_C–lLi¡
(C–lNumx*C–lNumy,
¡d
::
veùÜ
<
CBa£Pt
 *>(0,
NULL
))

7 
	}
}

9 
	gCBox
::~
	$CBox
()

11 
	}
}

13 
CBox
::
	$Resize
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
)

15 
_C–lNumx
=
C–lNumx
;

16 
_C–lNumy
=
C–lNumy
;

18 
_C–lLi¡
.
	`»size
(
C–lNumx
*
C–lNumy
,
¡d
::
veùÜ
<
CBa£Pt
 *>(0,
NULL
));

19 
	}
}

21 
	gCBox
::
	$Upd©eBox
(
CRegiÚ
 & 
RegiÚ
)

23 
	`S‘MPošt
(
RegiÚ
);

24 
	`PutPt2C–l
(
RegiÚ
);

25 
	}
}

27 
	gCBox
::
	$S‘MPošt
(
CRegiÚ
 & 
RegiÚ
)

29 
dp
;

30 
ID
;

33 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

35 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

37 
_MaxPoštx
=
RegiÚ
.
_PtLi¡
[
i
].
_x
;

38 
_MaxPošty
=
RegiÚ
.
_PtLi¡
[
i
].
_y
;

40 
_MšPoštx
=
RegiÚ
.
_PtLi¡
[
i
].
_x
;

41 
_MšPošty
=
RegiÚ
.
_PtLi¡
[
i
].
_y
;

43 
_MšPošŒ
=
RegiÚ
.
_PtLi¡
[
i
].
_r
;

50 
size_t
 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

52 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

54 if(
_MaxPoštx
<
RegiÚ
.
_PtLi¡
[
i
].
_x
) _MaxPointx=Region._PtList[i]._x;

55 if(
_MaxPošty
<
RegiÚ
.
_PtLi¡
[
i
].
_y
) _MaxPointy=Region._PtList[i]._y;

57 if(
_MšPoštx
>
RegiÚ
.
_PtLi¡
[
i
].
_x
) _MinPointx=Region._PtList[i]._x;

58 if(
_MšPošty
>
RegiÚ
.
_PtLi¡
[
i
].
_y
) _MinPointy=Region._PtList[i]._y;

60 if(
_MšPošŒ
>
RegiÚ
.
_PtLi¡
[
i
].
_r
) _MinPointr=Region._PtList[i]._r;

64 
_MšPošŒ
=
RegiÚ
.
_PtLi¡
[0].
_r
;

66 
_MaxPoštx
+=
_MšPošŒ
*0.5;

67 
_MšPoštx
-=
_MšPošŒ
*0.5;

69 
_MaxPošty
+=
_MšPošŒ
*0.5;

70 
_MšPošty
-=
_MšPošŒ
*0.5;

73 
dp
=
	`pow
(
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[0]].
_VŞume
,0.5);

75 
_C–lNumx
=
	`size_t
((
_MaxPoštx
-
_MšPoštx
)/
dp
*1.0);

76 
_C–lNumy
=
	`size_t
((
_MaxPošty
-
_MšPošty
)/
dp
*1.0);

78 if(
_C–lNumx
>
RegiÚ
.
_CÚŒŞSPH
._CellNumx)

79 
_C–lNumx
=
RegiÚ
.
_CÚŒŞSPH
._CellNumx;

80 if(
_C–lNumy
>
RegiÚ
.
_CÚŒŞSPH
._CellNumy)

81 
_C–lNumy
=
RegiÚ
.
_CÚŒŞSPH
._CellNumy;

83 
cout
<<"ûÎ‚um x:"<<
_C–lNumx
<<
’dl
;

84 
cout
<<"ûÎ‚um y:"<<
_C–lNumy
<<
’dl
;

86 
_C–lSizex
=(
_MaxPoštx
-
_MšPoštx
)/(
_C–lNumx
);

87 
_C–lSizey
=(
_MaxPošty
-
_MšPošty
)/(
_C–lNumy
);

90 
_C–lLi¡
.
	`»size
(
_C–lNumx
*
_C–lNumy
,
¡d
::
veùÜ
<
CBa£Pt
 *>(0,
NULL
));

92 
size_t
 
i
=0;i<
_C–lLi¡
.
	`size
();i++)

94 
_C–lLi¡
[
i
].
	`ş—r
();

96 
	}
}

98 
	gCBox
::
	$PutPt2C–l
(
CRegiÚ
 & 
RegiÚ
)

100 
xM
,
yM
;

101 
size_t
 
xI
,
yI
;

102 
ID
;

105 
size_t
 
i
=0; i!=
RegiÚ
.
_PtLi¡
.
	`size
();i++)

107 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

109 
xM
=
RegiÚ
.
_PtLi¡
[
i
].
_x
-
_MšPoštx
;

110 
yM
=
RegiÚ
.
_PtLi¡
[
i
].
_y
-
_MšPošty
;

112 
xI
=
	`size_t
(
	`æoÜ
(
xM
/
_C–lSizex
));

113 
yI
=
	`size_t
(
	`æoÜ
(
yM
/
_C–lSizey
));

115 
_C–lLi¡
[
yI
*
_C–lNumx
+
xI
].
	`push_back
(&
RegiÚ
.
_PtLi¡
[
i
]);

118 
	}
}

120 
	gCBox
::
G‘Nbl
(
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
)

122 
dxŸc
;

123 
	gdyŸc
;

124 
	gdrŸc2
;

126 
	gdxŸc2
;

127 
	gdyŸc2
;

128 
	gr2
;

129 
	gID
;

130 
	gr2
=
r
*r;

132 
	gPtNbLi¡
.
»size
(0,
NULL
);

135 
	gxM
,
	gyM
;

136 
size_t
 
	gxI
,
	gyI
;

137 
	gxM
=
x
-
_MšPoštx
;

138 
	gyM
=
y
-
_MšPošty
;

140 
	gxI
=
size_t
(
æoÜ
(
xM
/
_C–lSizex
));

141 
	gyI
=
size_t
(
æoÜ
(
yM
/
_C–lSizey
));

144 
	gNxI
;

145 
	gNyI
;

146 
	grsizex
;

147 
	grsizey
;

149 
	grsizex
=
size_t
(
æoÜ
(
r
/
_C–lSizex
)+1);

150 
	grsizey
=
size_t
(
æoÜ
(
r
/
_C–lSizey
)+1);

152 
	gi
=-
rsizex
;i<=rsizex;i++)

154 
	gNxI
=
xI
+
i
;

155 if(
	gNxI
>=0&&
NxI
<
_C–lNumx
)

157 
j
=-
rsizey
;
	gj
<=rsizey;j++)

159 
	gNyI
=
yI
+
j
;

160 if(
	gNyI
>=0&&
NyI
<
_C–lNumy
)

162 
size_t
 
f
=0;
	gf
<
	g_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
].
size
();f++)

164 
	gdxŸc
=
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]->
_x
-
x
;

165 
	gdyŸc
=
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]->
_y
-
y
;

167 
	gdxŸc2
=
dxŸc
*dxiac;

168 
	gdyŸc2
=
dyŸc
*dyiac;

170 
	gdrŸc2
=
dxŸc2
+
dyŸc2
;

172 if(
	gdrŸc2
<=
r2
)

174 
PtNbLi¡
.
push_back
(
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]);

183 
	gCBox
::
G‘Nbl2
(
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
,
CRegiÚ
 & 
RegiÚ
)

185 
	gdxŸc
;

186 
	gdyŸc
;

187 
	gdrŸc2
;

189 
	gdxŸc2
;

190 
	gdyŸc2
;

191 
	gr2
;

192 
	gID
,
	gC–lID
;

193 
	gMAXX
,
	gMINX
;

195 
	gMAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

196 
	gMINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

198 
	gr2
=
r
*r;

200 
	gPtNbLi¡
.
»size
(0,
NULL
);

203 
	gxM
,
	gyM
;

204 
size_t
 
	gxI
,
	gyI
;

205 
	gxM
=
x
-
_MšPoštx
;

206 
	gyM
=
y
-
_MšPošty
;

208 
	gxI
=
size_t
(
æoÜ
(
xM
/
_C–lSizex
));

209 
	gyI
=
size_t
(
æoÜ
(
yM
/
_C–lSizey
));

212 
	gNxI
;

213 
	gNyI
;

214 
	grsizex
;

215 
	grsizey
;

217 
	grsizex
=
size_t
(
æoÜ
(
r
/
_C–lSizex
)+5);

218 
	grsizey
=
size_t
(
æoÜ
(
r
/
_C–lSizey
)+1);

220 
	gii
=-
rsizex
;ii<=rsizex;ii++)

222 
	gNxI
=
xI
+
ii
;

223 if(
	gNxI
<0||NxI>
	g_C–lNumx
)

225 if(
	gNxI
<0)

226 
	gNxI
+=
_C–lNumx
;

228 
	gNxI
-=
_C–lNumx
;

230 
	gjj
=-
rsizey
;jj<=rsizey;jj++)

232 
	gNyI
=
yI
+
jj
;

233 if(
	gNyI
>=0&&
NyI
<
_C–lNumy
)

235 
C–lID
=
NyI
*
_C–lNumx
+
NxI
;

237 
	gff
=0;ff<
	g_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
].
size
();ff++)

239 if(
	g_C–lLi¡
[
C–lID
][
ff
]->
	g_x
>
	gx
)

240 
	gdxŸc
=
_C–lLi¡
[
C–lID
][
ff
]->
_x
-(
MAXX
-
MINX
)-
x
;

241 if(
	g_C–lLi¡
[
C–lID
][
ff
]->
	g_x
<
	gx
)

242 
	gdxŸc
=
_C–lLi¡
[
C–lID
][
ff
]->
_x
+(
MAXX
-
MINX
)-
x
;

244 
	gdyŸc
=
_C–lLi¡
[
C–lID
][
ff
]->
_y
-
y
;

246 
	gdxŸc2
=
dxŸc
*dxiac;

247 
	gdyŸc2
=
dyŸc
*dyiac;

249 
	gdrŸc2
=
dxŸc2
+
dyŸc2
;

251 if(
	gdrŸc2
<=
r2
)

253 
PtNbLi¡
.
push_back
(
_C–lLi¡
[
C–lID
][
ff
]);

261 
	gCBox
::
G‘N—rBndPt
(
¡d
::
veùÜ
<
CBa£Pt
 *> & 
BndPt
)

263 
i
,
	gj
,
	gk
;

264 
	gveùÜ
<> 
	gRowMšX
;

265 
	gveùÜ
<> 
	gRowMaxX
;

266 
	gveùÜ
<> 
	gRowEm±yId
;

267 
	gNBCELLX
,
	gNBCELLY
;

269 
	gNBCELLX
=
_C–lNumx
;

270 
	gNBCELLY
=
_C–lNumy
;

273 
	gRowMšX
.
»size
(
NBCELLY
,0.0);

274 
	gRowMaxX
.
»size
(
NBCELLY
,0.0);

275 
	gRowEm±yId
.
»size
(
NBCELLY
,0);

278 
	gi
=0;i<
	gNBCELLY
;i++)

281 
	gj
=0;j<
	gNBCELLX
;j++)

283 if(
	g_C–lLi¡
[
i
*
NBCELLX
+
j
].
size
()!=0)

285 
RowMšX
[
i
]=
_C–lLi¡
[i*
NBCELLX
+
j
][0]->
_x
;

286 
	gRowMaxX
[
i
]=
_C–lLi¡
[i*
NBCELLX
+
j
][0]->
_x
;

288 
	gRowEm±yId
[
i
]=1;

294 if(
	gRowEm±yId
[
i
]==1)

296 
j
=0;
	gj
<
	gNBCELLX
;j++)

298 
	gk
=1;k<
	g_C–lLi¡
[
i
*
NBCELLX
+
j
].
size
();k++)

300 if(
	g_C–lLi¡
[
i
*
NBCELLX
+
j
][
k
]->
	g_x
<
	gRowMšX
[i])

301 
	gRowMšX
[
i
]=
_C–lLi¡
[i*
NBCELLX
+
j
][
k
]->
_x
;

302 if(
	g_C–lLi¡
[
i
*
NBCELLX
+
j
][
k
]->
	g_x
>
	gRowMšX
[i])

303 
	gRowMaxX
[
i
]=
_C–lLi¡
[i*
NBCELLX
+
j
][
k
]->
_x
;

311 
	gBndPt
.
ş—r
();

313 
	gnbbnd±
=0;

314 
	gkk
=0;

315 
	gi
=0;i<
	gNBCELLY
;i++)

317 
	gj
=0;j<
	gNBCELLX
;j++)

319 
	gk
=0;k<
	g_C–lLi¡
[
i
*
NBCELLX
+
j
].
size
();k++)

321 if(
	g_C–lLi¡
[
i
*
NBCELLX
+
j
][
k
]->
	g_x
-
	gRowMšX
[i]<_C–lLi¡[i*NBCELLX+j][k]->
	g_r
)

323 
	gBndPt
.
push_back
(
_C–lLi¡
[
i
*
NBCELLX
+
j
][
k
]);

326 if(
	gRowMaxX
[
i
]-
	g_C–lLi¡
[i*
NBCELLX
+
j
][
k
]->
	g_x
<_C–lLi¡[i*NBCELLX+j][k]->
	g_r
)

328 
	gBndPt
.
push_back
(
_C–lLi¡
[
i
*
NBCELLX
+
j
][
k
]);

	@Box.h

16 #iâdeà
_BOX_H_


17 
	#_BOX_H_


	)

19 
	~<veùÜ
>

20 
	~<io¡»am
>

22 
	~"RegiÚ.h
"

23 
	~"Ba£Pt.h
"

25 şas 
	cCBox


27 
	mpublic
:

28 
CBox
(
size_t
 
C–lNumx
=1,size_ˆ
C–lNumy
=1);

30 ~
CBox
();

32 
Resize
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
);

34 
Upd©eBox
(
CRegiÚ
 & 
RegiÚ
);

36 
G‘Nbl
(
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
);

38 
G‘Nbl2
(
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
,
CRegiÚ
 & 
RegiÚ
);

40 
G‘N—rBndPt
(
¡d
::
veùÜ
<
CBa£Pt
 *> & 
BndPt
);

42 
	m´iv©e
:

43 
S‘MPošt
(
CRegiÚ
 & 
RegiÚ
);

45 
PutPt2C–l
(
CRegiÚ
 & 
RegiÚ
);

47 
	m¡d
::
veùÜ
<
¡d
::veùÜ<
CBa£Pt
 *> > 
_C–lLi¡
;

49 
size_t
 
	m_C–lNumx
;

51 
size_t
 
	m_C–lNumy
;

53 
size_t
 
	m_C–lNumz
;

55 
	m_MaxPoštx
;

57 
	m_MšPoštx
;

59 
	m_MaxPošty
;

61 
	m_MšPošty
;

63 
	m_MaxPoštz
;

65 
	m_MšPoštz
;

67 
	m_MšPošŒ
;

69 
	m_C–lSizex
;

71 
	m_C–lSizey
;

73 
	m_C–lSizez
;

	@CSPM.cpp

1 
	~"CSPM.h
"

3 
	gCCSPM
::
	$CCSPM
()

5 
	}
}

7 
CCSPM
::~
	$CCSPM
()

9 
	}
}

11 
CCSPM
::
	$G‘CSPMFunCÜùCÛf
(
CRegiÚ
 &
RegiÚ
)

13 
ID
;

14 
CBa£Pt
 * 
PtiPŒ
,*
PtjPŒ
;

15 
CKÆ
 * 
KÆPŒ
;

18 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

20 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

21 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

22 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

24 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
)

26 
PtiPŒ
->
_CSPMCÛf
+=
PtjPŒ
->
_m
/PtjPŒ->
_rho
*
KÆPŒ
->
_W
;

28 if(
PtiPŒ
!=
PtjPŒ
)

30 
PtjPŒ
->
_CSPMCÛf
+=
PtiPŒ
->
_m
/PtiPŒ->
_rho
*
KÆPŒ
->
_W
;

35 
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag1
=1;

36 
	}
}

40 
	gCCSPM
::
	$G‘CSPMG¿dCÜùCÛf
(
CRegiÚ
 &
RegiÚ
)

57 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

58 
CKÆ
 * 
KÆPŒ
;

60 
nÜm
;

61 
mi
,
mj
;

62 
rhoi
,
rhoj
;

63 
xij
,
yij
;

64 
nÜmx
,
nÜmy
;

66 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

68 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
)

70 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

71 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

72 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

74 
mi
=
PtiPŒ
->
_m
;

75 
mj
=
PtjPŒ
->
_m
;

77 
rhoi
=
PtiPŒ
->
_rho
;

78 
rhoj
=
PtjPŒ
->
_rho
;

80 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

81 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

83 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

84 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

86 
PtiPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

87 
PtiPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

89 
PtiPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

90 
PtiPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

92 if(
PtiPŒ
!=
PtjPŒ
)

94 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

95 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

97 
PtjPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

98 
PtjPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

100 
PtjPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

101 
PtjPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

107 
CBa£Pt
 * 
Ba£PtPŒ
;

108 
CO³¿tÜ
 
O³¿tÜ
;

109 
Axx
,
Axy
,
Ayx
,
Ayy
;

110 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

112 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

114 
Axx
=
Ba£PtPŒ
->
_CSPMAxx
;

115 
Axy
=
Ba£PtPŒ
->
_CSPMAxy
;

116 
Ayx
=
Ba£PtPŒ
->
_CSPMAyx
;

117 
Ayy
=
Ba£PtPŒ
->
_CSPMAyy
;

118 
O³¿tÜ
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,

119 &
Ba£PtPŒ
->
_CSPMAxx
,&Ba£PtPŒ->
_CSPMAyx
,&Ba£PtPŒ->
_CSPMAxy
,&Ba£PtPŒ->
_CSPMAyy
);

122 
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
=1;

123 
	}
}

127 
	gCCSPM
::
	$G‘CSPMG¿dCÜùCÛf2
(
CRegiÚ
 &
RegiÚ
)

144 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

145 
CKÆ
 * 
KÆPŒ
;

147 
nÜm
;

148 
mi
,
mj
;

149 
rhoi
,
rhoj
;

150 
xij
,
yij
;

151 
nÜmx
,
nÜmy
;

153 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

155 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ


156 ||
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHDumPtPaœ
)

158 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

159 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

160 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

162 
mi
=
PtiPŒ
->
_m
;

163 
mj
=
PtjPŒ
->
_m
;

165 
rhoi
=
PtiPŒ
->
_rho
;

166 
rhoj
=
PtjPŒ
->
_rho
;

168 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

169 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

171 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

172 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

174 
PtiPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

175 
PtiPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

177 
PtiPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

178 
PtiPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

180 if(
PtiPŒ
!=
PtjPŒ
&&PtjPŒ->
_Ty³
==
’SPHPt
)

182 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

183 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

185 
PtjPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

186 
PtjPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

188 
PtjPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

189 
PtjPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

195 
CBa£Pt
 * 
Ba£PtPŒ
;

196 
CO³¿tÜ
 
O³¿tÜ
;

197 
Axx
,
Axy
,
Ayx
,
Ayy
;

198 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

200 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

202 
Axx
=
Ba£PtPŒ
->
_CSPMAxx
;

203 
Axy
=
Ba£PtPŒ
->
_CSPMAxy
;

204 
Ayx
=
Ba£PtPŒ
->
_CSPMAyx
;

205 
Ayy
=
Ba£PtPŒ
->
_CSPMAyy
;

206 
O³¿tÜ
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,

207 &
Ba£PtPŒ
->
_CSPMAxx
,&Ba£PtPŒ->
_CSPMAyx
,&Ba£PtPŒ->
_CSPMAxy
,&Ba£PtPŒ->
_CSPMAyy
);

210 
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
=1;

211 
	}
}

	@CSPM.h

16 #iâdeà
_CSPM_H_


17 
	#_CSPM_H_


	)

19 
	~"Ba£Pt.h
"

20 
	~"RegiÚ.h
"

21 
	~"O³¿tÜ.h
"

22 
	~<veùÜ
>

24 şas 
	cCCSPM


26 
	mpublic
:

28 
CCSPM
();

30 ~
CCSPM
();

32 
G‘CSPMFunCÜùCÛf
(
CRegiÚ
 &
RegiÚ
);

34 
G‘CSPMG¿dCÜùCÛf
(
CRegiÚ
 &
RegiÚ
);

36 
G‘CSPMG¿dCÜùCÛf2
(
CRegiÚ
 &
RegiÚ
);

38 
	m´iv©e
:

	@CalBndNorm.cpp

1 
	~"C®BndNÜm.h
"

3 
	gCC®BndNÜm
::
	$CC®BndNÜm
()

5 
	}
}

7 
CC®BndNÜm
::~
	$CC®BndNÜm
()

10 
	}
}

12 
CC®BndNÜm
::
	$SŞve
(
CRegiÚ
 & 
RegiÚ
)

14 
CBa£Pt
 * 
PtPŒ
;

16 
RegiÚBnd
.
_CÚŒŞSPH
.
_InfeName
=
RegiÚ
._ControlSPH._InfileName;

18 
	`IÅutBndAss™
(
RegiÚBnd
);

20 
	`G‘NblBnd
(
RegiÚBnd
);

22 
	`G‘NÜmBnd
(
RegiÚBnd
);

25 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

27 ià(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’DumPt
 )

29 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

31 
PtPŒ
->
_Nnx
=
RegiÚBnd
.
_PtLi¡
[
i
]._Nnx;

32 
PtPŒ
->
_Nny
=
RegiÚBnd
.
_PtLi¡
[
i
]._Nny;

127 
RegiÚBnd
.
_PtLi¡
.
	`ş—r
();

128 
RegiÚBnd
.
_PtPaœLi¡
.
	`ş—r
();

129 
RegiÚBnd
.
_KÆLi¡
.
	`ş—r
();

131 
	}
}

134 
	gCC®BndNÜm
::
	$IÅutBndAss™
Ğ
CRegiÚ
 & 
RegiÚ
 )

136 
¡ršg
 
keywÜd
;

137 
¡ršg
 
lše
;

138 
veùÜ
<> 
X
,
Y
,
Z
;

139 
v®ue
;

140 
PID
,
SECID
,
EOSID
,
ID
;

141 
tch
;

143 
if¡»am
 
šfe
;

144 
o¡ršg¡»am
 
šf’ame
;

145 
šf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<".bnd";

146 
šfe
.
	`İ’
(
šf’ame
.
	`¡r
().
	`d©a
(),
ios
::
š
);

147 ià(!
šfe
)

149 
cout
<<"KFcould‚Ù bİ’."<<
’dl
;

155 
cout
<<"S¹ R—dšg Bound¬y NÜm® Assi¡ªˆFe."<<
’dl
;

158 !
šfe
.
	`eof
())

160 
šfe
>>
keywÜd
;

162 if(
keywÜd
=="*NODE")

164 if(
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
==0)

168 
šfe
>>
tch
;

169 if((
tch
=='*')||(tch=='$'))

171 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

174 
tch
!=',')

176 
šfe
>>
tch
;

179 
šfe
>>
v®ue
;

180 
šfe
.
	`ignÜe
();

181 
X
.
	`push_back
(
v®ue
);

183 
šfe
>>
v®ue
;

184 
šfe
.
	`ignÜe
();

185 
Y
.
	`push_back
(
v®ue
);

187 
i
=0;i<3;i++)

189 
šfe
>>
v®ue
;

190 
šfe
.
	`ignÜe
();

196 if(
keywÜd
=="*ELEMENT_SHELL_THICKNESS")

198 if(
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
==0)

203 
veùÜ
<>
	`tPosx
(4);

204 
veùÜ
<>
	`tPosy
(4);

205 
veùÜ
<>
	`tP¬te
(3);

207 
CBa£Pt
 
Ba£Pt
;

209 
šfe
>>
tch
;

210 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

211 if((
tch
=='*')||(tch=='$')) ;

213 
šfe
>>
v®ue
;

214 
šfe
.
	`ignÜe
();

215 
ID
=
	`size_t
(
v®ue
);

216 
Ba£Pt
.
_ID
=
ID
;

218 
šfe
>>
v®ue
;

219 
šfe
.
	`ignÜe
();

220 
PID
=
	`size_t
(
v®ue
);

221 
Ba£Pt
.
_PID
=
PID
;

224 
šfe
>>
v®ue
;

225 
šfe
.
	`ignÜe
();

226 
ID
=
	`size_t
(
v®ue
);

227 
tPosx
[0]=
X
[
ID
-1];

228 
tPosy
[0]=
Y
[
ID
-1];

230 
šfe
>>
v®ue
;

231 
šfe
.
	`ignÜe
();

232 
ID
=
	`size_t
(
v®ue
);

233 
tPosx
[1]=
X
[
ID
-1];

234 
tPosy
[1]=
Y
[
ID
-1];

236 
šfe
>>
v®ue
;

237 
šfe
.
	`ignÜe
();

238 
ID
=
	`size_t
(
v®ue
);

239 
tPosx
[2]=
X
[
ID
-1];

240 
tPosy
[2]=
Y
[
ID
-1];

242 
šfe
>>
v®ue
;

243 
šfe
.
	`ignÜe
();

244 
ID
=
	`size_t
(
v®ue
);

245 
tPosx
[3]=
X
[
ID
-1];

246 
tPosy
[3]=
Y
[
ID
-1];

248 
i
=0;i<4;i++)

250 
šfe
>>
v®ue
;

251 
šfe
.
	`ignÜe
();

254 
	`C’‹rBnd
(
tPosx
,
tPosy
,
tP¬te
);

256 
Ba£Pt
.
_x
=
tP¬te
[0];

257 
Ba£Pt
.
_y
=
tP¬te
[1];

258 
Ba£Pt
.
_VŞume
=
tP¬te
[2];

260 
Ba£Pt
.
_rho0
=1000;

261 
Ba£Pt
.
_rho
 =1000;

263 
Ba£Pt
.
_m
=Ba£Pt.
_rho0
*Ba£Pt.
_VŞume
;

265 
Ba£Pt
.
_h
=2*
	`pow
(Ba£Pt.
_VŞume
,0.5);

266 
Ba£Pt
.
_r
=2.0*Ba£Pt.
_h
;

267 
Ba£Pt
.
_C0
=1;

268 
Ba£Pt
.
_C
=0;

270 
Ba£Pt
.
_Cs
=
RegiÚ
.
_CÚŒŞSPH
._Cs;

272 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

274 
Ba£Pt
.
_H
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STHvsh
*Ba£Pt.
_h
;

275 
Ba£Pt
.
_¼
=2*Ba£Pt.
_H
;

278 
Ba£Pt
.
_p
=0;

279 
Ba£Pt
.
_Iæag
=1;

280 
Ba£Pt
.
_Ty³
=
’SPHPt
;

283 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt
);

284 
tPosx
.
	`ş—r
();

285 
tPosy
.
	`ş—r
();

286 
tP¬te
.
	`ş—r
();

291 if(
keywÜd
=="*END")

297 
	}
}

299 
	gCC®BndNÜm
::
C’‹rBnd
Ğ
veùÜ
<> &
px
,veùÜ<> &
py
,veùÜ<> &
p
 )

301 
	gx5
,
	gx6
,
	gy5
,
	gy6
,
	gs12
,
	gs13
,
	gs14
,
	gs23
,
	gs34
,
	gs1
,
	gs2
,
	gA1
,
	gA2
,
	gA
,
	gxc1
,
	gxc2
,
	gyc1
,
	gyc2
;

302 
	gx5
=(
px
[2]+px[3])/2;

303 
	gy5
=(
py
[2]+py[3])/2;

304 
	gx6
=(
px
[0]+px[2])/2;

305 
	gy6
=(
py
[0]+py[2])/2;

306 
	gs12
=
sq¹
((
px
[0]-px[1])*Õx[0]-px[1])+(
py
[0]-py[1])*(py[0]-py[1]));

307 
	gs13
=
sq¹
((
px
[0]-px[2])*Õx[0]-px[2])+(
py
[0]-py[2])*(py[0]-py[2]));

308 
	gs14
=
sq¹
((
px
[0]-px[3])*Õx[0]-px[3])+(
py
[0]-py[3])*(py[0]-py[3]));

309 
	gs23
=
sq¹
((
px
[1]-px[2])*Õx[1]-px[2])+(
py
[1]-py[2])*(py[1]-py[2]));

310 
	gs34
=
sq¹
((
px
[2]-px[3])*Õx[2]-px[3])+(
py
[2]-py[3])*(py[2]-py[3]));

311 
	gs1
=(
s14
+
s13
+
s34
)/2;

312 
	gs2
=(
s13
+
s12
+
s23
)/2;

313 
	gA1
=
sq¹
(
s1
*(s1-
s14
)*(s1-
s13
)*(s1-
s34
));

314 
	gA2
=
sq¹
(
s2
*(s2-
s12
)*(s2-
s23
)*(s2-
s13
));

315 
	gxc1
=(2*
x5
+
px
[0])/3;

316 
	gyc1
=(2*
y5
+
py
[0])/3;

317 
	gxc2
=(2*
x6
+
px
[1])/3;

318 
	gyc2
=(2*
y6
+
py
[1])/3;

319 
	gA
=
A1
+
A2
;

320 
	gp
[0]=(
xc1
*
A1
+
xc2
*
A2
)/
A
;

321 
	gp
[1]=(
yc1
*
A1
+
yc2
*
A2
)/
A
;

322 
	gp
[2]=
A
;

326 
	gCC®BndNÜm
::
	$G‘NblBnd
Ğ
CRegiÚ
 & 
RegiÚ
 )

328 
dxŸc
;

329 
dyŸc
;

330 
dxŸc2
;

331 
dyŸc2
;

332 
drŸc2
;

333 
r
,
¼
;

334 
r2
,
¼2
;

335 
ID
;

336 
CPtPaœ
 
PtPaœ
;

339 
dp
;

342 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

344 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

346 
_MaxPoštx
=
RegiÚ
.
_PtLi¡
[
i
].
_x
;

347 
_MaxPošty
=
RegiÚ
.
_PtLi¡
[
i
].
_y
;

349 
_MšPoštx
=
RegiÚ
.
_PtLi¡
[
i
].
_x
;

350 
_MšPošty
=
RegiÚ
.
_PtLi¡
[
i
].
_y
;

352 
_MšPošŒ
=
RegiÚ
.
_PtLi¡
[
i
].
_r
;

359 
size_t
 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

361 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

363 if(
_MaxPoštx
<
RegiÚ
.
_PtLi¡
[
i
].
_x
) _MaxPointx=Region._PtList[i]._x;

364 if(
_MaxPošty
<
RegiÚ
.
_PtLi¡
[
i
].
_y
) _MaxPointy=Region._PtList[i]._y;

366 if(
_MšPoštx
>
RegiÚ
.
_PtLi¡
[
i
].
_x
) _MinPointx=Region._PtList[i]._x;

367 if(
_MšPošty
>
RegiÚ
.
_PtLi¡
[
i
].
_y
) _MinPointy=Region._PtList[i]._y;

369 if(
_MšPošŒ
>
RegiÚ
.
_PtLi¡
[
i
].
_r
) _MinPointr=Region._PtList[i]._r;

373 
_MšPošŒ
=
RegiÚ
.
_PtLi¡
[0].
_r
;

375 
_MaxPoštx
+=
_MšPošŒ
*0.5;

376 
_MšPoštx
-=
_MšPošŒ
*0.5;

378 
_MaxPošty
+=
_MšPošŒ
*0.5;

379 
_MšPošty
-=
_MšPošŒ
*0.5;

382 
dp
=
	`pow
(
RegiÚ
.
_PtLi¡
[0].
_VŞume
,0.5);

384 
_C–lNumx
=
	`size_t
((
_MaxPoštx
-
_MšPoštx
)/
dp
*1.0);

385 
_C–lNumy
=
	`size_t
((
_MaxPošty
-
_MšPošty
)/
dp
*1.0);

388 
cout
<<"ûÎ‚um x:"<<
_C–lNumx
<<
’dl
;

389 
cout
<<"ûÎ‚um y:"<<
_C–lNumy
<<
’dl
;

391 
_C–lSizex
=(
_MaxPoštx
-
_MšPoštx
)/(
_C–lNumx
);

392 
_C–lSizey
=(
_MaxPošty
-
_MšPošty
)/(
_C–lNumy
);

395 
_C–lLi¡
.
	`»size
(
_C–lNumx
*
_C–lNumy
,
¡d
::
veùÜ
<
CBa£Pt
 *>(0,
NULL
));

397 
size_t
 
i
=0;i<
_C–lLi¡
.
	`size
();i++)

399 
_C–lLi¡
[
i
].
	`ş—r
();

404 
xM
,
yM
;

405 
size_t
 
xI
,
yI
;

406 
ID
;

409 
size_t
 
i
=0; i!=
RegiÚ
.
_PtLi¡
.
	`size
();i++)

411 if(
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
==1)

413 
xM
=
RegiÚ
.
_PtLi¡
[
i
].
_x
-
_MšPoštx
;

414 
yM
=
RegiÚ
.
_PtLi¡
[
i
].
_y
-
_MšPošty
;

416 
xI
=
	`size_t
(
	`æoÜ
(
xM
/
_C–lSizex
));

417 
yI
=
	`size_t
(
	`æoÜ
(
yM
/
_C–lSizey
));

419 
_C–lLi¡
[
yI
*
_C–lNumx
+
xI
].
	`push_back
(&
RegiÚ
.
_PtLi¡
[
i
]);

426 
size_t
 
f
=0;f<
RegiÚ
.
_PtLi¡
.
	`size
();f++)

428 
ID
=
f
;

430 if(
RegiÚ
.
_PtLi¡
[
ID
].
_Ty³
==
’SPHPt
)

432 
	`Prim¬ySchBnd
(
RegiÚ
.
_PtLi¡
[
ID
].
_x
,RegiÚ._PtLi¡[ID].
_y
,RegiÚ._PtLi¡[ID].
_r
,
_PtNbLi¡
);

434 
size_t
 
i
=0;i<
_PtNbLi¡
.
	`size
();i++)

436 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
ID
]._x;

437 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_PtLi¡
[
ID
]._y;

439 
dxŸc2
=
dxŸc
*dxiac;

440 
dyŸc2
=
dyŸc
*dyiac;

442 
drŸc2
=
dxŸc2
+
dyŸc2
;

443 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_PtLi¡
[
ID
]._r;

444 
r2
=
r
*r;

447 if(4*
drŸc2
<=
r2
)

449 
_PtNbLi¡
[
i
]->
_Ty³
)

451 
’SPHPt
:

453 if((
ID
+1)<=
_PtNbLi¡
[
i
]->
_ID
)

455 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

456 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

457 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

458 
PtPaœ
.
_drŸc2
=
drŸc2
;

460 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

467 
PtNbr
;

468 
PtNbr
=
_PtNbLi¡
[
i
]->
_r
*_PtNbList[i]->_r;

469 if(
drŸc2
>
PtNbr
)

471 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

472 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

473 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

474 
PtPaœ
.
_drŸc2
=
drŸc2
;

476 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

493 
icouÁ
;

494 
x
,
y
,
h
,
di¡ªû2
;

495 
CBa£Pt
 * 
PtiPŒ
,*
PtjPŒ
;

496 
RegiÚ
.
_KÆLi¡
.
	`»size
(RegiÚ.
_PtPaœLi¡
.
	`size
());

498 
icouÁ
=0;

499 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

502 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

503 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

505 
x
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

506 
y
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

507 
h
=0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h);

510 
di¡ªû2
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
;

512 
	`G‘WBnd
(
x
,
y
,
h
,
di¡ªû2
,
RegiÚ
.
_KÆLi¡
[
icouÁ
].
_W
,RegiÚ._KÆLi¡[icouÁ].
_Wx
,RegiÚ._KÆLi¡[icouÁ].
_Wy
,RegiÚ._KÆLi¡[icouÁ].
_Ww
);

514 
icouÁ
++;

518 
_C–lLi¡
.
	`ş—r
();

520 
	}
}

522 
	gCC®BndNÜm
::
Prim¬ySchBnd
Ğ
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
 )

524 
dxŸc
;

525 
	gdyŸc
;

526 
	gdrŸc2
;

528 
	gdxŸc2
;

529 
	gdyŸc2
;

530 
	gr2
;

531 
	gID
;

532 
	gr2
=
r
*r;

534 
	gPtNbLi¡
.
»size
(0,
NULL
);

537 
	gxM
,
	gyM
;

538 
size_t
 
	gxI
,
	gyI
;

539 
	gxM
=
x
-
_MšPoštx
;

540 
	gyM
=
y
-
_MšPošty
;

542 
	gxI
=
size_t
(
æoÜ
(
xM
/
_C–lSizex
));

543 
	gyI
=
size_t
(
æoÜ
(
yM
/
_C–lSizey
));

546 
	gNxI
;

547 
	gNyI
;

548 
	grsizex
;

549 
	grsizey
;

551 
	grsizex
=
size_t
(
æoÜ
(
r
/
_C–lSizex
)+1);

552 
	grsizey
=
size_t
(
æoÜ
(
r
/
_C–lSizey
)+1);

554 
	gi
=-
rsizex
;i<=rsizex;i++)

556 
	gNxI
=
xI
+
i
;

557 if(
	gNxI
>=0&&
NxI
<
_C–lNumx
)

559 
j
=-
rsizey
;
	gj
<=rsizey;j++)

561 
	gNyI
=
yI
+
j
;

562 if(
	gNyI
>=0&&
NyI
<
_C–lNumy
)

564 
size_t
 
f
=0;
	gf
<
	g_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
].
size
();f++)

566 
	gdxŸc
=
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]->
_x
-
x
;

567 
	gdyŸc
=
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]->
_y
-
y
;

569 
	gdxŸc2
=
dxŸc
*dxiac;

570 
	gdyŸc2
=
dyŸc
*dyiac;

572 
	gdrŸc2
=
dxŸc2
+
dyŸc2
;

574 if(
	gdrŸc2
<=
r2
)

576 
PtNbLi¡
.
push_back
(
_C–lLi¡
[
NyI
*
_C–lNumx
+
NxI
][
f
]);

585 
	gCC®BndNÜm
::
	$G‘NÜmBnd
Ğ
CRegiÚ
 & 
RegiÚ
 )

587 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

588 
CBa£Pt
 * 
Ba£PŒ
;

589 
CKÆ
 * 
KÆPŒ
;

591 
mi
,
mj
;

592 
rhoi
,
rhoj
;

593 
Nnxx
,
Nnyy
;

594 
C0i
,
C0j
;

595 
IDi
,
IDj
;

596 
ID
,
ID2
;

597 
PID
;

598 
Axx
,
Ayx
,
Axy
,
Ayy
;

599 
xij
,
yij
;

600 
nÜmx
,
nÜmy
;

602 
veùÜ
<> 
bx
;

603 
veùÜ
<> 
by
;

604 
veùÜ
<> 
N
;

606 
bx
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

607 
by
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

608 
N
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0);

610 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

612 
Ba£PŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

614 
Ba£PŒ
->
_CSPMAxx
=0.0;

615 
Ba£PŒ
->
_CSPMAxy
=0.0;

616 
Ba£PŒ
->
_CSPMAyx
=0.0;

617 
Ba£PŒ
->
_CSPMAyy
=0.0;

621 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

623 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

624 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

625 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

627 
C0i
=1;

628 
C0j
=1;

630 
PtiPŒ
->
_C
+=
PtjPŒ
->
_m
/PtjPŒ->
_rho
*
KÆPŒ
->
_W
*
C0j
;

632 if(
PtiPŒ
!=
PtjPŒ
)

634 
PtjPŒ
->
_C
+=
PtiPŒ
->
_m
/PtiPŒ->
_rho
*
KÆPŒ
->
_W
*
C0i
;

640 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

644 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

645 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

646 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

648 
mi
=
PtiPŒ
->
_m
;

649 
mj
=
PtjPŒ
->
_m
;

651 
rhoi
=
PtiPŒ
->
_rho
;

652 
rhoj
=
PtjPŒ
->
_rho
;

654 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

655 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

657 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

658 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

660 
PtiPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

661 
PtiPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

663 
PtiPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

664 
PtiPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

666 if(
PtiPŒ
!=
PtjPŒ
)

668 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

669 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

671 
PtjPŒ
->
_CSPMAxx
+=
xij
*
nÜmx
;

672 
PtjPŒ
->
_CSPMAyx
+=
yij
*
nÜmx
;

674 
PtjPŒ
->
_CSPMAxy
+=
xij
*
nÜmy
;

675 
PtjPŒ
->
_CSPMAyy
+=
yij
*
nÜmy
;

683 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

685 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

687 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

688 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

689 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

691 
IDi
=
PtiPŒ
->
_ID
;

692 
IDj
=
PtjPŒ
->
_ID
;

694 
mi
=
PtiPŒ
->
_m
;

695 
mj
=
PtjPŒ
->
_m
;

697 
rhoi
=
PtiPŒ
->
_rho
;

698 
rhoj
=
PtjPŒ
->
_rho
;

700 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

701 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

703 
bx
[
IDi
-1]+=
nÜmx
*(
PtiPŒ
->
_C
-
PtjPŒ
->_C);

704 
by
[
IDi
-1]+=
nÜmy
*(
PtiPŒ
->
_C
-
PtjPŒ
->_C);

706 if(
PtiPŒ
!=
PtjPŒ
)

708 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

709 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

711 
bx
[
IDj
-1]-=
nÜmx
*(
PtjPŒ
->
_C
-
PtiPŒ
->_C);

712 
by
[
IDj
-1]-=
nÜmy
*(
PtjPŒ
->
_C
-
PtiPŒ
->_C);

718 
mod
;

719 
xi
;

720 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

722 
ID
=
i
;

724 
Ba£PŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

726 
ID2
=
Ba£PŒ
->
_ID
;

728 
Axx
=
Ba£PŒ
->
_CSPMAxx
;

729 
Ayx
=
Ba£PŒ
->
_CSPMAyx
;

730 
Axy
=
Ba£PŒ
->
_CSPMAxy
;

731 
Ayy
=
Ba£PŒ
->
_CSPMAyy
;

733 
_O³¿tÜBnd
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,&Axx,&Ayx,&Axy,&Ayy);

735 
Ba£PŒ
->
_nx
=
Axx
*
bx
[
ID2
-1]+
Ayx
*
by
[ID2-1];

736 
Ba£PŒ
->
_ny
=
Axy
*
bx
[
ID2
-1]+
Ayy
*
by
[ID2-1];

739 
mod
=
	`sq¹
(
Ba£PŒ
->
_nx
*Ba£PŒ->_nx+Ba£PŒ->
_ny
*BasePtr->_ny);

741 
xi
=0.01/
Ba£PŒ
->
_h
;

743 if(
mod
>
xi
)

745 
N
[
ID2
-1]=1;

746 
Ba£PŒ
->
_Nnx
=Ba£PŒ->
_nx
/
mod
;

747 
Ba£PŒ
->
_Nny
=Ba£PŒ->
_ny
/
mod
;

752 
N
[
ID2
-1]=0;

753 
Ba£PŒ
->
_Nnx
=0.0;

754 
Ba£PŒ
->
_Nny
=0.0;

758 
bx
.
	`ş—r
();

759 
by
.
	`ş—r
();

761 
	}
}

763 
	gCC®BndNÜm
::
	$G‘WBnd
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
Ww
)

765 
s
;

766 
‰t
;

767 
di¡ªû
;

768 
dW
;

769 
‹rm
;

770 
_nÜm
;

771 
_nÜm
=15.0/(7.0*3.1415926);

773 if(
di¡ªû2
!=0.0)

775 
di¡ªû
=
	`sq¹
(
di¡ªû2
);

776 
s
=
di¡ªû
/
h
;

778 if(
s
<1)

780 
W
=0.66666667-
s
*s+0.5*s*s*s;

781 
dW
=-2*
s
+1.5*s*s;

783 if(
s
<2)

785 
‰t
=2-
s
;

786 
W
=0.166666667*
‰t
*ttt*ttt;

787 
dW
=-0.5*
‰t
*ttt;

791 
W
=0;

792 
dW
=0;

795 
W
*=(
_nÜm
/(
h
*h));

796 
‹rm
=
dW
*
_nÜm
/(
h
*h*h*
di¡ªû
);

797 
Ww
=
‹rm
;

798 
Wx
=
‹rm
*
x
;

799 
Wy
=
‹rm
*
y
;

803 
W
=0.66666667*(
_nÜm
/(
h
*h));

804 
Wx
=0.0;

805 
Wy
=0.0;

807 
	}
}

	@CalBndNorm.h

16 #iâdeà
_CALBNDNORM_H_


17 
	#_CALBNDNORM_H_


	)

19 
	~"Ba£Pt.h
"

20 
	~"RegiÚ.h
"

21 
	~"NblSch.h
"

22 
	~"O³¿tÜ.h
"

23 
	~"KFe.h
"

24 
	~<veùÜ
>

25 
	~<cm©h
>

26 
	~<¡ršg
>

27 
	~<f¡»am
>

28 
	~<s¡»am
>

29 
	~<io¡»am
>

30 
	~<iomª
>

32 şas 
	cCC®BndNÜm


34 
	mpublic
:

36 
CC®BndNÜm
();

38 ~
CC®BndNÜm
();

40 
SŞve
(
CRegiÚ
 & 
RegiÚ
);

41 
	m´iv©e
:

43 
CRegiÚ
 
RegiÚBnd
;

45 
IÅutBndAss™
(
CRegiÚ
 & 
RegiÚ
);

47 
G‘NblBnd
(
CRegiÚ
 & 
RegiÚ
);

49 
C’‹rBnd
(
veùÜ
<> &
px
,veùÜ<> &
py
,veùÜ<> &
p
);

51 
Prim¬ySchBnd
(
x
, 
y
, 
r
,
¡d
::
veùÜ
<
CBa£Pt
 *> & 
PtNbLi¡
);

53 
G‘WBnd
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
Ww
);

55 
G‘NÜmBnd
(
CRegiÚ
 & 
RegiÚ
);

57 
	m¡d
::
veùÜ
<
CBa£Pt
 *> 
_PtNbLi¡
;

59 
CO³¿tÜ
 
	m_O³¿tÜBnd
;

62 
	m¡d
::
veùÜ
<
¡d
::veùÜ<
CBa£Pt
 *> > 
_C–lLi¡
;

64 
size_t
 
	m_C–lNumx
;

66 
size_t
 
	m_C–lNumy
;

68 
size_t
 
	m_C–lNumz
;

70 
	m_MaxPoštx
;

72 
	m_MšPoštx
;

74 
	m_MaxPošty
;

76 
	m_MšPošty
;

78 
	m_MaxPoštz
;

80 
	m_MšPoštz
;

82 
	m_MšPošŒ
;

84 
	m_C–lSizex
;

86 
	m_C–lSizey
;

88 
	m_C–lSizez
;

90 
CKFe
 
	m_KFeBnd
;

	@CalculateRange.cpp

1 
	~"C®cuÏ‹Rªge.h
"

3 
	gCC®cuÏ‹Rªge
::
	$CC®cuÏ‹Rªge
()

5 
	}
}

7 
CC®cuÏ‹Rªge
::~
	$CC®cuÏ‹Rªge
()

9 
	}
}

13 
CC®cuÏ‹Rªge
::
	$_Upd©eRªge
(
CRegiÚ
& 
RegiÚ
,
TimeS‹ps
)

15 
Xümš
,
Xümax
,
Yümš
,
Yümax
;

17 
CBa£Pt
 * 
Ba£PtPŒ
;

18 
CP¬t
 * 
P¬tPŒ
;

19 
CSPHPt
 * 
PtPŒ
;

21 
icouÁ
=0;

23 
Xümš
=
RegiÚ
.
_CÚŒŞSPH
.
_Xümš
;

24 
Xümax
=
RegiÚ
.
_CÚŒŞSPH
.
_Xümax
;

25 
Yümš
=
RegiÚ
.
_CÚŒŞSPH
.
_Yümš
;

26 
Yümax
=
RegiÚ
.
_CÚŒŞSPH
.
_Yümax
;

29 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

31 
RegiÚ
.
_PtLi¡
[
i
].
_ID2
=0;

32 
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
=0;

35 
RegiÚ
.
_C®Li¡
.
	`ş—r
();

38 if((
Xümš
==0.0&&
Xümax
==0.0)&&(
Yümš
==0.0&&
Yümax
==0.0))

40 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

42 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’SPHPt
)

44 
icouÁ
++;

45 
RegiÚ
.
_PtLi¡
[
i
].
_ID2
=
icouÁ
;

46 
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
=1;

48 
RegiÚ
.
_C®Li¡
.
	`push_back
(
i
);

51 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
||RegiÚ._PtLi¡[i]._Ty³==
’BndPt
||RegiÚ._PtLi¡[i]._Ty³==
’DumPt
)

53 
RegiÚ
.
_PtLi¡
[
i
].
_ID2
=0;

54 
RegiÚ
.
_PtLi¡
[
i
].
_Iæag
=1;

60 if((
Xümš
==0.0&&
Xümax
==0.0)&&((
Yümš
==0.0&&
Yümax
==0.0)==0))

62 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

64 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

66 if(
Ba£PtPŒ
->
_y
>=
Yümš
&&Ba£PtPŒ->_y<=
Yümax
)

68 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

70 
icouÁ
++;

71 
Ba£PtPŒ
->
_ID2
=
icouÁ
;

72 
Ba£PtPŒ
->
_Iæag
=1;

74 
RegiÚ
.
_C®Li¡
.
	`push_back
(
i
);

77 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
||RegiÚ._PtLi¡[i]._Ty³==
’BndPt
||RegiÚ._PtLi¡[i]._Ty³==
’DumPt
)

79 
Ba£PtPŒ
->
_ID2
=0;

80 
Ba£PtPŒ
->
_Iæag
=1;

87 if((
Yümš
==0.0&&
Yümax
==0.0)&&((
Xümš
==0.0&&
Xümax
==0.0)==0))

89 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

91 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

93 if(
Ba£PtPŒ
->
_x
>=
Xümš
&&Ba£PtPŒ->_x<=
Xümax
)

95 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

97 
icouÁ
++;

98 
Ba£PtPŒ
->
_ID2
=
icouÁ
;

99 
Ba£PtPŒ
->
_Iæag
=1;

101 
RegiÚ
.
_C®Li¡
.
	`push_back
(
i
);

104 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
||RegiÚ._PtLi¡[i]._Ty³==
’BndPt
||RegiÚ._PtLi¡[i]._Ty³==
’DumPt
)

107 
Ba£PtPŒ
->
_ID2
=0;

108 
Ba£PtPŒ
->
_Iæag
=1;

117 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

119 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

121 if(
Ba£PtPŒ
->
_x
>=
Xümš
&&Ba£PtPŒ->_x<=
Xümax


122 &&
Ba£PtPŒ
->
_y
>=
Yümš
&&Ba£PtPŒ->_y<=
Yümax
)

124 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

126 
icouÁ
++;

127 
Ba£PtPŒ
->
_ID2
=
icouÁ
;

128 
Ba£PtPŒ
->
_Iæag
=1;

130 
RegiÚ
.
_C®Li¡
.
	`push_back
(
i
);

133 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
||RegiÚ._PtLi¡[i]._Ty³==
’BndPt
||RegiÚ._PtLi¡[i]._Ty³==
’DumPt
)

135 
Ba£PtPŒ
->
_ID2
=0;

136 
Ba£PtPŒ
->
_Iæag
=1;

142 
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
=RegiÚ.
_C®Li¡
.
	`size
();

143 
	}
}

145 
	gCC®cuÏ‹Rªge
::
	$_CË¬
(
CRegiÚ
 &
RegiÚ
)

147 
RegiÚ
.
_C®Li¡
.
	`ş—r
();

153 
	}
}

	@CalculateRange.h

1 #iâdeà
_RANGEDRAW_H_


2 
	#_RANGEDRAW_H_


	)

4 
	~"RegiÚ.h
"

5 
	~<io¡»am
>

7 şas 
	cCC®cuÏ‹Rªge


9 
	mpublic
:

11 
CC®cuÏ‹Rªge
();

13 ~
CC®cuÏ‹Rªge
();

15 
_Upd©eRªge
(
CRegiÚ
& 
RegiÚ
,
TimeS‹ps
);

17 
_CË¬
(
CRegiÚ
& 
RegiÚ
);

	@ContinuityEqu.cpp

1 
	~"CÚtšu™yEqu.h
"

3 
	gCCÚtšu™yEqu
::
	$CCÚtšu™yEqu
()

5 
	}
}

7 
CCÚtšu™yEqu
::~
	$CCÚtšu™yEqu
()

9 
	}
}

11 
CCÚtšu™yEqu
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
)

13 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

16 
uij
,
vij
;

17 
‹mp
;

18 
IDi
,
IDj
;

19 
mi
,
mj
;

20 
xij
,
yij
,
zij
;

21 
rhoi
,
rhoj
;

22 
ADd–
;

23 
wcx
,
wcy
;

24 *
g¿drhox
,*
g¿drhoy
,*
g¿drhoz
;

25 
psix
,
psiy
,
psiz
;

26 
hij
,
cs
;

27 
moduËv
;

29 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

31 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
)

33 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

34 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

35 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

37 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

38 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

41 
‹mp
=
uij
*
KÆPŒ
->
_Wx
+
vij
*KÆPŒ->
_Wy
;

43 
PtiPŒ
->
_drho
+=PtiPŒ->
_m
*
‹mp
;

45 if(
PtiPŒ
!=
PtjPŒ
)

48 
PtjPŒ
->
_drho
+=PtjPŒ->
_m
*
‹mp
;

52 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHDumPtPaœ
)

54 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

55 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

56 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

58 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

59 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

62 
moduËv
=
	`sq¹
(
PtiPŒ
->
_u
*PtiPŒ->_u+PtiPŒ->
_v
*PtiPtr->_v);

67 
‹mp
=
uij
*
KÆPŒ
->
_Wx
+
vij
*KÆPŒ->
_Wy
;

69 
PtiPŒ
->
_drho
+=PtiPŒ->
_m
*
‹mp
;

75 if(
RegiÚ
.
_CÚŒŞSPH
.
_ADD–
!=0)

79 
g¿drhox
=(*)
	`m®loc
(
RegiÚ
.
_PtLi¡
.
	`size
()*());

80 
g¿drhoy
=(*)
	`m®loc
(
RegiÚ
.
_PtLi¡
.
	`size
()*());

82 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

84 
g¿drhox
[
i
]=0.0;

85 
g¿drhoy
[
i
]=0.0;

88 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

90 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

92 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

93 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

94 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

96 
IDi
=
PtiPŒ
->
_ID
;

97 
IDj
=
PtjPŒ
->
_ID
;

99 
mi
=
PtiPŒ
->
_m
;

100 
mj
=
PtjPŒ
->
_m
;

102 
rhoi
=
PtiPŒ
->
_rho
;

103 
rhoj
=
PtjPŒ
->
_rho
;

105 
_G‘KÆLi¡C
.
	`G‘CrùKÆG¿d
(
RegiÚ
,
PtiPŒ
,
KÆPŒ
,
wcx
,
wcy
);

107 
g¿drhox
[
IDi
-1]+=
mj
/
rhoj
*Ôhoj-
rhoi
)*
wcx
;

108 
g¿drhoy
[
IDi
-1]+=
mj
/
rhoj
*Ôhoj-
rhoi
)*
wcy
;

110 if(
PtiPŒ
!=
PtjPŒ
)

112 
_G‘KÆLi¡C
.
	`G‘CrùKÆG¿d
(
RegiÚ
,
PtjPŒ
,
KÆPŒ
,
wcx
,
wcy
);

114 
g¿drhox
[
IDj
-1]-=
mi
/
rhoi
*Ôhoi-
rhoj
)*
wcx
;

115 
g¿drhoy
[
IDj
-1]-=
mi
/
rhoi
*Ôhoi-
rhoj
)*
wcy
;

121 
cs
=
RegiÚ
.
_CÚŒŞSPH
.
_Cs
;

122 
ADd–
=
RegiÚ
.
_CÚŒŞSPH
.
_ADD–
;

123 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

125 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

127 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

128 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

129 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

131 
IDi
=
PtiPŒ
->
_ID
;

132 
IDj
=
PtjPŒ
->
_ID
;

134 
mi
=
PtiPŒ
->
_m
;

135 
mj
=
PtjPŒ
->
_m
;

137 
rhoi
=
PtiPŒ
->
_rho
;

138 
rhoj
=
PtjPŒ
->
_rho
;

140 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

141 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

143 if(
PtiPŒ
!=
PtjPŒ
)

145 
psix
=-2*(
rhoj
-
rhoi
)*
xij
/(xij*xij+
yij
*yij)-(
g¿drhox
[
IDi
-1]+g¿drhox[
IDj
-1]);

146 
psiy
=-2*(
rhoj
-
rhoi
)*
yij
/(
xij
*xij+yij*yij)-(
g¿drhoy
[
IDi
-1]+g¿drhoy[
IDj
-1]);

148 
hij
=0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h);

150 
PtiPŒ
->
_drho
+=
ADd–
*
hij
*
cs
*
mj
/
rhoj
*(
psix
*
KÆPŒ
->
_Wx
+
psiy
*KÆPŒ->
_Wy
);

152 
PtjPŒ
->
_drho
-=
ADd–
*
hij
*
cs
*
mi
/
rhoi
*(
psix
*
KÆPŒ
->
_Wx
+
psiy
*KÆPŒ->
_Wy
);

157 
	`ä“
(
g¿drhox
);

158 
	`ä“
(
g¿drhoy
);

161 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==0)

163 
D–T
;

164 
D–T
=
RegiÚ
.
_CÚŒŞSPH
.
_D–T
;

165 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

167 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’SPHPt
&&RegiÚ._PtLi¡[i].
_Iæag
==1)

169 
RegiÚ
.
_PtLi¡
[
i
].
_rho
+=RegiÚ._PtLi¡[i].
_drho
*
D–T
;

172 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
&&RegiÚ._PtLi¡[i].
_Iæag
==1)

174 
RegiÚ
.
_PtLi¡
[
i
].
_rho
+=RegiÚ._PtLi¡[i].
_drho
*
D–T
;

184 if(
RegiÚ
.
_CÚŒŞSPH
.
_D’sR’ÜmS‹ps
!=0)

186 if(
TimeS‹ps
!=
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
&&TimeS‹ps%RegiÚ._CÚŒŞSPH.
_D’sR’ÜmS‹ps
==0)

188 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag1
==0)

190 
_CSPM
.
	`G‘CSPMFunCÜùCÛf
(
RegiÚ
);

194 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

196 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’SPHPt
&&RegiÚ._PtLi¡[i].
_Iæag
==1)

198 
RegiÚ
.
_PtLi¡
[
i
].
_rho
=0.0;

203 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

205 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

207 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

208 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

209 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

211 
PtiPŒ
->
_rho
+=
PtjPŒ
->
_m
*
KÆPŒ
->
_W
;

213 if(
PtiPŒ
!=
PtjPŒ
)

215 
PtjPŒ
->
_rho
+=
PtiPŒ
->
_m
*
KÆPŒ
->
_W
;

219 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHNULLPtPaœ
)

221 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

222 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

223 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

225 
PtiPŒ
->
_rho
+=
PtjPŒ
->
_m
*
KÆPŒ
->
_W
;

230 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

232 if(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’SPHPt
&&RegiÚ._PtLi¡[i].
_Iæag
==1&&RegiÚ._PtLi¡[i].
_CSPMCÛf
!=0)

234 
RegiÚ
.
_PtLi¡
[
i
].
_rho
/=RegiÚ._PtLi¡[i].
_CSPMCÛf
;

241 
	}
}

	@ContinuityEqu.h

16 #iâdeà
_CONTINUITYEQU_H_


17 
	#_CONTINUITYEQU_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"Ba£Pt.h
"

22 
	~"CSPM.h
"

23 
	~"G‘KÆLi¡.h
"

25 şas 
	cCCÚtšu™yEqu


27 
	mpublic
:

29 
CCÚtšu™yEqu
();

31 ~
CCÚtšu™yEqu
();

33 
SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
);

35 
	m´iv©e
:

36 
CCSPM
 
_CSPM
;

38 
CG‘KÆLi¡
 
	m_G‘KÆLi¡C
;

	@ControlSPH.cpp

1 
	~"CÚŒŞSPH.h
"

3 
	gCCÚŒŞSPH
::
	$CCÚŒŞSPH
()

6 
_RunMod
=1;

8 
_S¹S‹p
=0;

10 
_VSL
=0;

12 
_SPHAV
=0;

14 
_SPHPV
=0;

16 
_SPHAS
=0;

18 
_SPHST
=0;

22 
_SPHIPCS
=0;

25 
_P”dBnd
=0;

27 
_XSPHEpsÚ
=0;

29 
_Cs
=0;

31 
_D–TCÛff
=0;

33 
_D–T
=0;

35 
_Fš®Time
=0;

37 
_D’sR’ÜmS‹ps
=0;

39 
_OuutS‹ps
=0;

41 
_C–lNumx
=0;

42 
_C–lNumy
=0;

43 
_C–lNumz
=0;

45 
_AVAÍha
=0;

46 
_AVB‘a
=0;

47 
_AVE
=0;

49 
_ASEpsÚ1
=0;

50 
_ASEpsÚ2
=0;

51 
_ASD–D
=0;

53 
_ADD–
=0;

55 
_Xümš
=0;

56 
_Xümax
=0;

57 
_Yümš
=0;

58 
_Yümax
=0;

59 
_Zümš
=0;

60 
_Zümax
=0;

63 
_CSPMIæag1
=0;

64 
_CSPMIæag2
=0;

66 
	}
}

68 
	gCCÚŒŞSPH
::~
	$CCÚŒŞSPH
()

70 
	}
}

	@ControlSPH.h

16 #iâdeà
_CONTROLSPH_H_


17 
	#_CONTROLSPH_H_


	)

19 
	~<¡ršg
>

20 
	~<io¡»am
>

21 
	~<s¡»am
>

22 
	~<iosfwd
>

24 şas 
	cCCÚŒŞSPH


26 
	mpublic
:

28 
CCÚŒŞSPH
();

30 ~
CCÚŒŞSPH
();

32 
	m_RunMod
;

34 
	m_S¹S‹p
;

36 
	m_VSL
;

38 
	m_SPHAV
;

40 
	m_SPHPV
;

42 
	m_SPHAS
;

44 
	m_SPHST
;

48 
	m_SPHIPCS
;

51 
	m_P”dBnd
;

53 
	m_XSPHEpsÚ
;

55 
	m_Cs
;

57 
	m_D–TCÛff
;

59 
	m_D–T
;

61 
	m_Fš®Time
;

63 
	m_D’sR’ÜmS‹ps
;

65 
	m_OuutS‹ps
;

67 
	m_C–lNumx
;

68 
	m_C–lNumy
;

69 
	m_C–lNumz
;

71 
	m_AVAÍha
;

72 
	m_AVB‘a
;

73 
	m_AVE
;

75 
	m_ASEpsÚ1
;

76 
	m_ASEpsÚ2
;

77 
	m_ASD–D
;

79 
	m_ADD–
;

81 
	m_Xümš
;

82 
	m_Xümax
;

83 
	m_Yümš
;

84 
	m_Yümax
;

85 
	m_Zümš
;

86 
	m_Zümax
;

90 
	m_STYmš
;

91 
	m_STYmax
;

96 
	m_CSPMIæag1
;

97 
	m_CSPMIæag2
;

100 
	m_MshMšX
;

101 
	m_MshMaxX
;

103 
	m_MshMšY
;

104 
	m_MshMaxY
;

106 
	m_MshSize
;

108 
	m¡d
::
¡ršg
 
_InfeName
;

111 
	m_P”dBndMšX
;

112 
	m_P”dBndMaxX
;

114 
	m_IFÏgRemesh
;

116 
	m_TDamp
;

118 
	m_PtSháB‘a
;

	@DeltaT.cpp

1 
	~"D–T.h
"

3 
	gCD–T
::
	$CD–T
()

4 :
	`_D–T
(0.0),
	$_D–T1
(0.0)

6 
	}
}

8 
	gCD–T
::~
	$CD–T
()

10 
	}
}

12 
CD–T
::
	$G‘D–T
(
CRegiÚ
 & 
RegiÚ
)

14 
_D–T
=
_D–T1
=
RegiÚ
.
_CÚŒŞSPH
._DeltaT;

49 
	}
}

	@DeltaT.h

16 #iâdeà
_DELTAT_H_


17 
	#_DELTAT_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

22 şas 
	cCD–T


24 
	mpublic
:

25 
CD–T
();

27 ~
CD–T
();

29 
	m_D–T
;

31 
	m_D–T1
;

33 
G‘D–T
(
CRegiÚ
 & 
RegiÚ
);

35 
	m´iv©e
:

	@EOS.cpp

1 
	~"EOS.h
"

3 
	gCEOS
::
	$CEOS
(
’EOSTYPE
 
Ty³
,
EOSID
)

4 :
	`_Ty³
(
Ty³
),
	$_EOSID
(
EOSID
)

6 
	}
}

8 
	gCEOS
::~
	$CEOS
()

10 
	}
}

12 
’EOSTYPE
 
CEOS
::
	$Ty³
()

14  
_Ty³
;

15 
	}
}

	@EOS.h

16 #iâdeà
_EOS_H_


17 
	#_EOS_H_


	)

19 
	e’EOSTYPE
 {
	m’Id—lGas
,
	m’W—klyCom´ess
,
	m’JWL
,
	m’IPCS
};

21 şas 
	cCEOS


23 
	mpublic
:

24 
CEOS
(
’EOSTYPE
 
Ty³
,
EOSID
=0);

26 ~
CEOS
();

28 
’EOSTYPE
 
Ty³
();

30 
	m_EOSID
;

32 
	m´iv©e
:

33 
’EOSTYPE
 
_Ty³
;

	@EquSolve.cpp

1 
	~"EquSŞve.h
"

3 
	gCEquSŞve
::
	$CEquSŞve
()

5 
	}
}

7 
CEquSŞve
::~
	$CEquSŞve
()

9 
	}
}

11 
CEquSŞve
::
BICGSŞve
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
, std::veùÜ<> &
x
, cÚ¡ std::veùÜ<> &
b
, 
MaxI‹r
, 
RTC
)

13 
	gI‹r
;

14 
	gAÍha
, 
	gB‘a
, 
	gRho
, 
	gRhoOld
 = 0.0;

15 
	gbNÜm
;

16 
size_t
 
	gDim
;

18 
	gDim
 = 
b
.
size
();

20 
	g¡d
::
veùÜ
<> 
r
;

21 
	g¡d
::
veùÜ
<> 
r_
;

22 
	g¡d
::
veùÜ
<> 
p
;

23 
	g¡d
::
veùÜ
<> 
p_
;

24 
	g¡d
::
veùÜ
<> 
q
;

26 
	gr
.
»size
(
Dim
,0);

27 
	gr_
.
»size
(
Dim
,0);

28 
	gp
.
»size
(
Dim
,0);

29 
	gp_
.
»size
(
Dim
,0);

30 
	gq
.
»size
(
Dim
,0);

32 
	g¡d
::
veùÜ
<> 
v»s1
;

33 
	g¡d
::
veùÜ
<> 
v»s2
;

35 
	gv»s1
.
»size
(
Dim
,0);

36 
	gv»s2
.
»size
(
Dim
,0);

38 
	gbNÜm
=
_O³¿tÜ
.
SumSqu¬e
(
b
);

40 
	gI‹r
=0;

43 if(!
IsZ”o
(
_O³¿tÜ
.
SumFabs
(
x
)/
Dim
))

45 
	g_O³¿tÜ
.
MuÉi_MV
(
A
,
x
,
v»s1
);

46 
	g_O³¿tÜ
.
Subs_VV
(
b
,
v»s1
,
v»s2
);

47 
	gr
=
v»s2
;

51 
	gr
=
b
;

55 
	gr_
=
r
;

57 (!
RTCCŒl
(
_O³¿tÜ
.
SumSqu¬e
(
r
), 
bNÜm
,
RTC
))&& 
	gI‹r
 < 
	gMaxI‹r
)

59 
	gI‹r
++;

61 
	gRho
 = 
_O³¿tÜ
.
MuÉi_VV
(
r
, 
r_
);

63 ià(
IsZ”o
(
Rho
))

65 
	gcout
<<"E¼Ü wh’ sŞvm©rixƒqu©iÚ"<<
	g’dl
;

66 
	gcout
<<"E¼Ü:Rho=0"<<
	g’dl
;

70 ià(
	gI‹r
 == 1)

72 
p
=
r
;

73 
	gp_
=
r_
;

78 
	gB‘a
 = 
Rho
 / 
RhoOld
;

80 
	g_O³¿tÜ
.
MuÉi_SV
(
B‘a
, 
p
,
v»s1
);

81 
	g_O³¿tÜ
.
Addi_VV
(
r
,
v»s1
,
v»s2
);

82 
	gp
=
v»s2
;

84 
	g_O³¿tÜ
.
MuÉi_SV
(
B‘a
,
p_
,
v»s1
);

85 
	g_O³¿tÜ
.
Addi_VV
(
r_
,
v»s1
,
v»s2
);

86 
	gp_
=
v»s2
;

89 
	g_O³¿tÜ
.
MuÉi_MV
(
A
,
p
,
q
);

91 
	gAÍha
 = 
Rho
/
_O³¿tÜ
.
MuÉi_VV
(
p_
,
q
);

93 
	g_O³¿tÜ
.
MuÉi_SV
(
AÍha
,
p
,
v»s1
);

94 
	g_O³¿tÜ
.
AddAsign_VV
(
x
,
v»s1
);

96 
	g_O³¿tÜ
.
MuÉi_SV
(
AÍha
,
q
,
v»s1
);

97 
	g_O³¿tÜ
.
SubAsign_VV
(
r
,
v»s1
);

99 
	g_O³¿tÜ
.
MuÉi_MtV
(
A
,
p_
,
v»s1
);

100 
	g_O³¿tÜ
.
MuÉi_SV
(
AÍha
,
v»s1
,
v»s2
);

101 
	g_O³¿tÜ
.
SubAsign_VV
(
r_
,
v»s2
);

103 
	gRhoOld
 = 
Rho
;

106 
	gr
.
ş—r
();

107 
	gr_
.
ş—r
();

108 
	gp
.
ş—r
();

109 
	gp_
.
ş—r
();

110 
	gq
.
ş—r
();

112 
	gv»s1
.
ş—r
();

113 
	gv»s2
.
ş—r
();

116 
	gCEquSŞve
::
	$RTCCŒl
(
rNÜm
,
bNÜm
,
RTC
)

118 
ResuÉ
;

120 ià(
rNÜm
 < 
RTC
*
bNÜm
 || (
	`IsZ”o
(bNÜmè&& 
	`IsOÃ
(1.0 +„Norm)))

121 
ResuÉ
 = 1;

123 
ResuÉ
 = 0;

126 (
ResuÉ
);

127 
	}
}

	@EquSolve.h

16 #iâdeà
_EQUSOLVE_H_


17 
	#_EQUSOLVE_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"O³¿tÜ.h
"

22 
	~"M©rix.h
"

23 
	~<cm©h
>

24 
	~<veùÜ
>

25 
	~<io¡»am
>

27 şas 
	cCEquSŞve


29 
	mpublic
:

31 
CEquSŞve
();

33 ~
CEquSŞve
();

35 
BICGSŞve
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
,¡d::veùÜ<> &
x
,cÚ¡ std::veùÜ<> &
b
,
MaxI‹r
,
RTC
);

37 
	m´iv©e
:

39 
CO³¿tÜ
 
_O³¿tÜ
;

41 
RTCCŒl
(
rNÜm
,
bNÜm
,
RTC
);

	@ExtForce.cpp

1 
	~"ExtFÜû.h
"

4 
	gCExtFÜû
::
	$CExtFÜû
()

6 
	}
}

8 
CExtFÜû
::~
	$CExtFÜû
()

10 
	}
}

12 
CExtFÜû
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

14 
CSPHPt
 * 
SPHPtPŒ
;

15 
CP¬t
 * 
P¬tPŒ
;

16 
ID
,
ID2
,
PID
;

18 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

20 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

21 
PID
=
RegiÚ
.
_PtLi¡
[
ID
].
_PID
;

23 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

25 
RegiÚ
.
_PtLi¡
[
ID
].
_du
+=RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fx
;

26 
RegiÚ
.
_PtLi¡
[
ID
].
_dv
+=RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fy
;

31 
ID2
=
RegiÚ
.
_PtLi¡
[
ID
].
_ID2
;

33 
RegiÚ
.
_SPHbu
[
ID2
-1]+=RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fx
;

34 
RegiÚ
.
_SPHbv
[
ID2
-1]+=RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fy
;

37 
	}
}

39 
	gCExtFÜû
::
	$SŞve2
Ğ
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
 )

41 
CSPHPt
 * 
SPHPtPŒ
;

42 
CP¬t
 * 
P¬tPŒ
;

43 
ID
,
ID2
,
PID
;

44 
Time
;

45 
z™a
;

46 
TDamp
;

48 
TDamp
=
RegiÚ
.
_CÚŒŞSPH
.
_TDamp
;

50 ià(
TDamp
!=0)

52 
Time
=
RegiÚ
.
_CÚŒŞSPH
.
_D–T
*
TimeS‹ps
;

54 ià(
Time
<=
TDamp
)

56 
z™a
=0.5*(
	`sš
(3.14159*(-0.5+
Time
/
TDamp
))+1);

61 
z™a
=1;

67 
z™a
=1;

71 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

73 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

74 
PID
=
RegiÚ
.
_PtLi¡
[
ID
].
_PID
;

76 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

78 
RegiÚ
.
_PtLi¡
[
ID
].
_du
+=
z™a
*RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fx
;

79 
RegiÚ
.
_PtLi¡
[
ID
].
_dv
+=
z™a
*RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fy
;

84 
ID2
=
RegiÚ
.
_PtLi¡
[
ID
].
_ID2
;

86 
RegiÚ
.
_SPHbu
[
ID2
-1]+=
z™a
*RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fx
;

87 
RegiÚ
.
_SPHbv
[
ID2
-1]+=
z™a
*RegiÚ.
_ExtFÜûLi¡
[
PID
-1]->
_fy
;

90 
	}
}

	@ExtForce.h

16 #iâdeà
_EXTFORCE_H_


17 
	#_EXTFORCE_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

22 
	~<cm©h
>

24 şas 
	cCExtFÜû


26 
	mpublic
:

27 
CExtFÜû
();

29 ~
CExtFÜû
();

31 
SŞve
(
CRegiÚ
 &
RegiÚ
);

32 
SŞve2
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
);

34 
	m´iv©e
:

	@Force.cpp

1 
	~"FÜû.h
"

3 
	gCFÜû
::
	$CFÜû
(
size_t
 
PID
)

4 :
	`_PID
(
PID
),
	`_fx
(0.0),
	`_fy
(0.0),
	$_fz
(0.0)

6 
	}
}

8 
	gCFÜû
::~
	$CFÜû
()

10 
	}
}

	@Force.h

16 #iâdeà
_FORCE_H_


17 
	#_FORCE_H_


	)

18 
	~<veùÜ
>

20 şas 
	cCFÜû


22 
	mpublic
:

23 
CFÜû
(
size_t
 
PID
=0);

25 ~
CFÜû
();

27 
size_t
 
	m_PID
;

29 
	m_fx
;

31 
	m_fy
;

33 
	m_fz
;

34 
	m´iv©e
:

	@GetDumProperty.cpp

1 
	~"G‘DumPrİ”ty.h
"

3 
	gCG‘DumPrİ”ty
::
	$CG‘DumPrİ”ty
()

6 
	}
}

8 
CG‘DumPrİ”ty
::~
	$CG‘DumPrİ”ty
()

11 
	}
}

13 
CG‘DumPrİ”ty
::
	$SŞve
Ğ
CRegiÚ
 &
RegiÚ
 )

15 
CBa£Pt
 * 
PtPŒ
;

16 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

17 
CKÆ
 * 
KÆPŒ
;

18 
g
;

20 
xij
,
yij
;

21 
mi
,
mj
;

22 
rhoi
,
rhoj
;

24 
g
=
RegiÚ
.
_ExtFÜûLi¡
[1]->
_fy
;

28 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

30 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

32 ià(
PtPŒ
->
_Ty³
==
’DumPt
)

34 
PtPŒ
->
_p
=0.0;

36 
PtPŒ
->
_ePhi
=0.0;

40 
PtPŒ
->
_CSPMCÛf
=0.0;

46 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

48 ià(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHDumPtPaœ
)

50 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

51 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

53 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

55 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

56 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

58 
PtjPŒ
->
_CSPMCÛf
+=
KÆPŒ
->
_W
;

60 
PtjPŒ
->
_p
+=
PtiPŒ
->_p*
KÆPŒ
->
_W
-
g
*
yij
*PtiPŒ->
_rho
*KnlPtr->_W;

62 
PtjPŒ
->
_ePhi
+=
PtiPŒ
->_ePhi*
KÆPŒ
->
_W
;

110 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

112 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

114 ià(
PtPŒ
->
_Ty³
==
’DumPt
&&PtPŒ->
_CSPMCÛf
!=0)

116 
PtPŒ
->
_p
/=PtPŒ->
_CSPMCÛf
;

118 
PtPŒ
->
_ePhi
/=PtPŒ->
_CSPMCÛf
;

126 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

128 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

130 ià(
PtPŒ
->
_Ty³
==
’DumPt
 )

132 
PtPŒ
->
_u
=0.0;

133 
PtPŒ
->
_v
=0.0;

135 
PtPŒ
->
_CSPMCÛf
=0.0;

140 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

142 ià(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHDumPtPaœ
)

144 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

145 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

147 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

151 
PtjPŒ
->
_CSPMCÛf
+=
KÆPŒ
->
_W
;

153 
PtjPŒ
->
_u
+=
PtiPŒ
->_u*
KÆPŒ
->
_W
;

154 
PtjPŒ
->
_v
+=
PtiPŒ
->_v*
KÆPŒ
->
_W
;

159 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

161 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

163 ià(
PtPŒ
->
_Ty³
==
’DumPt
)

165 ià(
PtPŒ
->
_CSPMCÛf
!=0)

167 
PtPŒ
->
_u
/=PtPŒ->
_CSPMCÛf
;

168 
PtPŒ
->
_v
/=PtPŒ->
_CSPMCÛf
;

170 
PtPŒ
->
_u
=2*PtPŒ->
_uw®l
-PtPtr->_u;

171 
PtPŒ
->
_v
=2*PtPŒ->
_vw®l
-PtPtr->_v;

173 
PtPŒ
->
_CSPMCÛf
=0.0;

178 
	}
}

	@GetDumProperty.h

16 #iâdeà
_GETDUMPROPERTY_H_


17 
	#_GETDUMPROPERTY_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"O³¿tÜ.h
"

23 
	~<cm©h
>

25 şas 
	cCG‘DumPrİ”ty


27 
	mpublic
:

28 
CG‘DumPrİ”ty
();

30 ~
CG‘DumPrİ”ty
();

32 
SŞve
(
CRegiÚ
 &
RegiÚ
);

34 
	m´iv©e
:

35 
CO³¿tÜ
 
_O³¿tÜGD
;

	@GetKnlList.cpp

1 
	~"G‘KÆLi¡.h
"

3 
	gCG‘KÆLi¡
::
	$CG‘KÆLi¡
(
’KNLTYPE
 
Ty³
)

4 :
	$_Ty³
(
Ty³
)

6 
_nÜm
=15.0/(7.0*3.1415926);

7 
	}
}

9 
	gCG‘KÆLi¡
::~
	$CG‘KÆLi¡
()

11 
	}
}

13 
CG‘KÆLi¡
::
	$G‘KÆLi¡
(
CRegiÚ
 &
RegiÚ
)

15 
CKÆ
 *
KÆPŒ
;

16 
CKÆ
 *
KÆ2PŒ
;

17 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

18 
x
,
y
,
h
,
H
,
di¡ªû2
;

19 
icouÁ
=0;

20 
MAXX
,
MINX
;

21 
DisCr™
;

23 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

25 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

26 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

27 
DisCr™
=
RegiÚ
.
_PtLi¡
[0].
_r
*2;

30 
RegiÚ
.
_KÆLi¡
.
	`»size
(RegiÚ.
_PtPaœLi¡
.
	`size
());

32 
icouÁ
=0;

33 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

35 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ


36 ||
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHBndPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHDumPtPaœ
)

38 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

39 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

41 
x
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

42 
y
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

43 
h
=0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h);

45 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

47 if(
x
>
DisCr™
)

48 
x
=x-(
MAXX
-
MINX
);

49 if(
x
<-
DisCr™
)

50 
x
=x+(
MAXX
-
MINX
);

53 
di¡ªû2
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
;

55 
	`G‘W
(
x
,
y
,
h
,
di¡ªû2
,
RegiÚ
.
_KÆLi¡
[
icouÁ
].
_W
,RegiÚ._KÆLi¡[icouÁ].
_Wx
,RegiÚ._KÆLi¡[icouÁ].
_Wy
,RegiÚ._KÆLi¡[icouÁ].
_Ww
);

64 
icouÁ
++;

90 
	}
}

92 
	gCG‘KÆLi¡
::
	$G‘W
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
Ww
)

94 
s
;

95 
‰t
;

96 
di¡ªû
;

97 
dW
;

98 
‹rm
;

100 if(
di¡ªû2
!=0.0)

102 
di¡ªû
=
	`sq¹
(
di¡ªû2
);

103 
s
=
di¡ªû
/
h
;

105 if(
s
<1)

107 
W
=0.66666667-
s
*s+0.5*s*s*s;

108 
dW
=-2*
s
+1.5*s*s;

110 if(
s
<2)

112 
‰t
=2-
s
;

113 
W
=0.166666667*
‰t
*ttt*ttt;

114 
dW
=-0.5*
‰t
*ttt;

118 
W
=0;

119 
dW
=0;

122 
W
*=(
_nÜm
/(
h
*h));

123 
‹rm
=
dW
*
_nÜm
/(
h
*h*h*
di¡ªû
);

124 
Ww
=
‹rm
;

125 
Wx
=
‹rm
*
x
;

126 
Wy
=
‹rm
*
y
;

130 
W
=0.66666667*(
_nÜm
/(
h
*h));

131 
Wx
=0.0;

132 
Wy
=0.0;

134 
	}
}

136 
	gCG‘KÆLi¡
::
	$G‘W2
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
W2
)

138 
s
;

139 
‰t
;

140 
di¡ªû
;

141 
dW
;

142 
‹rm
;

144 if(
di¡ªû2
!=0.0)

146 
di¡ªû
=
	`sq¹
(
di¡ªû2
);

147 
s
=
di¡ªû
/
h
;

149 if(
s
<1)

151 
W
=0.66666667-
s
*s+0.5*s*s*s;

152 
dW
=-2*
s
+1.5*s*s;

154 if(
s
<2)

156 
‰t
=2-
s
;

157 
W
=0.166666667*
‰t
*ttt*ttt;

158 
dW
=-0.5*
‰t
*ttt;

162 
W
=0;

163 
dW
=0;

166 
W
*=(
_nÜm
/(
h
*h));

167 
‹rm
=
dW
*
_nÜm
/(
h
*h*h*
di¡ªû
);

168 
Wx
=
‹rm
*
x
;

169 
Wy
=
‹rm
*
y
;

173 
W
=0.66666667*(
_nÜm
/(
h
*h));

174 
Wx
=0.0;

175 
Wy
=0.0;

177 
	}
}

179 
	gCG‘KÆLi¡
::
	$G‘W0
(
di¡ªû0
,
h
,& 
W
)

181 
s
;

182 
‰t
;

184 if(
di¡ªû0
!=0.0)

186 
s
=
di¡ªû0
/
h
;

188 if(
s
<1)

190 
W
=0.66666667-
s
*s+0.5*s*s*s;

192 if(
s
<2)

194 
‰t
=2-
s
;

195 
W
=0.166666667*
‰t
*ttt*ttt;

199 
W
=0;

201 
W
*=(
_nÜm
/(
h
*h));

205 
W
=0.66666667*(
_nÜm
/(
h
*h));

207 
	}
}

210 
	gCG‘KÆLi¡
::
	$CË¬KÆLi¡
(
CRegiÚ
 &
RegiÚ
)

231 
RegiÚ
.
_KÆLi¡
.
	`ş—r
();

233 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

235 
RegiÚ
.
_KÆLi¡2
.
	`ş—r
();

237 
	}
}

240 
	gCG‘KÆLi¡
::
	$G‘CrùKÆG¿d
(
CRegiÚ
 & 
RegiÚ
,
CBa£Pt
 * 
PtPŒ
,
CKÆ
 * 
KÆPŒ
,& 
wcx
,& 
wcy
)

242 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

244 
_CSPMG
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

247 
L11
,
L12
,
L21
,
L22
;

249 
L11
=-
PtPŒ
->
_CSPMAxx
; 
L12
=-PtPŒ->
_CSPMAyx
;

250 
L21
=-
PtPŒ
->
_CSPMAxy
; 
L22
=-PtPŒ->
_CSPMAyy
;

252 
_O³¿tÜG
.
	`Reve2ndM©
(
L11
,
L12
,
L21
,
L22
,

253 &
L11
,&
L12
,&
L21
,&
L22
);

255 
wcx
=
L11
*
KÆPŒ
->
_Wx
+
L12
*KÆPŒ->
_Wy
;

256 
wcy
=
L21
*
KÆPŒ
->
_Wx
+
L22
*KÆPŒ->
_Wy
;

257 
	}
}

259 
	gCG‘KÆLi¡
::
	$G‘MshKÆLi¡
Ğ
CRegiÚ
 &
RegiÚ
 )

261 
CKÆ
 *
KÆPŒ
;

262 
CKÆ
 *
KÆ2PŒ
;

263 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

264 
CMesh
 * 
MshjPŒ
;

265 
x
,
y
,
h
,
H
,
di¡ªû2
;

266 
icouÁ
=0;

267 
MAXX
,
MINX
;

269 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

271 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

272 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

275 
RegiÚ
.
_PtMshKÆLi¡
.
	`»size
(RegiÚ.
_PtMshPaœLi¡
.
	`size
());

277 
icouÁ
=0;

278 
size_t
 
i
=0;i<
RegiÚ
.
_PtMshPaœLi¡
.
	`size
();i++)

280 
PtiPŒ
=
RegiÚ
.
_PtMshPaœLi¡
[
i
].
_PtiPŒ
;

281 
MshjPŒ
=
RegiÚ
.
_PtMshPaœLi¡
[
i
].
_MshjPŒ
;

283 
x
=
PtiPŒ
->
_x
-
MshjPŒ
->_x;

284 
y
=
PtiPŒ
->
_y
-
MshjPŒ
->_y;

286 
h
=
PtiPŒ
->
_h
;

288 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

290 if(
x
>4*
h
)

291 
x
=x-(
MAXX
-
MINX
);

292 if(
x
<-4*
h
)

293 
x
=x+(
MAXX
-
MINX
);

296 
di¡ªû2
=
RegiÚ
.
_PtMshPaœLi¡
[
i
].
_drŸc2
;

298 
	`G‘W
(
x
,
y
,
h
,
di¡ªû2
,
RegiÚ
.
_PtMshKÆLi¡
[
icouÁ
].
_W
,RegiÚ._PtMshKÆLi¡[icouÁ].
_Wx
,RegiÚ._PtMshKÆLi¡[icouÁ].
_Wy
,RegiÚ._PtMshKÆLi¡[icouÁ].
_Ww
);

299 
icouÁ
++;

301 
	}
}

	@GetKnlList.h

16 #iâdeà
_GETKNLLIST_H_


17 
	#_GETKNLLIST_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"Ba£Pt.h
"

21 
	~"KÆ.h
"

22 
	~"SPHPt.h
"

23 
	~"CSPM.h
"

24 
	~"O³¿tÜ.h
"

25 
	~"Mesh.h
"

26 
	~<cm©h
>

28 
	e’KNLTYPE
 {
	m’B3SKÆ
, 
	m’B4NSKÆ
,
	m’B4SPKÆ
,
	m’B5SPKÆ
,
	m’BGKÆ
};

31 şas 
	cCG‘KÆLi¡


33 
	mpublic
:

35 
CG‘KÆLi¡
(
’KNLTYPE
 
Ty³
=
’B3SKÆ
);

37 ~
CG‘KÆLi¡
();

39 
’KNLTYPE
 
	m_Ty³
;

41 
G‘KÆLi¡
(
CRegiÚ
 &
RegiÚ
);

42 
G‘MshKÆLi¡
(
CRegiÚ
 &
RegiÚ
);

44 
G‘CrùKÆG¿d
(
CRegiÚ
 & 
RegiÚ
,
CBa£Pt
 * 
PtPŒ
,
CKÆ
 * 
KÆPŒ
,& 
wcx
,& 
wcy
);

46 
CË¬KÆLi¡
(
CRegiÚ
 &
RegiÚ
);

48 
G‘W0
(
di¡ªû0
,
h
,& 
W
);

50 
	m´iv©e
:

51 
_nÜm
;

53 
CCSPM
 
	m_CSPMG
;

55 
CO³¿tÜ
 
	m_O³¿tÜG
;

57 
G‘W
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
Ww
);

59 
G‘W2
(
x
,
y
,
h
,
di¡ªû2
,& 
W
,& 
Wx
,& 
Wy
,& 
W2
);

	@IdealGas.cpp

1 
	~"Id—lGas.h
"

2 
	~<veùÜ
>

4 
	gCId—lGas
::
	$CId—lGas
(
Cp
,
Mw
,
R
,
EOSID
)

5 :
	`CEOS
(
’Id—lGas
,
EOSID
),
	`_Cp
(
Cp
),
	`_Mw
(
Mw
),
	$_R
(
R
)

7 
_Rg
=
_R
/
_Mw
;

8 
_Cv
=
_Cp
-
_Rg
;

9 
_gama1
=
_Rg
/
_Cv
;

10 
_gama
=
_gama1
+1.0;

11 
	}
}

13 
	gCId—lGas
::~
	$CId—lGas
()

15 
	}
}

17 
CId—lGas
::
	$EOS
(
rho
,
e
,&
p
,&
c
)

19 
p
=
_gama1
*
rho
*
e
;

20 
c
=
	`sq¹
(
¡d
::
	`max
(
_gama
*
_gama1
*
e
,0.0));

21 
	}
}

23 
	gCId—lGas
::
	$EOS2
(
rho
,
T
,&
p
,&
c
)

25 
p
=
_gama1
*
rho
*
_Cv
*
T
;

26 
c
=
	`sq¹
(
¡d
::
	`max
(
_gama1
*(_gama1-1)*
_Cv
*
T
,0.0));

27 
	}
}

	@IdealGas.h

16 #iâdeà
_IDEALGAS_H_


17 
	#_IDEALGAS_H_


	)

20 
	~"EOS.h
"

21 
	~<cm©h
>

22 şas 
	cCId—lGas
:
public
 
CEOS


24 
public
:

25 
CId—lGas
(
Cp
,
Mw
,
R
,
EOSID
=0);

27 ~
CId—lGas
();

29 
	m_Cp
;

31 
	m_Mw
;

33 
	m_R
;

36 
EOS
(
rho
,
e
,&
p
,&
c
);

39 
EOS2
(
rho
,
T
,&
p
,&
c
);

41 
	m´iv©e
:

42 
_gama
;

44 
	m_gama1
;

46 
	m_Rg
;

48 
	m_Cv
;

	@IdentPtLocal.cpp

1 
	~"Id’tPtLoÿl.h
"

3 
	gCId’tPtLoÿl
::
	$CId’tPtLoÿl
()

6 
	}
}

8 
CId’tPtLoÿl
::~
	$CId’tPtLoÿl
()

11 
	}
}

14 
CId’tPtLoÿl
::
	$Id’tPtLoÿl
(
CRegiÚ
 & 
RegiÚ
)

16 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

18 
_CSPMI
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

21 
CBa£Pt
 * 
Ba£PtPŒ
;

23 
ID
;

25 
Axx
,
Axy
,
Ayx
,
Ayy
;

27 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

29 
_CSPMI
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

33 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

35 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

37 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

39 
Axx
=-
Ba£PtPŒ
->
_CSPMAxx
;

40 
Ayx
=-
Ba£PtPŒ
->
_CSPMAyx
;

41 
Axy
=-
Ba£PtPŒ
->
_CSPMAxy
;

42 
Ayy
=-
Ba£PtPŒ
->
_CSPMAyy
;

46 
Ba£PtPŒ
->
_CSPMmšLambda
=
_O³¿‹rI
.
	`MšEig2ndM©
(
Axx
,
Axy
,
Ayx
,
Ayy
);

49 
	}
}

	@IdentPtLocal.h

1 #iâdeà
_INDENTPTLOCAL_H_


2 
	#_INDENTPTLOCAL_H_


	)

4 
	~"RegiÚ.h
"

5 
	~"Ba£Pt.h
"

6 
	~"KÆ.h
"

7 
	~"PtPaœ.h
"

8 
	~"CSPM.h
"

9 
	~"O³¿tÜ.h
"

10 
	~<veùÜ
>

11 
	~<cm©h
>

13 şas 
	cCId’tPtLoÿl


15 
	mpublic
:

16 
CId’tPtLoÿl
();

18 ~
CId’tPtLoÿl
();

20 
Id’tPtLoÿl
(
CRegiÚ
 & 
RegiÚ
);

22 
	m´iv©e
:

23 
CCSPM
 
_CSPMI
;

25 
CO³¿tÜ
 
	m_O³¿‹rI
;

	@KFile.cpp

1 
	~"KFe.h
"

3 
	~<¡ršg
>

4 
	~<f¡»am
>

5 
	~<s¡»am
>

6 
	~<io¡»am
>

7 
	~<iomª
>

8 
	~<cm©h
>

13 
	gCKFe
::
	$CKFe
()

15 
	}
}

17 
CKFe
::~
	$CKFe
()

19 
	}
}

21 
CKFe
::
	$IÅut
(
CRegiÚ
 & 
RegiÚ
)

23 
¡ršg
 
keywÜd
;

24 
¡ršg
 
lše
;

25 
veùÜ
<> 
X
,
Y
,
Z
;

26 
v®ue
;

27 
PID
,
SECID
,
EOSID
,
ID
;

28 
tch
;

30 
if¡»am
 
šfe
;

31 
o¡ršg¡»am
 
šf’ame
;

32 
šf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<".k";

33 
šfe
.
	`İ’
(
šf’ame
.
	`¡r
().
	`d©a
(),
ios
::
š
);

34 ià(!
šfe
)

36 
cout
<<"KFcould‚Ù bİ’."<<
’dl
;

42 
cout
<<"S¹ R—dšg KFe."<<
’dl
;

46 !
šfe
.
	`eof
())

48 
šfe
>>
keywÜd
;

50 if(
keywÜd
=="*RUN_MODE")

52 
	`g‘lše
(
šfe
,
lše
);

54 
šfe
>>
v®ue
;

55 
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
=
	`size_t
(
v®ue
);

58 if(
keywÜd
=="*START_STEP")

60 
	`g‘lše
(
šfe
,
lše
);

62 
šfe
>>
v®ue
;

63 
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
=
	`size_t
(
v®ue
);

66 
CP¬t
 
P¬tI
;

67 
PtTy³ID
;

68 if(
keywÜd
=="*PART")

70 
	`g‘lše
(
šfe
,
lše
);

74 
šfe
>>
tch
;

75 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

76 if((
tch
=='*')||(tch=='$')) ;

78 
šfe
>>
v®ue
;

79 
šfe
.
	`ignÜe
();

80 
PID
=
	`size_t
(
v®ue
);

81 
P¬tI
.
_PID
=
PID
;

83 
šfe
>>
v®ue
;

84 
šfe
.
	`ignÜe
();

85 
PtTy³ID
=
	`size_t
(
v®ue
);

87 
šfe
>>
v®ue
;

88 
šfe
.
	`ignÜe
();

89 
P¬tI
.
_MID
=
	`size_t
(
v®ue
);

91 
šfe
>>
v®ue
;

92 
šfe
.
	`ignÜe
();

93 
P¬tI
.
_EOSID
=
	`size_t
(
v®ue
);

95 
šfe
>>
v®ue
;

96 
šfe
.
	`ignÜe
();

97 
P¬tI
.
_C0
=(
v®ue
);

99 
šfe
>>
v®ue
;

100 
šfe
.
	`ignÜe
();

101 
P¬tI
.
_HdivDp
=(
v®ue
);

103 
šfe
>>
v®ue
;

104 
šfe
.
	`ignÜe
();

105 
P¬tI
.
_VisK
=(
v®ue
);

107 
šfe
>>
v®ue
;

108 
šfe
.
	`ignÜe
();

109 
P¬tI
.
_VisN
=(
v®ue
);

111 
šfe
>>
v®ue
;

112 
šfe
.
	`ignÜe
();

113 
P¬tI
.
_eK­·
=(
v®ue
);

115 
šfe
>>
v®ue
;

117 
P¬tI
.
_eEpsÚ
=(
v®ue
);

121 if(
PtTy³ID
==1)

122 
P¬tI
.
_P¬tTy³
=
’SPH
;

123 if(
PtTy³ID
==2)

124 
P¬tI
.
_P¬tTy³
=
’NULL
;

125 if(
PtTy³ID
==3)

126 
P¬tI
.
_P¬tTy³
=
’Bnd
;

127 if(
PtTy³ID
==4)

128 
P¬tI
.
_P¬tTy³
=
’Gho¡1
;

129 if(
PtTy³ID
==5)

130 
P¬tI
.
_P¬tTy³
=
’Gho¡2
;

131 if(
PtTy³ID
==6)

132 
P¬tI
.
_P¬tTy³
=
’Dummy
;

133 if(
PtTy³ID
==7)

134 
P¬tI
.
_P¬tTy³
=
’EHDDum
;

135 if(
PtTy³ID
==8)

136 
P¬tI
.
_P¬tTy³
=
’EHDBnd
;

138 
RegiÚ
.
_P¬tLi¡
.
	`push_back
(
P¬tI
);

142 if(
keywÜd
=="*CONTROL_SPH1")

144 
	`g‘lše
(
šfe
,
lše
);

146 
šfe
>>
v®ue
;

147 
šfe
.
	`ignÜe
();

148 
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
=
	`size_t
(
v®ue
);

150 
šfe
>>
v®ue
;

151 
šfe
.
	`ignÜe
();

152 
RegiÚ
.
_CÚŒŞSPH
.
_SPHPV
=
	`size_t
(
v®ue
);

154 
šfe
>>
v®ue
;

155 
šfe
.
	`ignÜe
();

156 
RegiÚ
.
_CÚŒŞSPH
.
_SPHAV
=
	`size_t
(
v®ue
);

158 
šfe
>>
v®ue
;

159 
šfe
.
	`ignÜe
();

160 
RegiÚ
.
_CÚŒŞSPH
.
_SPHAS
=
	`size_t
(
v®ue
);

162 
šfe
>>
v®ue
;

163 
šfe
.
	`ignÜe
();

164 
RegiÚ
.
_CÚŒŞSPH
.
_ADD–
=(
v®ue
);

166 
šfe
>>
v®ue
;

167 
šfe
.
	`ignÜe
();

168 
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
=(
v®ue
);

170 
šfe
>>
v®ue
;

171 
šfe
.
	`ignÜe
();

172 
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
=
	`size_t
(
v®ue
);

174 
šfe
>>
v®ue
;

175 
šfe
.
	`ignÜe
();

176 
RegiÚ
.
_CÚŒŞSPH
.
_TDamp
=(
v®ue
);

178 
šfe
>>
v®ue
;

180 
RegiÚ
.
_CÚŒŞSPH
.
_PtSháB‘a
=(
v®ue
);

183 
RegiÚ
.
_CÚŒŞSPH
.
_SPHIPCS
=0;

184 
RegiÚ
.
_CÚŒŞSPH
.
_VSL
=0;

187 if(
keywÜd
=="*CONTROL_SPH2")

189 
	`g‘lše
(
šfe
,
lše
);

191 
šfe
>>
v®ue
;

192 
šfe
.
	`ignÜe
();

193 
RegiÚ
.
_CÚŒŞSPH
.
_Cs
=(
v®ue
);

195 
šfe
>>
v®ue
;

196 
šfe
.
	`ignÜe
();

197 
RegiÚ
.
_CÚŒŞSPH
.
_D–T
=(
v®ue
);

199 
šfe
>>
v®ue
;

200 
šfe
.
	`ignÜe
();

201 
RegiÚ
.
_CÚŒŞSPH
.
_Fš®Time
=(
v®ue
);

203 
šfe
>>
v®ue
;

205 
RegiÚ
.
_CÚŒŞSPH
.
_OuutS‹ps
=
	`size_t
(
v®ue
);

208 if(
keywÜd
=="*CELL_NUM")

210 
	`g‘lše
(
šfe
,
lše
);

212 
šfe
>>
v®ue
;

213 
šfe
.
	`ignÜe
();

214 
RegiÚ
.
_CÚŒŞSPH
.
_C–lNumx
=
	`size_t
(
v®ue
);

216 
šfe
>>
v®ue
;

218 
RegiÚ
.
_CÚŒŞSPH
.
_C–lNumy
=
	`size_t
(
v®ue
);

221 if(
keywÜd
=="*CALCULATION_RANGE")

223 
	`g‘lše
(
šfe
,
lše
);

225 
šfe
>>
v®ue
;

227 
RegiÚ
.
_CÚŒŞSPH
.
_Xümš
=(
v®ue
);

229 
šfe
>>
v®ue
;

230 
šfe
.
	`ignÜe
();

231 
RegiÚ
.
_CÚŒŞSPH
.
_Xümax
=(
v®ue
);

233 
šfe
>>
v®ue
;

235 
RegiÚ
.
_CÚŒŞSPH
.
_Yümš
=(
v®ue
);

237 
šfe
>>
v®ue
;

239 
RegiÚ
.
_CÚŒŞSPH
.
_Yümax
=(
v®ue
);

242 if(
keywÜd
=="*SPH_AV")

244 
	`g‘lše
(
šfe
,
lše
);

246 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHAV
==1)

248 
šfe
>>
v®ue
;

249 
šfe
.
	`ignÜe
();

250 
RegiÚ
.
_CÚŒŞSPH
.
_AVAÍha
=(
v®ue
);

252 
šfe
>>
v®ue
;

253 
šfe
.
	`ignÜe
();

254 
RegiÚ
.
_CÚŒŞSPH
.
_AVB‘a
=(
v®ue
);

256 
šfe
>>
v®ue
;

258 
RegiÚ
.
_CÚŒŞSPH
.
_AVE
=(
v®ue
);

262 if(
keywÜd
=="*SPH_AS")

264 
	`g‘lše
(
šfe
,
lše
);

266 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHAS
==1)

268 
šfe
>>
v®ue
;

269 
šfe
.
	`ignÜe
();

270 
RegiÚ
.
_CÚŒŞSPH
.
_ASEpsÚ1
=(
v®ue
);

272 
šfe
>>
v®ue
;

273 
šfe
.
	`ignÜe
();

274 
RegiÚ
.
_CÚŒŞSPH
.
_ASEpsÚ2
=(
v®ue
);

276 
šfe
>>
v®ue
;

278 
RegiÚ
.
_CÚŒŞSPH
.
_ASD–D
=(
v®ue
);

294 if(
keywÜd
=="*DENSITY_RENORMSTEPS")

296 
	`g‘lše
(
šfe
,
lše
);

298 
šfe
>>
v®ue
;

300 
RegiÚ
.
_CÚŒŞSPH
.
_D’sR’ÜmS‹ps
=
	`size_t
(
v®ue
);

303 if(
keywÜd
=="*PERIOD_BOUNDARY")

305 
	`g‘lše
(
šfe
,
lše
);

307 
šfe
>>
v®ue
;

308 
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
=(
v®ue
);

310 
šfe
>>
v®ue
;

311 
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
=(
v®ue
);

314 
CId—lGas
 *
Id—lGasPŒ
;

315 if(
keywÜd
=="*EOS_IDEAL_GAS")

317 
	`g‘lše
(
šfe
,
lše
);

319 
Cp
,
Mw
,
R
;

320 
šfe
>>
v®ue
;

321 
šfe
.
	`ignÜe
();

322 
EOSID
=
	`size_t
(
v®ue
);

324 
šfe
>>
v®ue
;

325 
šfe
.
	`ignÜe
();

326 
Cp
=(
v®ue
);

328 
šfe
>>
v®ue
;

329 
šfe
.
	`ignÜe
();

330 
Mw
=(
v®ue
);

332 
šfe
>>
v®ue
;

334 
R
=(
v®ue
);

336 
Id—lGasPŒ
=
Ãw
 
	`CId—lGas
(
Cp
,
Mw
,
R
,
EOSID
);

338 
RegiÚ
.
_EOSLi¡
.
	`push_back
(
Id—lGasPŒ
);

341 
CW—klyCom´ess
 *
W—klyCom´essPŒ
;

342 if(
keywÜd
=="*EOS_WEEKLY_COMPRESS")

344 
	`g‘lše
(
šfe
,
lše
);

346 
P0
,
gamma
,
ExtP
;

348 
šfe
>>
v®ue
;

349 
šfe
.
	`ignÜe
();

350 
EOSID
=
	`size_t
(
v®ue
);

352 
šfe
>>
v®ue
;

353 
šfe
.
	`ignÜe
();

354 
P0
=(
v®ue
);

356 
šfe
>>
v®ue
;

357 
šfe
.
	`ignÜe
();

358 
gamma
=(
v®ue
);

360 
šfe
>>
v®ue
;

361 
ExtP
=(
v®ue
);

363 
W—klyCom´essPŒ
=
Ãw
 
	`CW—klyCom´ess
(
P0
,
gamma
,
ExtP
,
EOSID
);

364 
RegiÚ
.
_EOSLi¡
.
	`push_back
(
W—klyCom´essPŒ
);

367 if(
keywÜd
=="*SURFACE_TENSION")

369 
	`g‘lše
(
šfe
,
lše
);

371 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

373 
i
=0;i!=
RegiÚ
.
_P¬tLi¡
.
	`size
();++i)

375 
šfe
>>
v®ue
;

376 
šfe
.
	`ignÜe
();

377 
PID
=
	`size_t
(
v®ue
);

379 
šfe
>>
v®ue
;

380 
šfe
.
	`ignÜe
();

381 
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STSigma
=(
v®ue
);

383 
šfe
>>
v®ue
;

385 
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STHvsh
=(
v®ue
);

390 
CFÜû
 *
FÜûPŒ
;

391 if(
keywÜd
=="*LOAD_BODYFORCE")

393 
	`g‘lše
(
šfe
,
lše
);

397 
šfe
>>
tch
;

398 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

399 if((
tch
=='*')||(tch=='$')) ;

401 
šfe
>>
v®ue
;

402 
šfe
.
	`ignÜe
();

403 
PID
=
	`size_t
(
v®ue
);

404 
FÜûPŒ
=
Ãw
 
	`CFÜû
(
PID
);

406 
šfe
>>
v®ue
;

407 
šfe
.
	`ignÜe
();

408 
FÜûPŒ
->
_fx
=(
v®ue
);

410 
šfe
>>
v®ue
;

412 
FÜûPŒ
->
_fy
=(
v®ue
);

415 
RegiÚ
.
_ExtFÜûLi¡
.
	`push_back
(
FÜûPŒ
);

419 if(
keywÜd
=="*INITIAL_SPH")

421 
	`g‘lše
(
šfe
,
lše
);

423 
i
=0;i!=
RegiÚ
.
_P¬tLi¡
.
	`size
();++i)

425 
šfe
>>
tch
;

426 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

427 if((
tch
=='*')||(tch=='$')) ;

429 
šfe
>>
v®ue
;

430 
šfe
.
	`ignÜe
();

431 
PID
=
	`size_t
(
v®ue
);

433 
šfe
>>
v®ue
;

434 
šfe
.
	`ignÜe
();

435 
_In™SPH
[
PID
-1][0]=(
v®ue
);

437 
šfe
>>
v®ue
;

438 
šfe
.
	`ignÜe
();

439 
_In™SPH
[
PID
-1][1]=(
v®ue
);

441 
šfe
>>
v®ue
;

442 
šfe
.
	`ignÜe
();

443 
_In™SPH
[
PID
-1][2]=(
v®ue
);

445 
šfe
>>
v®ue
;

446 
šfe
.
	`ignÜe
();

447 
_In™SPH
[
PID
-1][3]=(
v®ue
);

452 if(
keywÜd
=="*NODE")

454 if(
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
==0)

458 
šfe
>>
tch
;

459 if((
tch
=='*')||(tch=='$'))

461 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

464 
tch
!=',')

466 
šfe
>>
tch
;

469 
šfe
>>
v®ue
;

470 
šfe
.
	`ignÜe
();

471 
X
.
	`push_back
(
v®ue
);

473 
šfe
>>
v®ue
;

474 
šfe
.
	`ignÜe
();

475 
Y
.
	`push_back
(
v®ue
);

477 
i
=0;i<3;i++)

479 
šfe
>>
v®ue
;

480 
šfe
.
	`ignÜe
();

486 if(
keywÜd
=="*ELEMENT_SHELL_THICKNESS")

488 if(
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
==0)

493 
veùÜ
<>
	`tPosx
(4);

494 
veùÜ
<>
	`tPosy
(4);

495 
veùÜ
<>
	`tP¬te
(3);

497 
CBa£Pt
 
Ba£Pt
;

499 
šfe
>>
tch
;

500 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

501 if((
tch
=='*')||(tch=='$')) ;

503 
šfe
>>
v®ue
;

504 
šfe
.
	`ignÜe
();

505 
ID
=
	`size_t
(
v®ue
);

506 
Ba£Pt
.
_ID
=
ID
;

508 
šfe
>>
v®ue
;

509 
šfe
.
	`ignÜe
();

510 
PID
=
	`size_t
(
v®ue
);

511 
Ba£Pt
.
_PID
=
PID
;

514 
šfe
>>
v®ue
;

515 
šfe
.
	`ignÜe
();

516 
ID
=
	`size_t
(
v®ue
);

517 
tPosx
[0]=
X
[
ID
-1];

518 
tPosy
[0]=
Y
[
ID
-1];

520 
šfe
>>
v®ue
;

521 
šfe
.
	`ignÜe
();

522 
ID
=
	`size_t
(
v®ue
);

523 
tPosx
[1]=
X
[
ID
-1];

524 
tPosy
[1]=
Y
[
ID
-1];

526 
šfe
>>
v®ue
;

527 
šfe
.
	`ignÜe
();

528 
ID
=
	`size_t
(
v®ue
);

529 
tPosx
[2]=
X
[
ID
-1];

530 
tPosy
[2]=
Y
[
ID
-1];

532 
šfe
>>
v®ue
;

533 
šfe
.
	`ignÜe
();

534 
ID
=
	`size_t
(
v®ue
);

535 
tPosx
[3]=
X
[
ID
-1];

536 
tPosy
[3]=
Y
[
ID
-1];

538 
i
=0;i<4;i++)

540 
šfe
>>
v®ue
;

541 
šfe
.
	`ignÜe
();

544 
	`C’‹r
(
tPosx
,
tPosy
,
tP¬te
);

546 
Ba£Pt
.
_x
=
tP¬te
[0];

547 
Ba£Pt
.
_y
=
tP¬te
[1];

548 
Ba£Pt
.
_VŞume
=
tP¬te
[2];

550 
Ba£Pt
.
_u
=
_In™SPH
[
PID
-1][0];

551 
Ba£Pt
.
_v
=
_In™SPH
[
PID
-1][1];

553 
Ba£Pt
.
_uw®l
=
_In™SPH
[
PID
-1][0];

554 
Ba£Pt
.
_vw®l
=
_In™SPH
[
PID
-1][1];

556 
Ba£Pt
.
_rho0
=
_In™SPH
[
PID
-1][2];

557 
Ba£Pt
.
_rho
 =
_In™SPH
[
PID
-1][2];

558 
Ba£Pt
.
_T
 =
_In™SPH
[
PID
-1][3];

560 
Ba£Pt
.
_m
=Ba£Pt.
_rho0
*Ba£Pt.
_VŞume
;

562 
Ba£Pt
.
_h
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_HdivDp
*
	`pow
(Ba£Pt.
_VŞume
,0.5);

563 
Ba£Pt
.
_r
=2.0*Ba£Pt.
_h
;

564 
Ba£Pt
.
_C0
=
RegiÚ
.
_P¬tLi¡
[
PID
-1]._C0;

566 
Ba£Pt
.
_Cs
=
RegiÚ
.
_CÚŒŞSPH
._Cs;

568 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

570 
Ba£Pt
.
_H
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STHvsh
*Ba£Pt.
_h
;

571 
Ba£Pt
.
_¼
=2*Ba£Pt.
_H
;

574 
Ba£Pt
.
_p
=0;

575 
Ba£Pt
.
_Iæag
=1;

576 
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_P¬tTy³
)

578 
’SPH
:

579 
Ba£Pt
.
_Ty³
=
’SPHPt
;

581 
’NULL
:

582 
Ba£Pt
.
_Ty³
=
’NULLPt
;

584 
’Bnd
:

585 
Ba£Pt
.
_Ty³
=
’BndPt
;

587 
’Gho¡1
:

588 
Ba£Pt
.
_Ty³
=
’Gho¡1Pt
;

590 
’Gho¡2
:

591 
Ba£Pt
.
_Ty³
=
’Gho¡2Pt
;

593 
’Dummy
:

594 
Ba£Pt
.
_Ty³
=
’DumPt
;

602 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt
);

603 
tPosx
.
	`ş—r
();

604 
tPosy
.
	`ş—r
();

605 
tP¬te
.
	`ş—r
();

610 if(
keywÜd
=="*END")

617 if(
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
!=0)

619 
	`IÅutRe¡¬t
(
RegiÚ
);

621 
	}
}

623 
	gCKFe
::
C’‹r
(
veùÜ
<> &
px
,veùÜ<> &
py
,veùÜ<> &
p
)

625 
	gx5
,
	gx6
,
	gy5
,
	gy6
,
	gs12
,
	gs13
,
	gs14
,
	gs23
,
	gs34
,
	gs1
,
	gs2
,
	gA1
,
	gA2
,
	gA
,
	gxc1
,
	gxc2
,
	gyc1
,
	gyc2
;

626 
	gx5
=(
px
[2]+px[3])/2;

627 
	gy5
=(
py
[2]+py[3])/2;

628 
	gx6
=(
px
[0]+px[2])/2;

629 
	gy6
=(
py
[0]+py[2])/2;

630 
	gs12
=
sq¹
((
px
[0]-px[1])*Õx[0]-px[1])+(
py
[0]-py[1])*(py[0]-py[1]));

631 
	gs13
=
sq¹
((
px
[0]-px[2])*Õx[0]-px[2])+(
py
[0]-py[2])*(py[0]-py[2]));

632 
	gs14
=
sq¹
((
px
[0]-px[3])*Õx[0]-px[3])+(
py
[0]-py[3])*(py[0]-py[3]));

633 
	gs23
=
sq¹
((
px
[1]-px[2])*Õx[1]-px[2])+(
py
[1]-py[2])*(py[1]-py[2]));

634 
	gs34
=
sq¹
((
px
[2]-px[3])*Õx[2]-px[3])+(
py
[2]-py[3])*(py[2]-py[3]));

635 
	gs1
=(
s14
+
s13
+
s34
)/2;

636 
	gs2
=(
s13
+
s12
+
s23
)/2;

637 
	gA1
=
sq¹
(
s1
*(s1-
s14
)*(s1-
s13
)*(s1-
s34
));

638 
	gA2
=
sq¹
(
s2
*(s2-
s12
)*(s2-
s23
)*(s2-
s13
));

639 
	gxc1
=(2*
x5
+
px
[0])/3;

640 
	gyc1
=(2*
y5
+
py
[0])/3;

641 
	gxc2
=(2*
x6
+
px
[1])/3;

642 
	gyc2
=(2*
y6
+
py
[1])/3;

643 
	gA
=
A1
+
A2
;

644 
	gp
[0]=(
xc1
*
A1
+
xc2
*
A2
)/
A
;

645 
	gp
[1]=(
yc1
*
A1
+
yc2
*
A2
)/
A
;

646 
	gp
[2]=
A
;

649 
	gCKFe
::
	$OutTeılÙ
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
)

651 
of¡»am
 
outfe
;

652 
o¡ršg¡»am
 
outf’ame
;

653 
outf’ame
<<"ZTEC-"<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<
	`£tw
(8)<<
	`£tfl
('0')<<
TimeS‹ps
<<setw(4)<<".dat";

654 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

656 ià(!
outfe
)

658 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

663 
outfe


687 <<
’dl
;

688 
outfe
<<"ZONE T="<<"\""<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<" s‹°"<<
TimeS‹ps
<<"\" Iğ"<<RegiÚ.
_PtLi¡
.
	`size
()<<", F=POINT"<<
’dl
;

690 
CSPHPt
 *
SPHPtPŒ
;

691 
size_t
 
iii
=0;iii<
RegiÚ
.
_PtLi¡
.
	`size
();iii++)

693 
SPHPtPŒ
=(
CSPHPt
 *)(&
RegiÚ
.
_PtLi¡
[
iii
]);

695 
outfe


696 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

697 <<
	`£»cisiÚ
(16)

698 <<
	`£tw
(26)<<
SPHPtPŒ
->
_x
<<" "

699 <<
	`£tw
(26)<<
SPHPtPŒ
->
_y
<<" "

701 <<
	`£tw
(26)<<
SPHPtPŒ
->
_PID
<<" "

702 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID
<<" "

703 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID2
<<" "

704 <<
	`£tw
(26)<<
SPHPtPŒ
->
_rho
<<" "

706 <<
	`£tw
(26)<<
SPHPtPŒ
->
_u
<<" "

707 <<
	`£tw
(26)<<
SPHPtPŒ
->
_v
<<" "

709 <<
	`£tw
(26)<<
SPHPtPŒ
->
_p
<<" "

710 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
<<" "

711 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
/(
RegiÚ
.
_P¬tLi¡
[SPHPtPŒ->
_PID
-1].
_HdivDp
)<<" "

712 <<
	`£tw
(26)<<
SPHPtPŒ
->
_Iæag
<<" "

713 <<
	`£tw
(26)<<
SPHPtPŒ
->
_C
<<" "

714 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEpsÚ
<<" "

715 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eK­·
<<" "

716 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eRho
<<" "

717 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ePhi
<<" "

718 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEx
<<" "

719 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEy
<<" "

721 <<
’dl
;

726 
cout
<<"Ouuˆf"<<"\"" <<
outf’ame
.
	`¡r
(è<<"\""<<" ha b“Àwr™‹n."<<
’dl
;

728 
outfe
.
	`şo£
();

729 
	}
}

731 
	gCKFe
::
	$OutTeılÙ2
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
, 
¡ršg
 
ouuŠame
)

733 
of¡»am
 
outfe
;

734 
o¡ršg¡»am
 
outf’ame
;

735 
outf’ame
<<
ouuŠame
<<
	`£tw
(8)<<
	`£tfl
('0')<<
TimeS‹ps
<<setw(4)<<".dat";

736 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

738 ià(!
outfe
)

740 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

745 
outfe


769 <<
’dl
;

770 
outfe
<<"ZONE T="<<"\""<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<" s‹°"<<
TimeS‹ps
<<"\" Iğ"<<RegiÚ.
_PtLi¡
.
	`size
()<<", F=POINT"<<
’dl
;

772 
b‘a
=3;

773 
CSPHPt
 *
SPHPtPŒ
;

774 
size_t
 
iii
=0;iii<
RegiÚ
.
_PtLi¡
.
	`size
();iii++)

776 
SPHPtPŒ
=(
CSPHPt
 *)(&
RegiÚ
.
_PtLi¡
[
iii
]);

778 
outfe


779 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

780 <<
	`£»cisiÚ
(16)

781 <<
	`£tw
(26)<<
SPHPtPŒ
->
_x
<<" "

782 <<
	`£tw
(26)<<
SPHPtPŒ
->
_y
<<" "

784 <<
	`£tw
(26)<<
SPHPtPŒ
->
_PID
<<" "

785 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID
<<" "

786 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID2
<<" "

787 <<
	`£tw
(26)<<
SPHPtPŒ
->
_rho
<<" "

789 <<
	`£tw
(26)<<
SPHPtPŒ
->
_u
<<" "

790 <<
	`£tw
(26)<<
SPHPtPŒ
->
_v
<<" "

792 <<
	`£tw
(26)<<
SPHPtPŒ
->
_p
<<" "

793 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
<<" "

794 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
/(
RegiÚ
.
_P¬tLi¡
[SPHPtPŒ->
_PID
-1].
_HdivDp
)<<" "

795 <<
	`£tw
(26)<<
SPHPtPŒ
->
_Iæag
<<" "

796 <<
	`£tw
(26)<<
SPHPtPŒ
->
_C
<<" "

797 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEpsÚ
<<" "

798 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eK­·
<<" "

799 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eRho
<<" "

800 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ePhi
<<" "

801 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEx
<<" "

802 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEy
<<" "

803 <<
’dl
;

808 
cout
<<"Ouuˆf"<<"\"" <<
outf’ame
.
	`¡r
(è<<"\""<<" ha b“Àwr™‹n."<<
’dl
;

810 
outfe
.
	`şo£
();

811 
	}
}

813 
	gCKFe
::
	$outTeılÙEHDPLANNER
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
, 
¡ršg
 
ouuŠame
)

815 
of¡»am
 
outfe
;

816 
o¡ršg¡»am
 
outf’ame
;

817 
outf’ame
<<
ouuŠame
<<
	`£tw
(8)<<
	`£tfl
('0')<<
TimeS‹ps
<<setw(4)<<".dat";

818 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

820 ià(!
outfe
)

822 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

827 
outfe


859 <<
’dl
;

860 
outfe
<<"ZONE T="<<"\""<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<" s‹°"<<
TimeS‹ps
<<"\" Iğ"<<RegiÚ.
_PtLi¡
.
	`size
()<<", F=POINT"<<
’dl
;

861 
CSPHPt
 *
SPHPtPŒ
;

864 
b‘a
=
RegiÚ
.
_P¬tLi¡
[1].
_eEpsÚ
/Region._PartList[2]._eEpsilon;

866 
veùÜ
 <> 
Eext
;

867 
veùÜ
 <> 
Ph›xt
;

868 
veùÜ
 <> 
E¼ÜE
;

869 
veùÜ
 <> 
E¼ÜPhi
;

870 
Eext
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

871 
Ph›xt
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

872 
E¼ÜE
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

873 
E¼ÜPhi
.
	`»size
(
RegiÚ
.
_PtLi¡
.
	`size
(),0.0);

875 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

877 
SPHPtPŒ
=(
CSPHPt
 *)(&
RegiÚ
.
_PtLi¡
[
i
]);

879 if(
SPHPtPŒ
->
_Ty³
==
’SPHPt
)

881 
Eext
[
i
]=(
SPHPtPŒ
->
_PID
-2)*2*
b‘a
/(1+beta)+(3-SPHPtPtr->_PID)*2/(1+beta);

882 
Ph›xt
[
i
]=(
SPHPtPŒ
->
_PID
-2)*
b‘a
*(-2*SPHPtPŒ->
_y
+1)/(1+beta)+(3-SPHPtPtr->_PID)*(-2*SPHPtPtr->_y+beta)/(1+beta);

884 
E¼ÜE
[
i
]=1-
SPHPtPŒ
->
_eEy
/
Eext
[i];

885 
E¼ÜPhi
[
i
]=1-
SPHPtPŒ
->
_ePhi
/
Ph›xt
[i];

890 
size_t
 
iii
=0;iii<
RegiÚ
.
_PtLi¡
.
	`size
();iii++)

892 
SPHPtPŒ
=(
CSPHPt
 *)(&
RegiÚ
.
_PtLi¡
[
iii
]);

894 
outfe


895 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

896 <<
	`£»cisiÚ
(16)

897 <<
	`£tw
(26)<<
SPHPtPŒ
->
_x
<<" "

898 <<
	`£tw
(26)<<
SPHPtPŒ
->
_y
<<" "

900 <<
	`£tw
(26)<<
SPHPtPŒ
->
_PID
<<" "

901 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID
<<" "

902 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ID2
<<" "

903 <<
	`£tw
(26)<<
SPHPtPŒ
->
_rho
<<" "

905 <<
	`£tw
(26)<<
SPHPtPŒ
->
_u
<<" "

906 <<
	`£tw
(26)<<
SPHPtPŒ
->
_v
<<" "

908 <<
	`£tw
(26)<<
SPHPtPŒ
->
_p
<<" "

909 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
<<" "

910 <<
	`£tw
(26)<<
SPHPtPŒ
->
_h
/(
RegiÚ
.
_P¬tLi¡
[SPHPtPŒ->
_PID
-1].
_HdivDp
)<<" "

911 <<
	`£tw
(26)<<
SPHPtPŒ
->
_Iæag
<<" "

912 <<
	`£tw
(26)<<
SPHPtPŒ
->
_C
<<" "

913 <<
	`£tw
(26)<<
SPHPtPŒ
->
_Fex
<<" "

914 <<
	`£tw
(26)<<
SPHPtPŒ
->
_Fey
<<" "

915 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEpsÚ
<<" "

916 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eK­·
<<" "

917 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eRho
<<" "

918 <<
	`£tw
(26)<<
SPHPtPŒ
->
_ePhi
<<" "

919 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEx
<<" "

920 <<
	`£tw
(26)<<
SPHPtPŒ
->
_eEy
<<" "

921 <<
	`£tw
(26)<<
Ph›xt
[
iii
]<<" "

922 <<
	`£tw
(26)<<
Eext
[
iii
]<<" "

923 <<
	`£tw
(26)<<
E¼ÜPhi
[
iii
]<<" "

924 <<
	`£tw
(26)<<
E¼ÜE
[
iii
]<<" "

925 <<
	`£tw
(26)<<
SPHPtPŒ
->
_NumNegbÜ
<<" "

926 <<
’dl
;

931 
cout
<<"Ouuˆf"<<"\"" <<
outf’ame
.
	`¡r
(è<<"\""<<" ha b“Àwr™‹n."<<
’dl
;

933 
outfe
.
	`şo£
();

934 
	}
}

977 
	gCKFe
::
	$CË¬
(
CRegiÚ
 &
RegiÚ
)

979 
RegiÚ
.
_PtLi¡
.
	`ş—r
();

980 
	}
}

982 
	gCKFe
::
OutVeùÜ
(
¡d
::
veùÜ
<> &
v
)

984 
of¡»am
 
outfe
;

985 
o¡ršg¡»am
 
	goutf’ame
;

986 
	goutf’ame
<<"vector"<<".dat";

987 
	goutfe
.
İ’
(
outf’ame
.
¡r
().
d©a
(),
ios
::
out
);

988 ià(!
	goutfe
)

990 
	gû¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
	g’dl
<<"tecplot.dat"<<endl;

994 
size_t
 
	giii
=0;iii<
	gv
.
size
();iii++)

996 
	goutfe


997 <<
£tiosæags
(
ios_ba£
::
sc›Áific
)

998 <<
£»cisiÚ
(8)

999 <<
£tw
(16)<<
v
[
iii
]<<
’dl
;

1001 
	goutfe
.
şo£
();

1004 
	gCKFe
::
OutM©rix
(
¡d
::
veùÜ
<
CM©rix
> &
M
,
dim
)

1006 
of¡»am
 
	goutfe
;

1007 
o¡ršg¡»am
 
	goutf’ame
;

1008 
	goutf’ame
<<"matrix"<<".dat";

1009 
	goutfe
.
İ’
(
outf’ame
.
¡r
().
d©a
(),
ios
::
out
);

1010 ià(!
	goutfe
)

1012 
	gû¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
	g’dl
<<"tecplot.dat"<<endl;

1016 *
	ga
;

1017 
	ga
=(*)
m®loc
(
dim
*dim*());

1019 
	gi
=0;i!=
dim
*dim;++i)

1021 
	ga
[
i
]=0.0;

1024 
	growid
,
	gcŞid
;

1025 
	gi
=0;i!=
M
.
size
();++i)

1027 
	growid
=
M
[
i
].
_RowID
;

1028 
	gcŞid
=
M
[
i
].
_CŞID
;

1030 
	ga
[(
rowid
-1)*
dim
+
cŞid
-1]=
M
[
i
].
_EË
;

1033 
	gid
;

1034 
	gi
=0;i!=
dim
;++i)

1036 
	gj
=0;j!=
dim
;++j)

1038 
	gid
=
i
*
dim
+
j
;

1040 
	goutfe


1041 <<
£tiosæags
(
ios_ba£
::
sc›Áific
)

1042 <<
£»cisiÚ
(5)

1043 <<
£tw
(16)<<
a
[
id
]<<" ";

1046 
	goutfe
<<
	g’dl
;

1048 
	goutfe
.
şo£
();

1052 
	gCKFe
::
	$IÅutRe¡¬t
(
CRegiÚ
 & 
RegiÚ
)

1054 
¡ršg
 
keywÜd
;

1055 
¡ršg
 
lše
;

1056 
veùÜ
<> 
X
,
Y
,
Z
;

1057 
v®ue
;

1058 
PID
,
SECID
,
EOSID
,
ID
;

1059 
PtNum
;

1060 
tch
;

1062 
if¡»am
 
šfe
;

1063 
o¡ršg¡»am
 
šf’ame
;

1064 
šf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<"TEC"<<
	`£tw
(8)<<
	`£tfl
('0')<<RegiÚ._CÚŒŞSPH.
_S¹S‹p
<<setw(4)<<".dat";

1065 
šfe
.
	`İ’
(
šf’ame
.
	`¡r
().
	`d©a
(),
ios
::
š
);

1066 ià(!
šfe
)

1068 
cout
<<"KFcould‚Ù bİ’."<<
’dl
;

1074 
cout
<<"Re¡¬ˆS‹p: "<<
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
<<
’dl
;

1075 
cout
<<"S¹ R—dšg Re¡¬ˆMod– Fe."<<
’dl
;

1078 
	`g‘lše
(
šfe
,
lše
);

1082 
šfe
>>
keywÜd
;

1084 if(
keywÜd
=="I=")

1086 
šfe
>>
v®ue
;

1087 
PtNum
=
	`size_t
(
v®ue
);

1089 
	`g‘lše
(
šfe
,
lše
);

1095 
i
=0;i!=
PtNum
;i++)

1097 
CBa£Pt
 
Ba£Pt
;

1099 
šfe
>>
v®ue
;

1100 
Ba£Pt
.
_x
=(
v®ue
);

1102 
šfe
>>
v®ue
;

1103 
Ba£Pt
.
_y
=(
v®ue
);

1105 
šfe
>>
v®ue
;

1106 
Ba£Pt
.
_PID
=
	`size_t
(
v®ue
);

1108 
šfe
>>
v®ue
;

1109 
Ba£Pt
.
_ID
=
	`size_t
(
v®ue
);

1111 
šfe
>>
v®ue
;

1112 
Ba£Pt
.
_ID2
=
	`size_t
(
v®ue
);

1114 
šfe
>>
v®ue
;

1115 
Ba£Pt
.
_rho
=(
v®ue
);

1117 
šfe
>>
v®ue
;

1118 
Ba£Pt
.
_u
=(
v®ue
);

1120 
šfe
>>
v®ue
;

1121 
Ba£Pt
.
_v
=(
v®ue
);

1123 
šfe
>>
v®ue
;

1124 
Ba£Pt
.
_p
=(
v®ue
);

1126 
šfe
>>
v®ue
;

1127 
Ba£Pt
.
_h
=(
v®ue
);

1129 
šfe
>>
v®ue
;

1130 
Ba£Pt
.
_Iæag
=
	`size_t
(
v®ue
);

1132 
šfe
>>
v®ue
;

1133 
Ba£Pt
.
_VisE
=(
v®ue
);

1135 
šfe
>>
v®ue
;

1136 
Ba£Pt
.
_VisGamma
=(
v®ue
);

1138 
šfe
>>
v®ue
;

1139 
Ba£Pt
.
_Nnx
=(
v®ue
);

1141 
šfe
>>
v®ue
;

1142 
Ba£Pt
.
_Nny
=(
v®ue
);

1144 
šfe
>>
v®ue
;

1145 
Ba£Pt
.
_AccBndx
=(
v®ue
);

1147 
šfe
>>
v®ue
;

1148 
Ba£Pt
.
_AccBndy
=(
v®ue
);

1151 
	`g‘lše
(
šfe
,
lše
);

1153 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt
);

1156 
šfe
.
	`şo£
();

1158 
i
=0;i!=
PtNum
;++i)

1160 
PID
=
RegiÚ
.
_PtLi¡
[
i
].
_PID
;

1162 
RegiÚ
.
_PtLi¡
[
i
].
_r
=RegiÚ._PtLi¡[i].
_h
*2;

1164 
RegiÚ
.
_PtLi¡
[
i
].
_VŞume
=
	`pow
(RegiÚ._PtLi¡[i].
_h
/RegiÚ.
_P¬tLi¡
[
PID
-1].
_HdivDp
,2);

1166 
RegiÚ
.
_PtLi¡
[
i
].
_rho0
=
_In™SPH
[
PID
-1][2];

1167 
RegiÚ
.
_PtLi¡
[
i
].
_T
 =
_In™SPH
[
PID
-1][3];

1169 
RegiÚ
.
_PtLi¡
[
i
].
_m
=RegiÚ._PtLi¡[i].
_rho0
*RegiÚ._PtLi¡[i].
_VŞume
;

1171 
RegiÚ
.
_PtLi¡
[
i
].
_C0
=RegiÚ.
_P¬tLi¡
[
PID
-1]._C0;

1173 
RegiÚ
.
_PtLi¡
[
i
].
_Cs
=RegiÚ.
_CÚŒŞSPH
._Cs;

1175 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

1177 
RegiÚ
.
_PtLi¡
[
i
].
_H
=RegiÚ.
_P¬tLi¡
[
PID
-1].
_STHvsh
*RegiÚ._PtLi¡[i].
_h
;

1178 
RegiÚ
.
_PtLi¡
[
i
].
_¼
=2*RegiÚ._PtLi¡[i].
_H
;

1182 
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_P¬tTy³
)

1184 
’SPH
:

1185 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’SPHPt
;

1187 
’NULL
:

1188 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’NULLPt
;

1190 
’Bnd
:

1191 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’BndPt
;

1193 
’Gho¡1
:

1194 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’Gho¡1Pt
;

1196 
’Gho¡2
:

1197 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’Gho¡2Pt
;

1199 
’Dummy
:

1200 
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
=
’DumPt
;

1208 
	}
}

1210 
	gCKFe
::
	$IÅutMesh
Ğ
CRegiÚ
 & 
RegiÚ
 )

1212 
¡ršg
 
keywÜd
;

1213 
¡ršg
 
lše
;

1214 
veùÜ
<> 
X
,
Y
,
Z
;

1215 
v®ue
;

1216 
PID
,
SECID
,
EOSID
,
ID
;

1217 
tch
;

1219 
if¡»am
 
šfe
;

1220 
o¡ršg¡»am
 
šf’ame
;

1221 
šf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<".msh";

1222 
šfe
.
	`İ’
(
šf’ame
.
	`¡r
().
	`d©a
(),
ios
::
š
);

1223 ià(!
šfe
)

1225 
cout
<<"Mesh Fcould‚Ù bİ’."<<
’dl
;

1231 
cout
<<"S¹ R—dšg Mesh Fe."<<
’dl
;

1235 !
šfe
.
	`eof
())

1237 
šfe
>>
keywÜd
;

1239 if(
keywÜd
=="*MESH")

1241 
	`g‘lše
(
šfe
,
lše
);

1243 
šfe
>>
v®ue
;

1245 
RegiÚ
.
_CÚŒŞSPH
.
_MshMšX
=(
v®ue
);

1247 
šfe
>>
v®ue
;

1248 
šfe
.
	`ignÜe
();

1249 
RegiÚ
.
_CÚŒŞSPH
.
_MshMaxX
=(
v®ue
);

1251 
šfe
>>
v®ue
;

1253 
RegiÚ
.
_CÚŒŞSPH
.
_MshMšY
=(
v®ue
);

1255 
šfe
>>
v®ue
;

1256 
šfe
.
	`ignÜe
();

1257 
RegiÚ
.
_CÚŒŞSPH
.
_MshMaxY
=(
v®ue
);

1259 
šfe
>>
v®ue
;

1261 
RegiÚ
.
_CÚŒŞSPH
.
_MshSize
=(
v®ue
);

1265 if(
keywÜd
=="*NODE")

1269 
šfe
>>
tch
;

1270 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

1272 if((
tch
=='*')||(tch=='$'))

1277 
CNode
 
TempNode
;

1279 
šfe
>>
v®ue
;

1280 
šfe
.
	`ignÜe
();

1281 
TempNode
.
_ID
=
	`size_t
(
v®ue
);

1283 
šfe
>>
v®ue
;

1284 
šfe
.
	`ignÜe
();

1285 
TempNode
.
_x
=(
v®ue
);

1287 
šfe
>>
v®ue
;

1288 
šfe
.
	`ignÜe
();

1289 
TempNode
.
_y
=(
v®ue
);

1291 
i
=0;i<3;i++)

1293 
šfe
>>
v®ue
;

1294 
šfe
.
	`ignÜe
();

1297 
RegiÚ
.
_NodeLi¡
.
	`push_back
(
TempNode
);

1301 if(
keywÜd
=="*ELEMENT_SHELL_THICKNESS")

1305 
veùÜ
<>
	`tPosx
(4);

1306 
veùÜ
<>
	`tPosy
(4);

1307 
veùÜ
<>
	`tP¬te
(3);

1309 
CMesh
 
TempMesh
;

1311 
šfe
>>
tch
;

1312 
šfe
.
	`£ekg
(-1,
ios
::
cur
);

1313 if((
tch
=='*')||(tch=='$')) ;

1315 
šfe
>>
v®ue
;

1316 
šfe
.
	`ignÜe
();

1317 
ID
=
	`size_t
(
v®ue
);

1318 
TempMesh
.
_ID
=
ID
;

1320 
šfe
>>
v®ue
;

1321 
šfe
.
	`ignÜe
();

1322 
PID
=
	`size_t
(
v®ue
);

1323 
TempMesh
.
_PID
=
PID
;

1326 
šfe
>>
v®ue
;

1327 
šfe
.
	`ignÜe
();

1328 
ID
=
	`size_t
(
v®ue
);

1329 
TempMesh
.
_MeshNodLi¡
[0]=&
RegiÚ
.
_NodeLi¡
[
ID
-1];

1330 
tPosx
[0]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_x
;

1331 
tPosy
[0]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_y
;

1333 
šfe
>>
v®ue
;

1334 
šfe
.
	`ignÜe
();

1335 
ID
=
	`size_t
(
v®ue
);

1336 
TempMesh
.
_MeshNodLi¡
[1]=&
RegiÚ
.
_NodeLi¡
[
ID
-1];

1337 
tPosx
[1]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_x
;

1338 
tPosy
[1]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_y
;

1340 
šfe
>>
v®ue
;

1341 
šfe
.
	`ignÜe
();

1342 
ID
=
	`size_t
(
v®ue
);

1343 
TempMesh
.
_MeshNodLi¡
[2]=&
RegiÚ
.
_NodeLi¡
[
ID
-1];

1344 
tPosx
[2]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_x
;

1345 
tPosy
[2]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_y
;

1347 
šfe
>>
v®ue
;

1348 
šfe
.
	`ignÜe
();

1349 
ID
=
	`size_t
(
v®ue
);

1350 
TempMesh
.
_MeshNodLi¡
[3]=&
RegiÚ
.
_NodeLi¡
[
ID
-1];

1351 
tPosx
[3]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_x
;

1352 
tPosy
[3]=
RegiÚ
.
_NodeLi¡
[
ID
-1].
_y
;

1354 
i
=0;i<4;i++)

1356 
šfe
>>
v®ue
;

1357 
šfe
.
	`ignÜe
();

1360 
	`C’‹r
(
tPosx
,
tPosy
,
tP¬te
);

1362 
TempMesh
.
_x
=
tP¬te
[0];

1363 
TempMesh
.
_y
=
tP¬te
[1];

1364 
TempMesh
.
_VŞume
=
tP¬te
[2];

1367 
TempMesh
.
_h
ğ
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_HdivDp
*
	`pow
(RegiÚ.
_PtLi¡
[0].
_VŞume
,0.5);

1368 
TempMesh
.
_r
=2.0*TempMesh.
_h
;

1369 
TempMesh
.
_C0
=1;

1370 
TempMesh
.
_Iæag
=0;

1372 
TempMesh
.
_H
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STHvsh
*TempMesh.
_h
;

1373 
TempMesh
.
_¼
=2*TempMesh.
_H
;

1391 
RegiÚ
.
_MeshLi¡
.
	`push_back
(
TempMesh
);

1393 
tPosx
.
	`ş—r
();

1394 
tPosy
.
	`ş—r
();

1395 
tP¬te
.
	`ş—r
();

1399 if(
keywÜd
=="*END")

1405 
	}
}

1407 
	gCKFe
::
	$OutTeılÙMsh
Ğ
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
 )

1409 
of¡»am
 
outfe
;

1410 
o¡ršg¡»am
 
outf’ame
;

1411 
outf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<"_PTMESH_"<<
	`£tw
(8)<<
	`£tfl
('0')<<
TimeS‹ps
<<setw(4)<<".dat";

1412 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

1414 ià(!
outfe
)

1416 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

1419 
outfe


1445 <<
’dl
;

1446 
outfe
<<"ZONE T="<<"\" Mesh s‹°"<<
TimeS‹ps
<<"\" Iğ"<<
RegiÚ
.
_MeshLi¡
.
	`size
()<<", F=POINT"<<
’dl
;

1448 
CMesh
 * 
MshPŒ
;

1449 
size_t
 
iii
=0;iii<
RegiÚ
.
_MeshLi¡
.
	`size
();iii++)

1451 
MshPŒ
=&
RegiÚ
.
_MeshLi¡
[
iii
];

1453 
outfe


1454 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

1455 <<
	`£»cisiÚ
(16)

1456 <<
	`£tw
(26)<<
MshPŒ
->
_x
<<" "

1457 <<
	`£tw
(26)<<
MshPŒ
->
_y
<<" "

1459 <<
	`£tw
(26)<<
MshPŒ
->
_PID
<<" "

1460 <<
	`£tw
(26)<<
MshPŒ
->
_ID
<<" "

1461 <<
	`£tw
(26)<<
MshPŒ
->
_ID2
<<" "

1462 <<
	`£tw
(26)<<0.0<<" "

1464 <<
	`£tw
(26)<<0.0<<" "

1465 <<
	`£tw
(26)<<0.0<<" "

1467 <<
	`£tw
(26)<<0.0<<" "

1468 <<
	`£tw
(26)<<
MshPŒ
->
_h
<<" "

1469 <<
	`£tw
(26)<<
MshPŒ
->
_Iæag
<<" "

1470 <<
	`£tw
(26)<<0.0<<" "

1471 <<
	`£tw
(26)<<0.0<<" "

1472 <<
	`£tw
(26)<<
MshPŒ
->
_Curv©u»
<<" "

1473 <<
	`£tw
(26)<<
MshPŒ
->
_nx
<<" "

1474 <<
	`£tw
(26)<<
MshPŒ
->
_ny
<<" "

1475 <<
	`£tw
(26)<<
MshPŒ
->
_Nnx
<<" "

1476 <<
	`£tw
(26)<<
MshPŒ
->
_Nny
<<" "

1477 <<
	`£tw
(26)<<0.0<<" "

1478 <<
	`£tw
(26)<<
MshPŒ
->
_C0
<<" "

1479 <<
	`£tw
(26)<<
MshPŒ
->
_C
<<" "

1480 <<
’dl
;

1485 
cout
<<"Ouuˆmesh fha b“Àwr™‹n."<<
’dl
;

1487 
outfe
.
	`şo£
();

1489 
	}
}

1490 
	gCKFe
::
	$OutMsh
Ğ
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
,
CurTime
 )

1492 
of¡»am
 
outfe
;

1493 
o¡ršg¡»am
 
outf’ame
;

1494 
outf’ame
<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<"_MESH_"<<
	`£tw
(8)<<
	`£tfl
('0')<<
TimeS‹ps
<<setw(4)<<".dat";

1495 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

1497 ià(!
outfe
)

1499 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

1503 
outfe
<<"TITLE="<<"\"SPH BASE MESH\""<<
’dl
;

1505 
outfe
<<"FILETYPE=FULL"<<
’dl
;

1507 
outfe
<<"VARIABLES= "

1532 <<
’dl
;

1534 
outfe
<<"ZONE"<<
’dl
;

1536 
outfe
<<"T="<<"\""<<
RegiÚ
.
_CÚŒŞSPH
.
_InfeName
<<"_MESH_"<<
TimeS‹ps
<<"\" "<<
’dl
;

1538 
outfe
<<"STRANDID="<<
TimeS‹ps
<<", "<<"SOLUTIONTIME="<<
CurTime
<<
’dl
;

1540 
outfe
<<"ZONETYPE=FEQUADRILATERAL"<<
’dl
;

1542 
outfe
<<"NODES="<<
RegiÚ
.
_NodeLi¡
.
	`size
()<<","<<"ELEMENTS="<<RegiÚ.
_MeshLi¡
.size()<<
’dl
;

1544 
outfe
<<"FACENEIGHBORMODE=LOCALONETOONE"<<
’dl
;

1546 
outfe
<<"DATAPACKING=BLOCK"<<
’dl
;

1548 
outfe
<<"VARLOCATION=([3-21]=CELLCENTERED)"<<
’dl
;

1550 
outfe
<<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)<<
	`£»cisiÚ
(16);

1553 
i
=0;i!=
RegiÚ
.
_NodeLi¡
.
	`size
();++i)

1555 
outfe


1557 <<
	`£tw
(26)<<
RegiÚ
.
_NodeLi¡
[
i
].
_x
<<" ";

1559 if((
i
+1)%20==0)

1560 
outfe
<<
’dl
;

1562 
outfe
<<
’dl
;

1564 
i
=0;i!=
RegiÚ
.
_NodeLi¡
.
	`size
();++i)

1566 
outfe


1568 <<
	`£tw
(26)<<
RegiÚ
.
_NodeLi¡
[
i
].
_y
<<" ";

1570 if((
i
+1)%20==0)

1571 
outfe
<<
’dl
;

1573 
outfe
<<
’dl
;

1577 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1579 
outfe


1580 <<
	`£tw
(26)<<1<<" ";

1582 if((
i
+1)%20==0)

1583 
outfe
<<
’dl
;

1585 
outfe
<<
’dl
;

1588 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1590 
outfe


1591 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_ID
<<" ";

1593 if((
i
+1)%20==0)

1594 
outfe
<<
’dl
;

1596 
outfe
<<
’dl
;

1599 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1601 
outfe


1602 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_ID2
<<" ";

1604 if((
i
+1)%20==0)

1605 
outfe
<<
’dl
;

1607 
outfe
<<
’dl
;

1610 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1612 
outfe


1613 <<
	`£tw
(26)<<0.0<<" ";

1615 if((
i
+1)%20==0)

1616 
outfe
<<
’dl
;

1618 
outfe
<<
’dl
;

1620 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1622 
outfe


1623 <<
	`£tw
(26)<<0.0<<" ";

1625 if((
i
+1)%20==0)

1626 
outfe
<<
’dl
;

1628 
outfe
<<
’dl
;

1630 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1632 
outfe


1633 <<
	`£tw
(26)<<0.0<<" ";

1635 if((
i
+1)%20==0)

1636 
outfe
<<
’dl
;

1638 
outfe
<<
’dl
;

1640 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1642 
outfe


1643 <<
	`£tw
(26)<<0.0<<" ";

1645 if((
i
+1)%20==0)

1646 
outfe
<<
’dl
;

1648 
outfe
<<
’dl
;

1651 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1653 
outfe


1654 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_h
<<" ";

1656 if((
i
+1)%20==0)

1657 
outfe
<<
’dl
;

1659 
outfe
<<
’dl
;

1662 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1664 
outfe


1665 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_Iæag
<<" ";

1667 if((
i
+1)%20==0)

1668 
outfe
<<
’dl
;

1670 
outfe
<<
’dl
;

1672 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1674 
outfe


1675 <<
	`£tw
(26)<<0.0<<" ";

1677 if((
i
+1)%20==0)

1678 
outfe
<<
’dl
;

1680 
outfe
<<
’dl
;

1682 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1684 
outfe


1685 <<
	`£tw
(26)<<0.0<<" ";

1687 if((
i
+1)%20==0)

1688 
outfe
<<
’dl
;

1690 
outfe
<<
’dl
;

1693 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1695 
outfe


1696 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_Curv©u»
<<" ";

1698 if((
i
+1)%20==0)

1699 
outfe
<<
’dl
;

1701 
outfe
<<
’dl
;

1704 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1706 
outfe


1707 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_nx
<<" ";

1709 if((
i
+1)%20==0)

1710 
outfe
<<
’dl
;

1712 
outfe
<<
’dl
;

1714 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1716 
outfe


1717 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_ny
<<" ";

1719 if((
i
+1)%20==0)

1720 
outfe
<<
’dl
;

1722 
outfe
<<
’dl
;

1724 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1726 
outfe


1727 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_Nnx
<<" ";

1729 if((
i
+1)%20==0)

1730 
outfe
<<
’dl
;

1732 
outfe
<<
’dl
;

1734 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1736 
outfe


1737 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_Nny
<<" ";

1739 if((
i
+1)%20==0)

1740 
outfe
<<
’dl
;

1742 
outfe
<<
’dl
;

1745 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1747 
outfe


1748 <<
	`£tw
(26)<<0.0<<" ";

1750 if((
i
+1)%20==0)

1751 
outfe
<<
’dl
;

1753 
outfe
<<
’dl
;

1756 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1758 
outfe


1759 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_C0
<<" ";

1761 if((
i
+1)%20==0)

1762 
outfe
<<
’dl
;

1764 
outfe
<<
’dl
;

1767 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1769 
outfe


1770 <<
	`£tw
(26)<<
RegiÚ
.
_MeshLi¡
[
i
].
_C
<<" ";

1772 if((
i
+1)%20==0)

1773 
outfe
<<
’dl
;

1775 
outfe
<<
’dl
;

1779 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

1781 
outfe
<<
RegiÚ
.
_MeshLi¡
[
i
].
_MeshNodLi¡
[0]->
_ID
<<" "

1782 <<
RegiÚ
.
_MeshLi¡
[
i
].
_MeshNodLi¡
[1]->
_ID
<<" "

1783 <<
RegiÚ
.
_MeshLi¡
[
i
].
_MeshNodLi¡
[2]->
_ID
<<" "

1784 <<
RegiÚ
.
_MeshLi¡
[
i
].
_MeshNodLi¡
[3]->
_ID
<<" "

1785 <<
’dl
;

1788 
outfe
.
	`şo£
();

1789 
	}
}

	@KFile.h

16 #iâdeà
_KFILE_H_


17 
	#_KFILE_H_


	)

19 
	~<veùÜ
>

20 
	~"RegiÚ.h
"

21 
	~"SPHPt.h
"

22 
	~"P¬t.h
"

23 
	~"Id—lGas.h
"

24 
	~"W—klyCom´ess.h
"

25 
	~"SeùiÚSPH.h
"

26 
	~"FÜû.h
"

27 
	~"SeùiÚNULL.h
"

28 
	~"NblSch.h
"

29 
	~"SPHIPCS.h
"

30 
	~"M©rix.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 şas 
	cCKFe


36 
	mpublic
:

37 
CKFe
();

39 ~
CKFe
();

41 
IÅut
(
CRegiÚ
 & 
RegiÚ
);

43 
IÅutMesh
(
CRegiÚ
 & 
RegiÚ
);

45 
OutTeılÙ
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
);

47 
OutTeılÙ2
(
CRegiÚ
 & 
RegiÚ
, 
TimeS‹ps
, 
¡ršg
 
oupuŠame
);

49 
outTeılÙEHDPLANNER
(
CRegiÚ
 & 
RegiÚ
, 
TimeS‹ps
, 
¡ršg
 
ouuŠame
);

51 
OutTeılÙMsh
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
);

52 
OutMsh
(
CRegiÚ
 & 
RegiÚ
,
TimeS‹ps
,
CurTime
 );

54 
CË¬
(
CRegiÚ
 & 
RegiÚ
);

56 
OutVeùÜ
(
¡d
::
veùÜ
<> &
v
);

57 
OutM©rix
(
¡d
::
veùÜ
<
CM©rix
> &
M
,
dim
);

59 
	m´iv©e
:

61 
C’‹r
(
veùÜ
<> & 
px
,veùÜ<> & 
py
,veùÜ<> & 
p
);

63 
IÅutRe¡¬t
(
CRegiÚ
 & 
RegiÚ
);

65 
	m_In™SPH
[10][4];

	@Knl.cpp

1 
	~"KÆ.h
"

3 
	gCKÆ
::
	$CKÆ
()

5 
	}
}

7 
CKÆ
::~
	$CKÆ
()

9 
	}
}

	@Knl.h

16 #iâdeà
_KNL_H_


17 
	#_KNL_H_


	)

19 şas 
	cCKÆ


21 
	mpublic
:

22 
CKÆ
();

24 ~
CKÆ
();

26 
	m_W
;

28 
	m_Wx
;

30 
	m_Wy
;

32 
	m_Wz
;

34 
	m_W2
;

36 
	m_Ww
;

38 
	m_Wj
;

40 
	m_Wxj
;

42 
	m_Wyj
;

44 
	m_Wzj
;

46 
	m_W2j
;

48 
	m_Wwj
;

50 
	m´iv©e
:

	@Matrix.cpp

1 
	~"M©rix.h
"

4 
	gCM©rix
::
	$CM©rix
()

6 
	}
}

8 
CM©rix
::~
	$CM©rix
()

10 
	}
}

	@Matrix.h

1 #iâdeà
_MATRIX_H_


2 
	#_MATRIX_H_


	)

5 şas 
	cCM©rix


7 
	mpublic
:

9 
CM©rix
();

11 ~
CM©rix
();

13 
	m_RowID
;

15 
	m_CŞID
;

17 
	m_EË
;

19 
	m´iv©e
:

	@Mesh.cpp

1 
	~"Mesh.h
"

3 
	gCMesh
::
	$CMesh
()

6 
	}
}

8 
CMesh
::~
	$CMesh
()

11 
	}
}

	@Mesh.h

16 #iâdeà
_MESH_H_


17 
	#_MESH_H_


	)

19 
	~"Node.h
"

20 
	~"Ba£Pt.h
"

21 
	~<veùÜ
>

23 şas 
	cCMesh


25 
	mpublic
:

27 
CMesh
();

29 ~
CMesh
();

33 
	m_Loÿlx
;

34 
	m_Loÿly
;

38 
	m_Iæag
;

40 
	m_ID
;

42 
	m_PID
;

44 
	m_ID2
;

46 
	m_ID3
;

49 
	m_x
;

51 
	m_y
;

53 
	m_z
;

57 
	m_h
;

58 
	m_H
;

60 
	m_r
;

61 
	m_¼
;

63 
	m_VŞume
;

65 
	m_C0
;

66 
	m_C
;

69 
	m_nx
,
	m_ny
,
	m_nz
;

70 
	m_Nnx
,
	m_Nny
,
	m_Nnz
;

71 
	m_Curv©u»
;

73 
CNode
 * 
	m_MeshNodLi¡
[4];

75 
	m_NebrMeshID
[4];

77 
	m_m
;

79 
	m_rho
;

81 
	m_rho0
;

84 
	m_p
;

86 
	m_u
;

87 
	m_v
;

88 
	m_w
;

91 
	m_Mom‘u
;

92 
	m_Mom‘v
;

95 
	m_CSPMCÛf
;

109 
	m´iv©e
:

	@Model.cpp

1 
	~"Mod–.h
"

3 
	gCMod–
::
	$CMod–
()

5 
	}
}

7 
CMod–
::~
	$CMod–
()

9 
	}
}

11 
CMod–
::
	$EHDPÏÂ¬
(
CRegiÚ
 &
RegiÚ
)

13 
N
=33;

15 
RegiÚ
.
_CÚŒŞSPH
.
_C–lNumx
=RegiÚ._CÚŒŞSPH.
_C–lNumy
=
N
;

17 
xlb
=-0.5;

18 
ylb
=-0.5;

19 
xru
=0.5;

20 
yru
=0.5;

22 
psize
=(
xru
-
xlb
)/(
N
);

25 
RegiÚ
.
_PtLi¡
.
	`»size
((
N
+1)*(N+1));

27 
CBa£Pt
 * 
Ba£PtPŒ
;

28 
i
=0;i!=
N
+1;++i)

30 
j
=0;j!=
N
+1;++j)

33 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
*(
N
+1)+
j
];

34 
Ba£PtPŒ
->
_ID
=
i
*(
N
+1)+
j
+1;

36 
Ba£PtPŒ
->
_x
=
xlb
+
j
*
psize
;

37 
Ba£PtPŒ
->
_y
=
ylb
+
i
*
psize
;

39 if(
Ba£PtPŒ
->
_y
<0)

41 if(
	`ISZERO
((
Ba£PtPŒ
->
_y
-
ylb
)))

43 
Ba£PtPŒ
->
_PID
=1;

44 
Ba£PtPŒ
->
_ePhi
=1.0;

45 
Ba£PtPŒ
->
_Ty³
=
’DumPt
;

49 
Ba£PtPŒ
->
_PID
=2;

50 
Ba£PtPŒ
->
_ePhi
=0.0;

51 
Ba£PtPŒ
->
_Ty³
=
’SPHPt
;

56 if(
	`ISZERO
((
Ba£PtPŒ
->
_y
-
yru
)))

58 
Ba£PtPŒ
->
_PID
=4;

59 
Ba£PtPŒ
->
_ePhi
=0.0;

60 
Ba£PtPŒ
->
_Ty³
=
’DumPt
;

64 
Ba£PtPŒ
->
_PID
=3;

65 
Ba£PtPŒ
->
_ePhi
=0.0;

66 
Ba£PtPŒ
->
_Ty³
=
’SPHPt
;

70 
Ba£PtPŒ
->
_VŞume
=
psize
*psize;

72 
Ba£PtPŒ
->
_u
=0.0;

73 
Ba£PtPŒ
->
_v
=0.0;

75 
Ba£PtPŒ
->
_rho
=1.0;

76 
Ba£PtPŒ
->
_rho0
=1.0;

77 
Ba£PtPŒ
->
_m
=Ba£PtPŒ->
_rho0
*Ba£PtPŒ->
_VŞume
;

78 
Ba£PtPŒ
->
_h
=
RegiÚ
.
_P¬tLi¡
[Ba£PtPŒ->
_PID
-1].
_HdivDp
*
psize
;

79 
Ba£PtPŒ
->
_r
=2.0*Ba£PtPŒ->
_h
;

81 
Ba£PtPŒ
->
_C0
=
RegiÚ
.
_P¬tLi¡
[Ba£PtPŒ->
_PID
-1]._C0;

83 
Ba£PtPŒ
->
_Cs
=
RegiÚ
.
_CÚŒŞSPH
._Cs;

85 
Ba£PtPŒ
->
_p
=0.0;

86 
Ba£PtPŒ
->
_Iæag
=0;

89 
Ba£PtPŒ
->
_eEpsÚ
=0.0;

90 
Ba£PtPŒ
->
_eEx
=0.0;

91 
Ba£PtPŒ
->
_eEy
=0.0;

92 
Ba£PtPŒ
->
_eRho
=0.0;

100 
icouÁ
=0;

101 
PtNum0
=
RegiÚ
.
_PtLi¡
.
	`size
();

102 
CP¬t
 
P¬t5
,
P¬t6
;

103 
P¬t5
=
RegiÚ
.
_P¬tLi¡
[0];

104 
P¬t6
=
RegiÚ
.
_P¬tLi¡
[3];

106 
P¬t5
.
_PID
=5;

107 
P¬t5
.
_P¬tTy³
=
’Dummy
;

109 
P¬t6
.
_PID
=6;

110 
P¬t6
.
_P¬tTy³
=
’Dummy
;

112 
RegiÚ
.
_P¬tLi¡
.
	`push_back
(
P¬t5
);

113 
RegiÚ
.
_P¬tLi¡
.
	`push_back
(
P¬t6
);

115 
i
 =0;i!=
PtNum0
;++i)

117 if(
RegiÚ
.
_PtLi¡
[
i
].
_PID
==1||Region._PtList[i]._PID==4)

119 
CBa£Pt
 
Ba£Pt2
;

120 
CBa£Pt
 
Ba£Pt3
;

122 
Ba£Pt2
=
RegiÚ
.
_PtLi¡
[
i
];

123 
Ba£Pt3
=
RegiÚ
.
_PtLi¡
[
i
];

125 if(
Ba£Pt2
.
_PID
==1)

127 
Ba£Pt2
.
_y
-=
psize
;

128 
Ba£Pt3
.
_y
-=2*
psize
;

129 
Ba£Pt2
.
_PID
=5;

130 
Ba£Pt3
.
_PID
=5;

131 
Ba£Pt2
.
_ID
=
PtNum0
+(++
icouÁ
);

132 
Ba£Pt3
.
_ID
=
PtNum0
+(++
icouÁ
);

134 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt2
);

135 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt3
);

137 if(
Ba£Pt2
.
_PID
==4)

139 
Ba£Pt2
.
_y
+=
psize
;

140 
Ba£Pt3
.
_y
+=2*
psize
;

141 
Ba£Pt2
.
_PID
=6;

142 
Ba£Pt3
.
_PID
=6;

143 
Ba£Pt2
.
_ID
=
PtNum0
+(++
icouÁ
);

144 
Ba£Pt3
.
_ID
=
PtNum0
+(++
icouÁ
);

145 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt3
);

146 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt2
);

150 
	}
}

	@Model.h

16 #iâdeà
_MODEL_H_


17 
	#_MODEL_H_


	)

19 
	~<veùÜ
>

20 
	~"RegiÚ.h
"

22 
	~"SPHPt.h
"

23 
	~"commÚ.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 şas 
	cCMod–


29 
	mpublic
:

30 
CMod–
();

32 ~
CMod–
();

34 
EHDPÏÂ¬
(
CRegiÚ
 & 
RegiÚ
);

36 
	m´iv©e
:

	@NblSch.cpp

1 
	~"NblSch.h
"

2 
	~<cm©h
>

4 
	gCNblSch
::
	$CNblSch
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
)

5 :
	`_Box
(
C–lNumx
,
C–lNumy
),
	$_PtNbLi¡
(0,
NULL
)

7 
	}
}

9 
	gCNblSch
::~
	$CNblSch
()

11 
	}
}

13 
CNblSch
::
	$ResizeBox
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
 )

15 
_Box
.
	`Resize
(
C–lNumx
,
C–lNumy
 );

16 
	}
}

19 
	gCNblSch
::
	$G‘Nbl
(
CRegiÚ
& 
RegiÚ
)

21 
dxŸc
;

22 
dyŸc
;

23 
dxŸc2
;

24 
dyŸc2
;

25 
drŸc2
;

26 
r
,
¼
;

27 
r2
,
¼2
;

28 
ID
;

29 
CPtPaœ
 
PtPaœ
;

30 
CBa£Pt
 * 
PtPŒ
;

34 
_Box
.
	`Upd©eBox
(
RegiÚ
);

39 if(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

41 
veùÜ
<
CBa£Pt
 *> 
BndPt
;

42 
MAXX
,
MINX
;

44 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

45 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

51 
f
=0;f<
RegiÚ
.
_PtLi¡
.
	`size
();f++)

53 if(
RegiÚ
.
_PtLi¡
[
f
].
_Ty³
==
’SPHPt
)

55 
_Box
.
	`G‘Nbl2
(
RegiÚ
.
_PtLi¡
[
f
].
_x
,RegiÚ._PtLi¡[f].
_y
,RegiÚ._PtLi¡[f].
_r
,
_PtNbLi¡
,Region);

57 
i
=0;i!=
_PtNbLi¡
.
	`size
();++i)

59 if(
_PtNbLi¡
[
i
]->
_x
>
RegiÚ
.
_PtLi¡
[
f
]._x)

60 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
f
]._x-(
MAXX
-
MINX
);

62 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
f
]._x+(
MAXX
-
MINX
);

64 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_PtLi¡
[
f
]._y;

65 
dxŸc2
=
dxŸc
*dxiac;

66 
dyŸc2
=
dyŸc
*dyiac;

67 
drŸc2
=
dxŸc2
+
dyŸc2
;

68 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_PtLi¡
[
f
]._r;

69 
r2
=
r
*r;

72 if(4*
drŸc2
<=
r2
)

74 
CPtPaœ
 * 
PtPaœPŒ
;

75 
_PtNbLi¡
[
i
]->
_Ty³
)

77 
’SPHPt
:

79 if(
RegiÚ
.
_PtLi¡
[
f
].
_ID
<=
_PtNbLi¡
[
i
]->_ID)

81 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

82 
PtPaœ
.
_drŸc2
=
drŸc2
;

83 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

84 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

85 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

91 
PtNbr
;

92 
PtNbr
=
_PtNbLi¡
[
i
]->
_r
*_PtNbList[i]->_r;

93 if(
drŸc2
>
PtNbr
)

95 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

96 
PtPaœ
.
_drŸc2
=
drŸc2
;

97 
PtPaœ
.
_PtiPŒ
=
_PtNbLi¡
[
i
];

98 
PtPaœ
.
_PtjPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

99 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

106 
’NULLPt
:

107 
PtPaœ
.
_Ty³
=
’SPHNULLPtPaœ
;

108 
PtPaœ
.
_drŸc2
=
drŸc2
;

109 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

110 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

111 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

114 
’BndPt
:

115 
PtPaœ
.
_Ty³
=
’SPHBndPtPaœ
;

116 
PtPaœ
.
_drŸc2
=
drŸc2
;

117 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

118 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

119 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

122 
’Gho¡1Pt
:

123 
PtPaœ
.
_Ty³
=
’SPHGho¡PtPaœ
;

124 
PtPaœ
.
_drŸc2
=
drŸc2
;

125 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

126 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

127 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

144 
size_t
 
f
=0;f<
RegiÚ
.
_C®Li¡
.
	`size
();f++)

146 
ID
=
RegiÚ
.
_C®Li¡
[
f
];

148 if(
RegiÚ
.
_PtLi¡
[
ID
].
_Ty³
==
’SPHPt
)

150 
_Box
.
	`G‘Nbl
(
RegiÚ
.
_PtLi¡
[
ID
].
_x
,RegiÚ._PtLi¡[ID].
_y
,RegiÚ._PtLi¡[ID].
_r
,
_PtNbLi¡
);

152 
size_t
 
i
=0;i<
_PtNbLi¡
.
	`size
();i++)

154 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
ID
]._x;

155 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_PtLi¡
[
ID
]._y;

157 
dxŸc2
=
dxŸc
*dxiac;

158 
dyŸc2
=
dyŸc
*dyiac;

160 
drŸc2
=
dxŸc2
+
dyŸc2
;

161 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_PtLi¡
[
ID
]._r;

162 
r2
=
r
*r;

165 if(4*
drŸc2
<=
r2
)

167 
_PtNbLi¡
[
i
]->
_Ty³
)

169 
’SPHPt
:

171 if((
ID
+1)<=
_PtNbLi¡
[
i
]->
_ID
)

173 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

174 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

175 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

176 
PtPaœ
.
_drŸc2
=
drŸc2
;

178 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

182 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

183 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

190 
PtNbr
;

191 
PtNbr
=
_PtNbLi¡
[
i
]->
_r
*_PtNbList[i]->_r;

192 if(
drŸc2
>
PtNbr
)

194 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

195 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

196 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

197 
PtPaœ
.
_drŸc2
=
drŸc2
;

199 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

202 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

203 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

210 
’NULLPt
:

212 
PtPaœ
.
_Ty³
=
’SPHNULLPtPaœ
;

213 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

214 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

215 
PtPaœ
.
_drŸc2
=
drŸc2
;

217 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

220 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

221 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

226 
’DumPt
:

228 
PtPaœ
.
_Ty³
=
’SPHDumPtPaœ
;

229 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

230 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

231 
PtPaœ
.
_drŸc2
=
drŸc2
;

233 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

236 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

237 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

242 
’BndPt
:

244 
PtPaœ
.
_Ty³
=
’SPHBndPtPaœ
;

245 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

246 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

247 
PtPaœ
.
_drŸc2
=
drŸc2
;

249 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

252 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

253 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

258 
’EHDBndPt
:

260 
PtPaœ
.
_Ty³
=
’SPHEHDBndPtPaœ
;

261 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

262 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

263 
PtPaœ
.
_drŸc2
=
drŸc2
;

265 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

268 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

269 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

274 
’EHDDumPt
:

276 
PtPaœ
.
_Ty³
=
’SPHDumPtPaœ
;

277 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

278 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

279 
PtPaœ
.
_drŸc2
=
drŸc2
;

281 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

284 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

285 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

300 
size_t
 
f
=0;f!=
RegiÚ
.
_PtLi¡
.
	`size
(); ++f)

302 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
f
];

304 if(
PtPŒ
->
_Ty³
==
’EHDBndPt
)

306 
_Box
.
	`G‘Nbl
(
PtPŒ
->
_x
,PtPŒ->
_y
,PtPŒ->
_r
,
_PtNbLi¡
);

308 
size_t
 
i
=0;i<
_PtNbLi¡
.
	`size
();i++)

310 if(
_PtNbLi¡
[
i
]->
_Ty³
==
’EHDDumPt
)

313 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
ID
]._x;

314 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_PtLi¡
[
ID
]._y;

316 
dxŸc2
=
dxŸc
*dxiac;

317 
dyŸc2
=
dyŸc
*dyiac;

319 
drŸc2
=
dxŸc2
+
dyŸc2
;

320 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_PtLi¡
[
ID
]._r;

321 
r2
=
r
*r;

324 if(4*
drŸc2
<=
r2
)

326 
_PtNbLi¡
[
i
]->
_Ty³
)

328 
’SPHPt
:

330 if((
ID
+1)<=
_PtNbLi¡
[
i
]->
_ID
)

332 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

333 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

334 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

335 
PtPaœ
.
_drŸc2
=
drŸc2
;

337 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

341 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

342 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

349 
PtNbr
;

350 
PtNbr
=
_PtNbLi¡
[
i
]->
_r
*_PtNbList[i]->_r;

351 if(
drŸc2
>
PtNbr
)

353 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

354 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

355 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

356 
PtPaœ
.
_drŸc2
=
drŸc2
;

358 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

361 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

362 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

369 
’NULLPt
:

371 
PtPaœ
.
_Ty³
=
’SPHNULLPtPaœ
;

372 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

373 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

374 
PtPaœ
.
_drŸc2
=
drŸc2
;

376 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

379 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

380 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

385 
’DumPt
:

387 
PtPaœ
.
_Ty³
=
’SPHDumPtPaœ
;

388 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

389 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

390 
PtPaœ
.
_drŸc2
=
drŸc2
;

392 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

395 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

396 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

401 
’BndPt
:

403 
PtPaœ
.
_Ty³
=
’SPHBndPtPaœ
;

404 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

405 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

406 
PtPaœ
.
_drŸc2
=
drŸc2
;

408 
RegiÚ
.
_PtPaœLi¡
.
	`push_back
(
PtPaœ
);

411 
RegiÚ
.
_PtLi¡
[
ID
].
_NumNegbÜ
++;

412 
_PtNbLi¡
[
i
]->
_NumNegbÜ
++;

427 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

429 
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]].
_NumNegbÜ
--;

433 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

435 
size_t
 
f
=0;f<
RegiÚ
.
_C®Li¡
.
	`size
();f++)

437 
ID
=
RegiÚ
.
_C®Li¡
[
f
];

439 if(
RegiÚ
.
_PtLi¡
[
ID
].
_Ty³
==
’SPHPt
)

441 
_Box
.
	`G‘Nbl
(
RegiÚ
.
_PtLi¡
[
ID
].
_x
,RegiÚ._PtLi¡[ID].
_y
,RegiÚ._PtLi¡[ID].
_¼
,
_PtNbLi¡
);

443 
size_t
 
i
=0;i<
_PtNbLi¡
.
	`size
();i++)

445 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_PtLi¡
[
ID
]._x;

446 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_PtLi¡
[
ID
]._y;

448 
dxŸc2
=
dxŸc
*dxiac;

449 
dyŸc2
=
dyŸc
*dyiac;

451 
drŸc2
=
dxŸc2
+
dyŸc2
;

453 
¼
=
_PtNbLi¡
[
i
]->
_¼
+
RegiÚ
.
_PtLi¡
[
ID
]._rr;

454 
¼2
=
¼
*rr;

457 if(4*
drŸc2
<=
¼2
)

459 
_PtNbLi¡
[
i
]->
_Ty³
)

461 
’SPHPt
:

463 if((
ID
+1)<=
_PtNbLi¡
[
i
]->
_ID
)

465 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

466 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

467 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

468 
PtPaœ
.
_drŸc2
=
drŸc2
;

470 
RegiÚ
.
_PtPaœLi¡2
.
	`push_back
(
PtPaœ
);

476 
PtNbr
;

477 
PtNbr
=
_PtNbLi¡
[
i
]->
_¼
*_PtNbList[i]->_rr;

478 if(
drŸc2
>
PtNbr
)

480 
PtPaœ
.
_Ty³
=
’SPHPtPaœ
;

481 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

482 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

483 
PtPaœ
.
_drŸc2
=
drŸc2
;

485 
RegiÚ
.
_PtPaœLi¡2
.
	`push_back
(
PtPaœ
);

491 
’NULLPt
:

493 
PtPaœ
.
_Ty³
=
’SPHNULLPtPaœ
;

494 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

495 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

496 
PtPaœ
.
_drŸc2
=
drŸc2
;

498 
RegiÚ
.
_PtPaœLi¡2
.
	`push_back
(
PtPaœ
);

502 
’BndPt
:

504 
PtPaœ
.
_Ty³
=
’SPHBndPtPaœ
;

505 
PtPaœ
.
_PtiPŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

506 
PtPaœ
.
_PtjPŒ
=
_PtNbLi¡
[
i
];

507 
PtPaœ
.
_drŸc2
=
drŸc2
;

509 
RegiÚ
.
_PtPaœLi¡2
.
	`push_back
(
PtPaœ
);

522 
	}
}

524 
	gCNblSch
::
	$CË¬
(
CRegiÚ
 &
RegiÚ
)

533 
RegiÚ
.
_PtPaœLi¡
.
	`ş—r
();

542 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHST
==1)

544 
RegiÚ
.
_PtPaœLi¡2
.
	`ş—r
();

546 
	}
}

548 
	gCNblSch
::
	$G‘MshNbl
Ğ
CRegiÚ
& 
RegiÚ
 )

550 
dxŸc
;

551 
dyŸc
;

552 
dxŸc2
;

553 
dyŸc2
;

554 
drŸc2
;

555 
r
,
¼
;

556 
r2
,
¼2
;

557 
ID
;

558 
CPtMshPaœ
 
PtMshPaœ
;

560 
_Box
.
	`Upd©eBox
(
RegiÚ
);

564 if(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

566 
veùÜ
<
CBa£Pt
 *> 
BndPt
;

567 
MAXX
,
MINX
;

569 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

570 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

573 
f
=0;f<
RegiÚ
.
_MeshLi¡
.
	`size
();f++)

577 
_Box
.
	`G‘Nbl2
(
RegiÚ
.
_MeshLi¡
[
f
].
_x
,RegiÚ._MeshLi¡[f].
_y
,RegiÚ._MeshLi¡[f].
_r
,
_PtNbLi¡
,Region);

579 
i
=0;i!=
_PtNbLi¡
.
	`size
();++i)

581 if(
_PtNbLi¡
[
i
]->
_x
>
RegiÚ
.
_MeshLi¡
[
f
]._x)

582 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_MeshLi¡
[
f
]._x-(
MAXX
-
MINX
);

584 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_MeshLi¡
[
f
]._x+(
MAXX
-
MINX
);

586 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_MeshLi¡
[
f
]._y;

587 
dxŸc2
=
dxŸc
*dxiac;

588 
dyŸc2
=
dyŸc
*dyiac;

589 
drŸc2
=
dxŸc2
+
dyŸc2
;

590 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_MeshLi¡
[
f
]._r;

591 
r2
=
r
*r;

594 if(4*
drŸc2
<=
r2
)

596 
PtMshPaœ
.
_drŸc2
=
drŸc2
;

597 
PtMshPaœ
.
_MshjPŒ
=&
RegiÚ
.
_MeshLi¡
[
f
];

598 
PtMshPaœ
.
_PtiPŒ
=
_PtNbLi¡
[
i
];

599 
RegiÚ
.
_PtMshPaœLi¡
.
	`push_back
(
PtMshPaœ
);

609 
size_t
 
f
=0;f<
RegiÚ
.
_MeshLi¡
.
	`size
();f++)

614 
_Box
.
	`G‘Nbl
(
RegiÚ
.
_MeshLi¡
[
f
].
_x
,RegiÚ._MeshLi¡[f].
_y
,RegiÚ._MeshLi¡[f].
_r
,
_PtNbLi¡
);

616 
size_t
 
i
=0;i<
_PtNbLi¡
.
	`size
();i++)

618 
dxŸc
=
_PtNbLi¡
[
i
]->
_x
-
RegiÚ
.
_MeshLi¡
[
f
]._x;

619 
dyŸc
=
_PtNbLi¡
[
i
]->
_y
-
RegiÚ
.
_MeshLi¡
[
f
]._y;

621 
dxŸc2
=
dxŸc
*dxiac;

622 
dyŸc2
=
dyŸc
*dyiac;

624 
drŸc2
=
dxŸc2
+
dyŸc2
;

625 
r
=
_PtNbLi¡
[
i
]->
_r
+
RegiÚ
.
_MeshLi¡
[
f
]._r;

626 
r2
=
r
*r;

629 if(4*
drŸc2
<=
r2
)

631 
PtMshPaœ
.
_MshjPŒ
=&
RegiÚ
.
_MeshLi¡
[
f
];

632 
PtMshPaœ
.
_PtiPŒ
=
_PtNbLi¡
[
i
];

633 
PtMshPaœ
.
_drŸc2
=
drŸc2
;

635 
RegiÚ
.
_PtMshPaœLi¡
.
	`push_back
(
PtMshPaœ
);

641 
	}
}

	@NblSch.h

16 #iâdeà
_NBLSCH_H_


17 
	#_NBLSCH_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"Ba£Pt.h
"

21 
	~"PtPaœ.h
"

22 
	~"Box.h
"

23 
	~"PtMshPaœ.h
"

24 
	~"PtO³¿‹.h
"

25 
	~<io¡»am
>

26 
	~<veùÜ
>

28 şas 
	cCNblSch


30 
	mpublic
:

31 
CNblSch
(
size_t
 
C–lNumx
=1,size_ˆ
C–lNumy
=1);

33 ~
CNblSch
();

35 
ResizeBox
(
size_t
 
C–lNumx
,size_ˆ
C–lNumy
);

37 
G‘Nbl
(
CRegiÚ
& 
RegiÚ
);

38 
G‘MshNbl
(
CRegiÚ
& 
RegiÚ
);

40 
CË¬
(
CRegiÚ
& 
RegiÚ
);

42 
CBox
 
	m_Box
;

43 
	m´iv©e
:

46 
¡d
::
veùÜ
<
CBa£Pt
 *> 
_PtNbLi¡
;

	@Node.cpp

1 
	~"Node.h
"

3 
	gCNode
::
	$CNode
()

6 
	}
}

8 
CNode
::~
	$CNode
()

11 
	}
}

	@Node.h

16 #iâdeà
_NODE_H_


17 
	#_NODE_H_


	)

19 
	~<veùÜ
>

21 
	e’NODELOCALTYPE
 {
	m’LeáBÙm
,
	m’BÙm
,
	m’RigtBÙm
,
	m’Rigt
,
	m’RigtU³r
,
	m’U³r
,
	m’LeáU³r
,
	m’Leá
,
	m’In
};

23 şas 
	cCNode


25 
	mpublic
:

27 
CNode
();

29 ~
CNode
();

31 
’NODELOCALTYPE
 
	m_LoÿlTy³
;

34 
	m_Iæag
;

36 
	m_ID
;

38 
	m_x
;

40 
	m_y
;

42 
	m_z
;

45 
	m_nx
,
	m_ny
,
	m_nz
;

46 
	m_Nnx
,
	m_Nny
,
	m_Nnz
;

47 
	m_Curv©u»
;

49 
	m_VeùMod
;

51 
	m¡d
::
veùÜ
<> 
_MshIDLi¡
;

97 
	m´iv©e
:

	@Operator.cpp

1 
	~"O³¿tÜ.h
"

3 
	gCO³¿tÜ
::
	$CO³¿tÜ
()

5 
	}
}

7 
CO³¿tÜ
::~
	$CO³¿tÜ
()

9 
	}
}

11 
CO³¿tÜ
::
SumSqu¬e
(cÚ¡ 
¡d
::
veùÜ
<> &
v
)

13 
sum
;

14 
	gSRes
;

15 
	gcmp
;

17 
	gsum
=0.0;

19 
	gi
=0;i<
	gv
.
size
();i++)

21 
	gcmp
=
v
[
i
];

22 
	gsum
+=
cmp
*cmp;

25 
	gSRes
=
sq¹
(
sum
);

27 (
	gSRes
);

30 
	gCO³¿tÜ
::
SumFabs
(cÚ¡ 
¡d
::
veùÜ
<> &
v
)

32 
i
;

33 
	gcmp
;

34 
	gSRes
;

36 
	gSRes
=0.0;

37 
	gi
=0;i<
	gv
.
size
();i++)

39 
	gcmp
=
v
[
i
];

41 
	gSRes
+=
çbs
(
cmp
);

44 (
	gSRes
);

47 
	gCO³¿tÜ
::
MuÉi_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
)

49 
i
;

50 
	gSRes
;

51 
	gcmp1
,
	gcmp2
;

53 if(
	gv1
.
size
()==
v2
.size())

55 
SRes
=0.0;

57 
	gi
=0;i<
	gv1
.
size
();i++)

59 
	gcmp1
=
v1
[
i
];

60 
	gcmp2
=
v2
[
i
];

62 
	gSRes
+=
cmp1
*
cmp2
;

65 (
	gSRes
);

70 
	gcout
<<"E¼Ü:²»Í¬Î¬ÊıµÄÏòÁ¿Ïà³Ë."<<
	g’dl
;

75 
	gCO³¿tÜ
::
AddAsign_VV
(
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
)

77 
i
;

79 if(
	gv1
.
size
()==
v2
.size())

81 
i
=0;
	gi
<
	gv1
.
size
();i++)

83 
	gv1
[
i
]+=
v2
[i];

89 
	gcout
<<"E¼Ü:²»Í¬Î¬ÊıµÄÏòÁ¿Ïà¼Ó."<<
	g’dl
;

93 
	gCO³¿tÜ
::
SubAsign_VV
(
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
)

95 
i
;

97 if(
	gv1
.
size
()==
v2
.size())

99 
i
=0;
	gi
<
	gv1
.
size
();i++)

101 
	gv1
[
i
]-=
v2
[i];

107 
	gcout
<<"E¼Ü:²»Í¬Î¬ÊıµÄÏòÁ¿Ïà¼õ."<<
	g’dl
;

111 
	gCO³¿tÜ
::
Subs_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
,¡d::veùÜ<> &
v»s
)

113 if(
v1
.
size
()==
v2
.size())

115 if(
v1
.
size
()==
v»s
.size())

117 
i
=0;
	gi
!=
v1
.
size
();++i)

119 
	gv»s
[
i
]=
v1
[i]-
v2
[i];

125 
	gcout
<<"E¼Ü:½á¹ûÏòÁ¿µÄÎ¬ÊıÓëÏà¼õÏòÁ¿µÄÎ¬Êı²»Í¬."<<
	g’dl
;

131 
	gcout
<<"E¼Ü:²»Í¬Î¬ÊıµÄÏòÁ¿Ïà¼õ."<<
	g’dl
;

135 
	gCO³¿tÜ
::
Addi_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
,¡d::veùÜ<> &
v»s
)

137 if(
v1
.
size
()==
v2
.size())

139 if(
v1
.
size
()==
v»s
.size())

141 
i
=0;
	gi
!=
v1
.
size
();++i)

143 
	gv»s
[
i
]=
v1
[i]+
v2
[i];

149 
	gcout
<<"E¼Ü:½á¹ûÏòÁ¿µÄÎ¬ÊıÓëÏà¼ÓÏòÁ¿µÄÎ¬Êı²»Í¬."<<
	g’dl
;

155 
	gcout
<<"E¼Ü:²»Í¬Î¬ÊıµÄÏòÁ¿Ïà¼Ó."<<
	g’dl
;

159 
	gCO³¿tÜ
::
MuÉi_SV
(
S
,cÚ¡ 
¡d
::
veùÜ
<> &
v
,¡d::veùÜ<> &
v»s
)

161 if(
v
.
size
()==
v»s
.size())

163 
i
=0;
	gi
!=
v
.
size
();++i)

165 
	gv»s
[
i
]=
S
*
v
[i];

171 
	gcout
<<"E¼Ü:½á¹ûÏòÁ¿Óë¼ÆËãÏòÁ¿Î¬Êı²»Í¬."<<
	g’dl
;

175 
	gCO³¿tÜ
::
MuÉi_MV
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
,cÚ¡ std::veùÜ<> &
b
,¡d::veùÜ<> &
v»s
)

177 
i
;

179 
	growid
,
	gcŞumnid
;

181 if(
	gb
.
size
()==
v»s
.size())

183 
i
=0;
	gi
<
	gv»s
.
size
();i++)

185 
	gv»s
[
i
]=0.0;

188 
	gi
=0;i<
	gA
.
size
();i++)

190 
	growid
=
A
[
i
].
_RowID
;

191 
	gcŞumnid
=
A
[
i
].
_CŞID
;

193 
	gv»s
[
rowid
-1]+=
A
[
i
].
_EË
*
b
[
cŞumnid
-1];

199 
	gcout
<<"E¼Ü:½á¹ûÏòÁ¿µÄÎ¬ÊıÓëÏà³ËµÄ¾ØÕóºÍÏòÁ¿²»Í¬."<<
	g’dl
;

204 
	gCO³¿tÜ
::
MuÉi_MtV
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
,cÚ¡ std::veùÜ<> &
b
,¡d::veùÜ<> &
v»s
)

206 
i
,
	gj
;

208 
	growid
,
	gcŞumnid
;

210 if(
	gb
.
size
()==
v»s
.size())

212 
i
=0;
	gi
<
	gv»s
.
size
();i++)

214 
	gv»s
[
i
]=0.0;

217 
	gi
=0;i<
	gA
.
size
();i++)

219 
	gcŞumnid
=
A
[
i
].
_RowID
;

220 
	growid
=
A
[
i
].
_CŞID
;

222 
	gv»s
[
rowid
-1]+=
A
[
i
].
_EË
*
b
[
cŞumnid
-1];

228 
	gcout
<<"E¼Ü:½á¹ûÏòÁ¿µÄÎ¬ÊıÓëÏà³ËµÄ¾ØÕóºÍÏòÁ¿²»Í¬."<<
	g’dl
;

232 
	gCO³¿tÜ
::
	$Reve2ndM©
(
a11
,
a12
,
a21
,
a22
,

233 *
¿11
,*
¿12
,*
¿21
,*
¿22
)

235 
mod
;

237 
mod
=
a11
*
a22
-
a12
*
a21
;

239 if(
mod
!=0)

241 *
¿11
ğ
a22
/
mod
; *
¿12
=-
a12
/mod;

242 *
¿21
=-
a21
/
mod
; *
¿22
ğ
a11
/mod;

247 *
¿11
=1;

248 *
¿12
=0;

249 *
¿21
=0;

250 *
¿22
=1;

252 
	}
}

254 
	gCO³¿tÜ
::
	$Reve3rdM©
(
a11
,
a12
,
a13
,
a21
,
a22
,
a23
,
a31
,
a32
,
a33
,

255 *
¿11
,*
¿12
,*
¿13
,*
¿21
,*
¿22
,*
¿23
,*
¿31
,*
¿32
,*
¿33
)

257 
mod
;

259 
mod
=
a11
*(
a22
*
a33
-
a23
*
a32
)-
a12
*(
a21
*a33-a23*
a31
)+
a13
*(a21*a32-a22*a31);

261 if(
mod
!=0)

263 *
¿11
 = (
a22
*
a33
 - 
a23
*
a32
)/
mod
;

264 *
¿12
 =-(
a12
*
a33
 - 
a13
*
a32
)/
mod
;

265 *
¿13
 = (
a12
*
a23
 - 
a13
*
a22
)/
mod
;

266 *
¿21
 =-(
a21
*
a33
 - 
a23
*
a31
)/
mod
;

267 *
¿22
 = (
a11
*
a33
 - 
a13
*
a31
)/
mod
;

268 *
¿23
 =-(
a11
*
a23
 - 
a13
*
a21
)/
mod
;

269 *
¿31
 = (
a21
*
a32
 - 
a22
*
a31
)/
mod
;

270 *
¿32
 =-(
a11
*
a32
 - 
a12
*
a31
)/
mod
;

271 *
¿33
 = (
a11
*
a22
 - 
a12
*
a21
)/
mod
;

275 *
¿11
 = 1;

276 *
¿12
 = 0;

277 *
¿13
 = 0;

278 *
¿21
 = 0;

279 *
¿22
 = 1;

280 *
¿23
 = 0;

281 *
¿31
 = 0;

282 *
¿32
 = 0;

283 *
¿33
 = 1;

285 
	}
}

287 
	gCO³¿tÜ
::
	$MšEig2ndM©
(
a11
,
a12
,
a21
,
a22
)

289 
Ïmbda1
,
Ïmbda2
;

291 
‹mp1
,
‹mp2
;

293 
‹mp1
=
a11
*a11 - 2*a11*
a22
 +‡22*a22 + 4*
a12
*
a21
;

294 if(
‹mp1
<0)

295 
‹mp1
=0.0;

297 
‹mp2
=
	`sq¹
(
‹mp1
)/2;

299 
Ïmbda1
=
a11
/2 + 
a22
/2 - 
‹mp2
;

301 
Ïmbda2
=
a11
/2 + 
a22
/2 + 
‹mp2
;

303 if(
Ïmbda1
>
Ïmbda2
)

304 (
Ïmbda2
);

307 (
Ïmbda1
);

308 
	}
}

310 
	gCO³¿tÜ
::
	$LMš
Ğ
a1
,
a2
 )

312 ià(
a1
>
a2
)

314 (
a2
);

318 (
a1
);

319 
	}
}

321 
	gCO³¿tÜ
::
	$LMax
Ğ
a1
,
a2
 )

323 ià(
a1
>
a2
)

325 (
a1
);

329 (
a2
);

330 
	}
}

	@Operator.h

16 #iâdeà
_OPERTATOR_H_


17 
	#_OPERTATOR_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"M©rix.h
"

23 
	~<cm©h
>

24 
	~<veùÜ
>

25 
	~<io¡»am
>

26 
	~<æßt.h
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	#IsZ”o
(
a
è(
	`çbs
×è< 10.0 * 
DBL_MIN
)

	)

32 
	#IsOÃ
(
a
è(
	`çbs
× - 1.0è< 10.0 * 
DBL_EPSILON
)

	)

34 şas 
	cCO³¿tÜ


36 
	mpublic
:

38 
CO³¿tÜ
();

40 ~
CO³¿tÜ
();

42 
SumSqu¬e
(cÚ¡ 
¡d
::
veùÜ
<> &
v
);

44 
SumFabs
(cÚ¡ 
¡d
::
veùÜ
<> &
v
);

46 
MuÉi_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
);

48 
AddAsign_VV
(
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
);

50 
SubAsign_VV
(
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
);

52 
Subs_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
,¡d::veùÜ<> &
v»s
);

54 
Addi_VV
(cÚ¡ 
¡d
::
veùÜ
<> &
v1
,cÚ¡ std::veùÜ<> &
v2
,¡d::veùÜ<> &
v»s
);

56 
MuÉi_SV
(
S
,cÚ¡ 
¡d
::
veùÜ
<> &
v
,¡d::veùÜ<> &
v»s
);

58 
MuÉi_MV
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
,cÚ¡ std::veùÜ<> &
b
,¡d::veùÜ<> &
v»s
);

60 
MuÉi_MtV
(cÚ¡ 
¡d
::
veùÜ
<
CM©rix
> &
A
,cÚ¡ std::veùÜ<> &
b
,¡d::veùÜ<> &
v»s
);

62 
Reve2ndM©
(
a11
,
a12
,
a21
,
a22
,

63 *
¿11
,*
¿12
,*
¿21
,*
¿22
);

64 
Reve3rdM©
(
a11
,
a12
,
a13
,
a21
,
a22
,
a23
,
a31
,
a32
,
a33
,

65 *
¿11
,*
¿12
,*
¿13
,*
¿21
,*
¿22
,*
¿23
,*
¿31
,*
¿32
,*
¿33
);

67 
MšEig2ndM©
(
a11
,
a12
,
a21
,
a22
);

69 
LMax
(
a1
,
a2
);

70 
LMš
(
a1
,
a2
);

72 
	m´iv©e
:

	@Part.cpp

1 
	~"P¬t.h
"

3 
	gCP¬t
::
	$CP¬t
(
PID
)

4 :
	`_PID
(
PID
),
	`_SECID
(0),
	`_MID
(0),
	`_EOSID
(0),
	`_P¬tPtLi¡
(0,
NULL
),
	$_P¬tC®Li¡
(0,0)

6 
	}
}

8 
	gCP¬t
::~
	$CP¬t
()

10 
	}
}

	@Part.h

16 #iâdeà
_PART_H_


17 
	#_PART_H_


	)

19 
	~<veùÜ
>

20 
	~"SPHPt.h
"

22 
	e’PARTTYPE
 {
	m’SPH
=1, 
	m’NULL
,
	m’Bnd
,
	m’Gho¡1
,
	m’Gho¡2
,
	m’Dummy
,
	m’EHDDum
,
	m’EHDBnd
};

24 şas 
	cCP¬t


26 
	mpublic
:

27 
CP¬t
(
PID
=0);

29 ~
CP¬t
();

31 
	m_PID
;

33 
	m_SECID
;

35 
’PARTTYPE
 
	m_P¬tTy³
;

37 
	m_MID
;

39 
	m_EOSID
;

41 
	m_HdivDp
;

43 
	m_Mu
;

45 
	m_VisK
;

47 
	m_VisN
;

49 
	m_C0
;

51 
	m_STSigma
;

53 
	m_STHvsh
;

55 
	m¡d
::
veùÜ
<
CSPHPt
 *> 
_P¬tPtLi¡
;

57 
	m¡d
::
veùÜ
<> 
_P¬tC®Li¡
;

60 
	m_eEpsÚ
;

61 
	m_eK­·
;

63 
	m´iv©e
:

	@PtMshPair.cpp

1 
	~"PtMshPaœ.h
"

3 
	gCPtMshPaœ
::
	$CPtMshPaœ
()

6 
	}
}

8 
CPtMshPaœ
::~
	$CPtMshPaœ
()

11 
	}
}

	@PtMshPair.h

16 #iâdeà
_PTMSHPAIR_H_


17 
	#_PTMSHPAIR_H_


	)

19 
	~"Ba£Pt.h
"

20 
	~"Mesh.h
"

23 şas 
	cCPtMshPaœ


25 
	mpublic
:

26 
CPtMshPaœ
();

28 ~
CPtMshPaœ
();

30 
CBa£Pt
 * 
	m_PtiPŒ
;

32 
CMesh
 * 
	m_MshjPŒ
;

34 
	m_drŸc2
;

	@PtOperate.cpp

1 
	~"PtO³¿‹.h
"

4 
	$PtDi¡ªû
(
CBa£Pt
 * 
PtiPŒ
, CBa£Pˆ* 
PtjPŒ
)

6 
x1
,
y1
;

7 
x2
,
y2
;

8 
dis
;

10 
x1
=
PtiPŒ
->
_x
;

11 
y1
=
PtiPŒ
->
_y
;

13 
x2
=
PtjPŒ
->
_x
;

14 
y2
=
PtjPŒ
->
_y
;

16 
dis
=
	`sq¹
((
x1
-
x2
)*(x1-x2)+(
y1
-
y2
)*(y1-y2));

18  
dis
;

19 
	}
}

	@PtOperate.h

16 #iâdeà
_PTOPERTATE_H_


17 
	#_PTOPERTATE_H_


	)

19 
	~"SPHPt.h
"

21 
	~<cm©h
>

25 
PtDi¡ªû
(
CBa£Pt
 * 
PtiPŒ
, CBa£Pˆ* 
PtjPŒ
);

	@PtPair.cpp

1 
	~"PtPaœ.h
"

3 
	gCPtPaœ
::
	$CPtPaœ
()

5 
	}
}

8 
CPtPaœ
::
	$CPtPaœ
(
’PTPAIRTYPE
 
Ty³
, 
CBa£Pt
 * 
PtiPŒ
, CBa£Pˆ* 
PtjPŒ
,
drŸc2
)

9 :
	`_Ty³
(
Ty³
),
	`_PtiPŒ
(
PtiPŒ
),
	`_PtjPŒ
(
PtjPŒ
),
	$_drŸc2
(
drŸc2
)

11 
	}
}

13 
	gCPtPaœ
::~
	$CPtPaœ
()

15 
	}
}

	@PtPair.h

16 #iâdeà
_PTPAIR_H_


17 
	#_PTPAIR_H_


	)

19 
	~"Ba£Pt.h
"

21 
	e’PTPAIRTYPE
 {
	m’SPHPtPaœ
,
	m’SPHNULLPtPaœ
, 
	m’SPHBndPtPaœ
,
	m’SPHGho¡PtPaœ
,

22 
	m’SPHDumPtPaœ
,
	m’SPHEHDDumPtPaœ
,
	m’SPHEHDBndPtPaœ
};

24 şas 
	cCPtPaœ


26 
	mpublic
:

27 
CPtPaœ
();

29 
CPtPaœ
(
’PTPAIRTYPE
 
Ty³
, 
CBa£Pt
 * 
PtiPŒ
, CBa£Pˆ* 
PtjPŒ
,
drŸc2
);

31 ~
CPtPaœ
();

33 
’PTPAIRTYPE
 
	m_Ty³
;

35 
CBa£Pt
 * 
	m_PtiPŒ
;

37 
CBa£Pt
 * 
	m_PtjPŒ
;

39 
	m_drŸc2
;

	@Region.cpp

1 
	~"RegiÚ.h
"

3 
	gCRegiÚ
::
	$CRegiÚ
()

4 : 
	`_P¬tLi¡
(0,
NULL
),

5 
	`_SeùiÚLi¡
(0,
NULL
),
	`_ExtFÜûLi¡
(0,NULL),
	$_EOSLi¡
(0,
NULL
)

7 
	}
}

9 
	gCRegiÚ
::~
	$CRegiÚ
()

11 
	}
}

	@Region.h

16 #iâdeà
_REGION_H_


17 
	#_REGION_H_


	)

19 
	~<veùÜ
>

20 
	~"Ba£Pt.h
"

21 
	~"PtPaœ.h
"

22 
	~"KÆ.h
"

23 
	~"FÜû.h
"

24 
	~"P¬t.h
"

25 
	~"SeùiÚ.h
"

26 
	~"EOS.h
"

28 
	~"CÚŒŞSPH.h
"

29 
	~"StD©a.h
"

30 
	~"M©rix.h
"

31 
	~"Mesh.h
"

32 
	~"Node.h
"

33 
	~"PtMshPaœ.h
"

35 şas 
	cCRegiÚ


37 
	mpublic
:

38 
CRegiÚ
();

40 ~
CRegiÚ
();

42 
	m¡d
::
veùÜ
<
CBa£Pt
> 
_PtLi¡
;

44 
	m¡d
::
veùÜ
<
CMesh
> 
_MeshLi¡
;

46 
	m¡d
::
veùÜ
<
CNode
> 
_NodeLi¡
;

48 
	m¡d
::
veùÜ
<
CPtPaœ
> 
_PtPaœLi¡
;

50 
	m¡d
::
veùÜ
<
CPtPaœ
> 
_PtPaœLi¡2
;

52 
	m¡d
::
veùÜ
<
CPtMshPaœ
> 
_PtMshPaœLi¡
;

54 
	m¡d
::
veùÜ
<
CKÆ
> 
_KÆLi¡
;

56 
	m¡d
::
veùÜ
<
CKÆ
> 
_KÆLi¡2
;

58 
	m¡d
::
veùÜ
<
CKÆ
> 
_PtMshKÆLi¡
;

60 
	m¡d
::
veùÜ
<
CFÜû
 *> 
_ExtFÜûLi¡
;

62 
	m¡d
::
veùÜ
<
CP¬t
> 
_P¬tLi¡
;

64 
	m¡d
::
veùÜ
<
CSeùiÚ
 *> 
_SeùiÚLi¡
;

66 
	m¡d
::
veùÜ
<
CEOS
 *> 
_EOSLi¡
;

68 
	m¡d
::
veùÜ
<> 
_C®Li¡
;

70 
	m¡d
::
veùÜ
<
CM©rix
> 
_SPHAm
;

72 
	m¡d
::
veùÜ
<> 
_SPHbu
;

73 
	m¡d
::
veùÜ
<> 
_SPHbv
;

74 
	m¡d
::
veùÜ
<> 
_SPHbw
;

76 
	m¡d
::
veùÜ
<> 
_SPHu
;

77 
	m¡d
::
veùÜ
<> 
_SPHv
;

78 
	m¡d
::
veùÜ
<> 
_SPHw
;

80 
CCÚŒŞSPH
 
	m_CÚŒŞSPH
;

82 
CStD©a
 
	m_StD©aLi¡
;

	@Remesh.cpp

1 
	~"Remesh.h
"

4 
	gCRemesh
::
	$CRemesh
()

7 
	}
}

9 
CRemesh
::~
	$CRemesh
()

12 
	}
}

14 
CRemesh
::
	$SŞve
Ğ
CRegiÚ
 & 
RegiÚ
 )

16 
CBa£Pt
 * 
PtiPŒ
;

17 
CMesh
 * 
MshjPŒ
;

18 
CKÆ
 * 
KÆPŒ
;

21 
_G‘MshNeigb
.
	`G‘MshNbl
(
RegiÚ
);

25 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

27 
MshjPŒ
=&
RegiÚ
.
_MeshLi¡
[
i
];

29 
MshjPŒ
->
_m
=0.0;

30 
MshjPŒ
->
_rho
=0.0;

31 
MshjPŒ
->
_u
=0.0;

32 
MshjPŒ
->
_v
=0.0;

34 
MshjPŒ
->
_Mom‘u
=0.0;

35 
MshjPŒ
->
_Mom‘v
=0.0;

37 
MshjPŒ
->
_CSPMCÛf
=0.0;

41 
i
=0;i!=
RegiÚ
.
_PtMshPaœLi¡
.
	`size
();++i)

43 
PtiPŒ
=
RegiÚ
.
_PtMshPaœLi¡
[
i
].
_PtiPŒ
;

44 
MshjPŒ
=
RegiÚ
.
_PtMshPaœLi¡
[
i
].
_MshjPŒ
;

80 
¡d
::
veùÜ
<
CBa£Pt
> 
TempPtLi¡
;

83 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

85 ià(
RegiÚ
.
_PtLi¡
[
i
].
_Ty³
==
’NULLPt
)

87 
TempPtLi¡
.
	`push_back
(
RegiÚ
.
_PtLi¡
[
i
]);

91 
RegiÚ
.
_PtLi¡
.
	`ş—r
();

92 
icouÁ
=0;

93 
i
=0;i!=
TempPtLi¡
.
	`size
();++i)

95 
icouÁ
++;

96 
TempPtLi¡
[
i
].
_ID
=
icouÁ
;

97 
RegiÚ
.
_PtLi¡
.
	`push_back
(
TempPtLi¡
[
i
]);

99 
TempPtLi¡
.
	`ş—r
();

102 
CBa£Pt
 
Ba£Pt
;

104 
i
=0;i!=
RegiÚ
.
_MeshLi¡
.
	`size
();++i)

106 
Ba£Pt
.
_Ty³
=
’SPHPt
;

108 
Ba£Pt
.
_x
=
RegiÚ
.
_MeshLi¡
[
i
]._x;

109 
Ba£Pt
.
_y
=
RegiÚ
.
_MeshLi¡
[
i
]._y;

110 
Ba£Pt
.
_m
=
RegiÚ
.
_MeshLi¡
[
i
]._m;

111 
Ba£Pt
.
_rho
=
RegiÚ
.
_MeshLi¡
[
i
]._rho;

113 
Ba£Pt
.
_u
=
RegiÚ
.
_MeshLi¡
[
i
]._u;

114 
Ba£Pt
.
_v
=
RegiÚ
.
_MeshLi¡
[
i
]._v;

115 
Ba£Pt
.
_VŞume
=
RegiÚ
.
_MeshLi¡
[
i
]._Volume;

117 
icouÁ
++;

118 
Ba£Pt
.
_ID
=
icouÁ
;

119 
Ba£Pt
.
_PID
=2;

121 
Ba£Pt
.
_Cs
=
RegiÚ
.
_CÚŒŞSPH
._Cs;

123 
Ba£Pt
.
_h
=
RegiÚ
.
_P¬tLi¡
[Ba£Pt.
_PID
-1].
_HdivDp
*
	`sq¹
(Ba£Pt.
_VŞume
);

124 
Ba£Pt
.
_r
=2*Ba£Pt.
_h
;

126 
Ba£Pt
.
_H
=
RegiÚ
.
_P¬tLi¡
[Ba£Pt.
_PID
-1].
_STHvsh
*Ba£Pt.
_h
;

127 
Ba£Pt
.
_¼
=2*Ba£Pt.
_H
;

129 
Ba£Pt
.
_rho0
=1000;

131 
RegiÚ
.
_PtLi¡
.
	`push_back
(
Ba£Pt
);

135 
	}
}

	@Remesh.h

16 #iâdeà
_REMESH_H_


17 
	#_REMESH_H_


	)

19 
	~<veùÜ
>

20 
	~<cm©h
>

21 
	~"RegiÚ.h
"

22 
	~"SPHPt.h
"

23 
	~"P¬t.h
"

24 
	~"NblSch.h
"

25 
	~"M©rix.h
"

26 
	~"Mesh.h
"

27 
	~"G‘KÆLi¡.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 şas 
	cCRemesh


33 
	mpublic
:

34 
CRemesh
();

36 ~
CRemesh
();

38 
SŞve
(
CRegiÚ
 & 
RegiÚ
);

40 
	m´iv©e
:

42 
CNblSch
 
_G‘MshNeigb
;

44 
CG‘KÆLi¡
 
	m_G‘MshKÆLi¡
;

	@SPHAStress.cpp

1 
	~"SPHASŒess.h
"

2 
	~<cm©h
>

4 
	gCSPHASŒess
::
	$CSPHASŒess
()

6 
	}
}

8 
CSPHASŒess
::~
	$CSPHASŒess
()

10 
	}
}

12 
CSPHASŒess
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

14 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

15 
CKÆ
 * 
KÆPŒ
;

16 
fij
;

17 
n
;

18 
rixx
;

19 
riyy
;

20 
rizz
;

21 
rjxx
;

22 
rjyy
;

23 
rjzz
;

24 
nÜmx
;

25 
nÜmy
;

26 
nÜmz
;

27 
nÜmwx
;

28 
nÜmwy
;

29 
nÜmwz
;

30 
•sÚ1
;

31 
•sÚ2
;

32 
rhoi2
;

33 
rhoj2
;

34 
w0
;

36 
IDi
,
IDj
;

38 
•sÚ1
=
RegiÚ
.
_CÚŒŞSPH
.
_ASEpsÚ1
;

39 
•sÚ2
=
RegiÚ
.
_CÚŒŞSPH
.
_ASEpsÚ2
;

41 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

43 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
!=
’SPHBndPtPaœ
 )

45 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

46 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

48 if(
PtiPŒ
==
PtjPŒ
) ;

50 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

51 
_G‘KÆLi¡
.
	`G‘W0
(
RegiÚ
.
_CÚŒŞSPH
.
_ASD–D
,0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h),
w0
);

52 
fij
=
KÆPŒ
->
_W
/
w0
;

53 
n
=4;

55 
rhoi2
=
PtiPŒ
->
_rho
*PtiPtr->_rho;

56 
rhoj2
=
PtjPŒ
->
_rho
*PtjPtr->_rho;

58 if(
PtiPŒ
->
_p
<0)

60 
rixx
=-
•sÚ1
*(
PtiPŒ
->
_p
-PtiPŒ->
_sxx
)/
rhoi2
;

61 
riyy
=-
•sÚ1
*(
PtiPŒ
->
_p
-PtiPŒ->
_syy
)/
rhoi2
;

65 
rixx
=
•sÚ2
*(
PtiPŒ
->
_p
-PtiPŒ->
_sxx
)/
rhoi2
;

66 
riyy
=
•sÚ2
*(
PtiPŒ
->
_p
-PtiPŒ->
_syy
)/
rhoi2
;

69 if(
PtjPŒ
->
_p
<0)

71 
rjxx
=-
•sÚ1
*(
PtjPŒ
->
_p
-PtjPŒ->
_sxx
)/
rhoj2
;

72 
rjyy
=-
•sÚ1
*(
PtjPŒ
->
_p
-PtjPŒ->
_syy
)/
rhoj2
;

76 
rjxx
=
•sÚ2
*(
PtjPŒ
->
_p
-PtjPŒ->
_sxx
)/
rhoj2
;

77 
rjyy
=
•sÚ2
*(
PtjPŒ
->
_p
-PtjPŒ->
_syy
)/
rhoj2
;

80 
nÜmx
=
	`pow
(
fij
,
n
)*(
rixx
+
rjxx
);

81 
nÜmy
=
	`pow
(
fij
,
n
)*(
riyy
+
rjyy
);

83 
nÜmwx
=
nÜmx
*
KÆPŒ
->
_Wx
;

84 
nÜmwy
=
nÜmy
*
KÆPŒ
->
_Wy
;

86 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

88 
PtiPŒ
->
_du
-=
PtjPŒ
->
_m
*
nÜmwx
;

89 
PtiPŒ
->
_dv
-=
PtjPŒ
->
_m
*
nÜmwy
;

91 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

93 
PtjPŒ
->
_du
+=
PtiPŒ
->
_m
*
nÜmwx
;

94 
PtjPŒ
->
_dv
+=
PtiPŒ
->
_m
*
nÜmwy
;

100 
IDi
=
PtiPŒ
->
_ID2
;

102 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_m
*
nÜmwx
;

103 
RegiÚ
.
_SPHbv
[
IDi
-1]-=
PtjPŒ
->
_m
*
nÜmwy
;

105 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

107 
IDj
=
PtjPŒ
->
_ID2
;

109 
RegiÚ
.
_SPHbu
[
IDj
-1]+=
PtiPŒ
->
_m
*
nÜmwx
;

110 
RegiÚ
.
_SPHbv
[
IDj
-1]+=
PtiPŒ
->
_m
*
nÜmwy
;

115 
	}
}

	@SPHAStress.h

16 #iâdeà
_SPHASTRESS_H_


17 
	#_SPHASTRESS_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"G‘KÆLi¡.h
"

23 şas 
	cCSPHASŒess


25 
	mpublic
:

26 
CSPHASŒess
();

28 ~
CSPHASŒess
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
);

32 
	m´iv©e
:

33 
CG‘KÆLi¡
 
_G‘KÆLi¡
;

	@SPHAVForce.cpp

1 
	~"SPHAVFÜû.h
"

3 
	gCSPHAVFÜû
::
	$CSPHAVFÜû
()

5 
	}
}

7 
CSPHAVFÜû
::~
	$CSPHAVFÜû
()

9 
	}
}

11 
CSPHAVFÜû
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

15 
hij
;

16 
xij2
;

17 
cij
;

18 
rhoij
;

19 
¥hi2
;

20 
bphi
;

21 
bphi2
;

22 
uij
;

23 
vij
;

24 
wij
;

25 
uvwxyzij
;

26 
avfÜû
;

27 
avfwx
;

28 
avfwy
;

29 
avfwz
;

30 
avfuvwij
;

31 
®pha
;

32 
b‘a
;

33 
‘a
;

34 
IDi
,
IDj
;

36 
®pha
=
RegiÚ
.
_CÚŒŞSPH
.
_AVAÍha
;

37 
b‘a
=
RegiÚ
.
_CÚŒŞSPH
.
_AVB‘a
;

38 
‘a
=
RegiÚ
.
_CÚŒŞSPH
.
_AVE
;

40 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

42 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
 )

44 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

45 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

46 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

48 if(
PtiPŒ
==
PtjPŒ
) ;

50 
hij
=0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h);

51 
xij2
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
;

53 
cij
=
RegiÚ
.
_CÚŒŞSPH
.
_Cs
;

57 
rhoij
=0.5*(
PtiPŒ
->
_rho
+
PtjPŒ
->_rho);

59 
¥hi2
=
‘a
*‘a*
hij
*hij;

60 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

61 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

62 
uvwxyzij
=
uij
*(
PtiPŒ
->
_x
-
PtjPŒ
->_x)+
vij
*(PtiPŒ->
_y
-PtjPtr->_y);

63 
bphi
=
hij
*
uvwxyzij
/(
xij2
+
¥hi2
);

64 
bphi2
=
bphi
*bphi;

66 if(
uvwxyzij
<0)

67 
avfÜû
=(
b‘a
*
bphi2
-
®pha
*
cij
*
bphi
)/
rhoij
;

69 
avfÜû
=0;

71 
avfwx
=
avfÜû
*
KÆPŒ
->
_Wx
;

72 
avfwy
=
avfÜû
*
KÆPŒ
->
_Wy
;

75 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

77 
PtiPŒ
->
_du
-=
PtjPŒ
->
_m
*
avfwx
;

78 
PtiPŒ
->
_dv
-=
PtjPŒ
->
_m
*
avfwy
;

81 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

83 
PtjPŒ
->
_du
+=
PtiPŒ
->
_m
*
avfwx
;

84 
PtjPŒ
->
_dv
+=
PtiPŒ
->
_m
*
avfwy
;

91 
IDi
=
PtiPŒ
->
_ID2
;

93 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_m
*
avfwx
;

94 
RegiÚ
.
_SPHbv
[
IDi
-1]-=
PtjPŒ
->
_m
*
avfwy
;

96 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

98 
IDj
=
PtjPŒ
->
_ID2
;

100 
RegiÚ
.
_SPHbu
[
IDj
-1]+=
PtiPŒ
->
_m
*
avfwx
;

101 
RegiÚ
.
_SPHbv
[
IDj
-1]+=
PtiPŒ
->
_m
*
avfwy
;

106 
	}
}

108 
	gCSPHAVFÜû
::
	$SŞve2
(
CRegiÚ
 &
RegiÚ
)

110 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

111 
CKÆ
 * 
KÆPŒ
;

112 
hij
;

113 
rhoij
;

114 
rij
;

115 
xij
,
yij
,
zij
;

116 
uij
;

117 
vij
;

118 
wij
;

119 
E
;

120 
IDi
,
IDj
;

121 
AVkc
;

122 
PIij
;

123 
rho
,
h
;

125 
La¡PtID
;

127 
La¡PtID
=
RegiÚ
.
_PtLi¡
.
	`size
();

129 
rho
=
RegiÚ
.
_PtLi¡
[
La¡PtID
-1].
_rho
;

130 
h
=
RegiÚ
.
_PtLi¡
[
La¡PtID
-1].
_h
;

132 
E
=
RegiÚ
.
_P¬tLi¡
[0].
_VisK
;

134 
AVkc
=(
E
/
rho
)/(0.134*
h
);

136 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

140 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

141 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

142 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

144 if(
PtiPŒ
==
PtjPŒ
) ;

146 
hij
=0.5*(
PtiPŒ
->
_h
+
PtjPŒ
->_h);

147 
rhoij
=0.5*(
PtiPŒ
->
_rho
+
PtjPŒ
->_rho);

148 
rij
=
	`sq¹
(
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
);

150 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

151 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

153 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

154 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

156 
PIij
=-
AVkc
*(
uij
*
xij
+
vij
*
yij
)/(
rhoij
*
rij
);

158 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

160 
PtiPŒ
->
_du
-=
PtjPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wx
;

161 
PtiPŒ
->
_dv
-=
PtjPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wy
;

163 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

165 
PtjPŒ
->
_du
+=
PtiPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wx
;

166 
PtjPŒ
->
_dv
+=
PtiPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wy
;

172 
IDi
=
PtiPŒ
->
_ID2
;

174 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wx
;

175 
RegiÚ
.
_SPHbv
[
IDi
-1]-=
PtjPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wy
;

177 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

179 
IDj
=
PtjPŒ
->
_ID2
;

181 
RegiÚ
.
_SPHbu
[
IDj
-1]+=
PtiPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wx
;

182 
RegiÚ
.
_SPHbv
[
IDj
-1]+=
PtiPŒ
->
_m
*
PIij
*
KÆPŒ
->
_Wy
;

187 
	}
}

	@SPHAVForce.h

16 #iâdeà
_SPHAVFORCE_H_


17 
	#_SPHAVFORCE_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~<cm©h
>

23 şas 
	cCSPHAVFÜû


25 
	mpublic
:

26 
CSPHAVFÜû
();

28 ~
CSPHAVFÜû
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
);

31 
SŞve2
(
CRegiÚ
 &
RegiÚ
);

32 
	m´iv©e
:

	@SPHBndPt.cpp

1 
	~"SPHBndPt.h
"

3 
	gCSPHBndPt
::
	$CSPHBndPt
(
ID
,
P¬tID
)

4 :
	`CBa£Pt
(
’BndPt
,
ID
,
P¬tID
),
	`_nx
(0.0),
	`_ny
(0.0),
	`_nz
(0.0),
	$_¬—
(0.0)

6 
	}
}

8 
	gCSPHBndPt
::~
	$CSPHBndPt
()

10 
	}
}

	@SPHBndPt.h

16 #iâdeà
_SPHBNDPT_H_


17 
	#_SPHBNDPT_H_


	)

19 
	~"Ba£Pt.h
"

21 şas 
	cCSPHBndPt
 : 
public
 
CBa£Pt


23 
public
:

24 
CSPHBndPt
(
ID
,
P¬tID
);

26 ~
CSPHBndPt
();

29 
	m_nx
;

31 
	m_ny
;

33 
	m_nz
;

35 
	m_¬—
;

36 
	m´iv©e
:

	@SPHEHD.cpp

1 
	~"SPHEHD.h
"

4 
	gCSPHEHD
::
	$CSPHEHD
()

6 
	}
}

8 
CSPHEHD
::~
	$CSPHEHD
()

10 
	}
}

12 
CSPHEHD
::
	$SŞve
(
CRegiÚ
 & 
RegiÚ
)

14 
CSPHPt
 * 
PtiPŒ
,*
PtjPŒ
;

15 
CBa£Pt
 * 
Ba£PtPŒ
;

16 
CKÆ
 * 
KÆPŒ
;

17 
Exi
,
Exj
;

18 
Eyi
,
Eyj
;

19 
•sÚi
, 
•sÚj
;

20 
k­·i
, 
k­·j
;

21 
nÜm
;

22 
nÜmx
,
nÜmy
;

23 
nÜmx1
,
nÜmy1
;

24 
IDi
,
IDj
,
ID2
;

29 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

33 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

34 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

35 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

37 
•sÚi
=
RegiÚ
.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_eEpsÚ
;

38 
•sÚj
=
RegiÚ
.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_eEpsÚ
;

40 
k­·i
=
RegiÚ
.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_eK­·
;

41 
k­·j
=
RegiÚ
.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_eK­·
;

43 
PtiPŒ
->
_eEpsÚ
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
•sÚj
;

45 
PtiPŒ
->
_eK­·
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
k­·j
;

47 if(
PtiPŒ
!=
PtjPŒ
&&PtjPŒ->
_Ty³
==
’SPHPt
)

49 
PtjPŒ
->
_eEpsÚ
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
•sÚi
;

51 
PtjPŒ
->
_eK­·
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
k­·i
;

54 if(
PtjPŒ
->
_Ty³
==
’DumPt
)

56 
PtjPŒ
->
_eEpsÚ
=
•sÚj
;

57 
PtjPŒ
->
_eK­·
=
k­·j
;

70 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

72 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
!=
’SPHBndPtPaœ
&&RegiÚ._PtPaœLi¡[i]._Ty³!=
’SPHDumPtPaœ
)

74 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

75 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

76 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

78 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

81 
PtiPŒ
->
_deRho
-=
PtjPŒ
->
_mrho
*((PtiPŒ->
_eK­·
*PtjPŒ->
_eEx
+PtjPŒ->_eK­·*PtiPŒ->_eEx)*
KÆPŒ
->
_Wx


82 +(
PtiPŒ
->
_eK­·
*
PtjPŒ
->
_eEy
+PtjPŒ->_eK­·*PtiPŒ->_eEy)*
KÆPŒ
->
_Wy
);

83 
PtiPŒ
->
_deRho
-=
PtjPŒ
->
_mrho
*((PtiPŒ->
_eRho
*PtjPŒ->
_u
+PtjPŒ->_eRho*PtiPŒ->_u)*
KÆPŒ
->
_Wx


84 +(
PtiPŒ
->
_eRho
*
PtjPŒ
->
_v
+PtjPŒ->_eRho*PtiPŒ->_v)*
KÆPŒ
->
_Wy
);

86 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

88 
PtjPŒ
->
_deRho
+=
PtiPŒ
->
_mrho
*((PtjPŒ->
_eK­·
*PtiPŒ->
_eEx
+PtiPŒ->_eK­·*PtjPŒ->_eEx)*
KÆPŒ
->
_Wx


89 +(
PtjPŒ
->
_eK­·
*
PtiPŒ
->
_eEy
+PtiPŒ->_eK­·*PtjPŒ->_eEy)*
KÆPŒ
->
_Wy
);

90 
PtjPŒ
->
_deRho
+=
PtiPŒ
->
_mrho
*((PtjPŒ->
_eRho
*PtiPŒ->
_u
+PtiPŒ->_eRho*PtjPŒ->_u)*
KÆPŒ
->
_Wx


91 +(
PtjPŒ
->
_eRho
*
PtiPŒ
->
_v
+PtiPŒ->_eRho*PtjPŒ->_v)*
KÆPŒ
->
_Wy
);

98 
IDi
=
PtiPŒ
->
_ID2
;

104 
D–T
;

105 
D–T
=
RegiÚ
.
_CÚŒŞSPH
.
_D–T
;

106 
i
=0; i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

108 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

109 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

111 
Ba£PtPŒ
->
_eRho
+=
D–T
*Ba£PtPŒ->
_deRho
;

119 
PtNum
=
RegiÚ
.
_C®Li¡
.
	`size
();

121 
QM©rix
 
LasA
;

122 
VeùÜ
 
Lasx
,
Lasb
;

123 
size_t
 
Dim
=
PtNum
;

125 
Çm—
[]="A";

126 
Çmex
[]="x";

127 
Çmeb
[]="b";

128 
	`Q_CÚ¡r
(&
LasA
, 
Çm—
, 
Dim
 , 
F®£
 , 
Rowws
, 
NÜm®
 , 
True
 );

129 
	`V_CÚ¡r
(&
Lasx
, 
Çmex
, 
Dim
, 
NÜm®
, 
True
);

130 
	`V_CÚ¡r
(&
Lasb
, 
Çmeb
, 
Dim
, 
NÜm®
, 
True
);

135 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

137 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

139 
	`Q_S‘L’
(&
LasA
, 
Ba£PtPŒ
->
_ID2
, Ba£PtPŒ->
_NumNegbÜ
);

141 
	`Q_S‘EÁry
(&
LasA
, 
Ba£PtPŒ
->
_ID2
, 0, BasePtPtr->_ID2, 0.0);

144 
	`V_S‘AÎCmp
(&
Lasb
, 0.0);

152 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

154 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

155 
	`V_AddCmp
(&
Lasb
, 
Ba£PtPŒ
->
_ID2
, -Ba£PtPŒ->
_eRho
);

159 
veùÜ
<> 
icouÁ
;

160 
icouÁ
.
	`»size
(
PtNum
,1);

162 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

164 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHDumPtPaœ
)

166 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

167 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

168 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

171 if(
PtiPŒ
!=
PtjPŒ
)

173 
IDi
=
PtiPŒ
->
_ID2
;

174 
IDj
=
PtjPŒ
->
_ID2
;

176 
nÜm
=(
PtiPŒ
->
_eEpsÚ
+
PtjPŒ
->_eEpsÚ)*
KÆPŒ
->
_Ww
;

179 
	`Q_AddV®
(&
LasA
, 
IDi
, 0, 
PtjPŒ
->
_mrho
*
nÜm
);

181 if(
PtjPŒ
->
_Ty³
==
’SPHPt
)

183 
icouÁ
[
IDi
-1]++;

185 
	`Q_S‘EÁry
(&
LasA
, 
IDi
, 
icouÁ
[IDi-1]-1, 
IDj
, -
PtjPŒ
->
_mrho
*
nÜm
);

187 
icouÁ
[
IDj
-1]++;

189 
	`Q_AddV®
(&
LasA
, 
IDj
, 0, 
PtiPŒ
->
_mrho
*
nÜm
);

190 
	`Q_S‘EÁry
(&
LasA
, 
IDj
, 
icouÁ
[IDj-1]-1, 
IDi
, -
PtiPŒ
->
_mrho
*
nÜm
);

194 if(
PtjPŒ
->
_Ty³
==
’DumPt
)

196 
	`V_AddCmp
(&
Lasb
, 
IDi
, 
PtjPŒ
->
_mrho
*
nÜm
*PtjPŒ->
_ePhi
);

201 
icouÁ
.
	`ş—r
();

203 
	`S‘RTCAccu¿cy
(1e-8);

204 
	`V_S‘AÎCmp
(&
Lasx
, 0.0);

210 
	`BiCGSTABI‹r
(&
LasA
, &
Lasx
, &
Lasb
, 100, 
SSORP»cÚd
,1.2);

215 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

217 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

219 
Ba£PtPŒ
->
_ePhi
=
	`V_G‘Cmp
(&
Lasx
, Ba£PtPŒ->
_ID2
);

222 
	`Q_De¡r
(&
LasA
);

223 
	`V_De¡r
(&
Lasx
);

224 
	`V_De¡r
(&
Lasb
);

231 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

233 
_CSPMEHD
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

237 
veùÜ
<> 
bx
;

238 
veùÜ
<> 
by
;

239 
bx
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

240 
by
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

241 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

243 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ


246 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

247 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

248 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

250 
IDi
=
PtiPŒ
->
_ID2
;

251 
IDj
=
PtjPŒ
->
_ID2
;

253 if(
PtiPŒ
!=
PtjPŒ
)

255 
bx
[
IDi
-1]+=
PtjPŒ
->
_mrho
*(
PtiPŒ
->
_ePhi
-PtjPŒ->_ePhi)*
KÆPŒ
->
_Wx
;

256 
by
[
IDi
-1]+=
PtjPŒ
->
_mrho
*(
PtiPŒ
->
_ePhi
-PtjPŒ->_ePhi)*
KÆPŒ
->
_Wy
;

259 if(
PtjPŒ
->
_Ty³
==
’SPHPt
)

261 
bx
[
IDj
-1]+=
PtiPŒ
->
_mrho
*(PtiPŒ->
_ePhi
-
PtjPŒ
->_ePhi)*
KÆPŒ
->
_Wx
;

262 
by
[
IDj
-1]+=
PtiPŒ
->
_mrho
*(PtiPŒ->
_ePhi
-
PtjPŒ
->_ePhi)*
KÆPŒ
->
_Wy
;

269 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

271 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

272 
ID2
=
Ba£PtPŒ
->
_ID2
;

274 
Ba£PtPŒ
->
_eEx
=-(Ba£PtPŒ->
_CSPMAxx
*
bx
[
ID2
-1]+Ba£PtPŒ->
_CSPMAyx
*
by
[ID2-1]);

275 
Ba£PtPŒ
->
_eEy
=-(Ba£PtPŒ->
_CSPMAxy
*
bx
[
ID2
-1]+Ba£PtPŒ->
_CSPMAyy
*
by
[ID2-1]);

278 
bx
.
	`ş—r
();

279 
by
.
	`ş—r
();

288 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

290 
_CSPMEHD
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

294 
bx
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

295 
by
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

296 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

298 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ


302 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

303 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

304 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

306 
IDi
=
PtiPŒ
->
_ID2
;

307 
IDj
=
PtjPŒ
->
_ID2
;

309 
•sÚi
=
PtiPŒ
->
_eEpsÚ
;

310 
•sÚj
=
PtjPŒ
->
_eEpsÚ
;

312 
Exi
=
PtiPŒ
->
_eEx
;

313 
Eyi
=
PtiPŒ
->
_eEy
;

314 
Exj
=
PtjPŒ
->
_eEx
;

315 
Eyj
=
PtjPŒ
->
_eEy
;

317 
nÜmx
=
•sÚi
*(
Exi
*(Exi*
KÆPŒ
->
_Wx
+
Eyi
*KÆPŒ->
_Wy
)-0.5*(Exi*Exi+Eyi*Eyi)*KnlPtr->_Wx)

318 -
•sÚj
*(
Exj
*(Exj*
KÆPŒ
->
_Wx
+
Eyj
*KÆPŒ->
_Wy
)-0.5*(Exj*Exj+Eyj*Eyj)*KnlPtr->_Wx);

319 
nÜmy
=
•sÚi
*(
Eyi
*(
Exi
*
KÆPŒ
->
_Wx
+Eyi*KÆPŒ->
_Wy
)-0.5*(Exi*Exi+Eyi*Eyi)*KnlPtr->_Wy)

320 -
•sÚj
*(
Eyj
*(
Exj
*
KÆPŒ
->
_Wx
+Eyj*KÆPŒ->
_Wy
)-0.5*(Exj*Exj+Eyj*Eyj)*KnlPtr->_Wy);

322 if(
PtiPŒ
!=
PtjPŒ
)

324 
bx
[
IDi
-1]+=
PtjPŒ
->
_mrho
*
nÜmx
;

325 
by
[
IDi
-1]+=
PtjPŒ
->
_mrho
*
nÜmy
;

328 if(
PtjPŒ
->
_Ty³
==
’SPHPt
)

330 
bx
[
IDj
-1]+=
PtiPŒ
->
_mrho
*
nÜmx
;

331 
by
[
IDj
-1]+=
PtiPŒ
->
_mrho
*
nÜmy
;

338 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

340 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]];

341 
ID2
=
Ba£PtPŒ
->
_ID2
;

343 
Ba£PtPŒ
->
_Fex
=Ba£PtPŒ->
_CSPMAxx
*
bx
[
ID2
-1]+Ba£PtPŒ->
_CSPMAyx
*
by
[ID2-1];

344 
Ba£PtPŒ
->
_Fey
=Ba£PtPŒ->
_CSPMAxy
*
bx
[
ID2
-1]+Ba£PtPŒ->
_CSPMAyy
*
by
[ID2-1];

347 
bx
.
	`ş—r
();

348 
by
.
	`ş—r
();

382 
CKFe
 
kf‘emp
;

383 
kf‘emp
.
	`outTeılÙEHDPLANNER
(
RegiÚ
,1,"xxehd-case1-4");

398 
	}
}

403 
	gCSPHEHD
::
	$SŞve2
(
CRegiÚ
 & 
RegiÚ
)

405 
CSPHPt
 * 
PtiPŒ
,*
PtjPŒ
;

406 
CBa£Pt
 * 
Ba£PtPŒ
;

407 
CKÆ
 * 
KÆPŒ
;

408 
eEpsÚi
, 
eEpsÚj
;

409 
eK­·i
, 
eK­·j
;

410 
nÜm
;

411 
nÜmx
,
nÜmy
;

412 
nÜmx1
,
nÜmy1
;

413 
IDi
,
IDj
;

418 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

422 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

423 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

424 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

426 
eEpsÚi
=
RegiÚ
.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_eEpsÚ
;

427 
eEpsÚj
=
RegiÚ
.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_eEpsÚ
;

429 
eK­·i
=
RegiÚ
.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_eK­·
;

430 
eK­·j
=
RegiÚ
.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_eK­·
;

432 
PtiPŒ
->
_eEpsÚ
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eEpsÚj
;

434 
PtiPŒ
->
_eK­·
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eK­·j
;

436 if(
PtiPŒ
!=
PtjPŒ
)

438 
PtjPŒ
->
_eEpsÚ
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eEpsÚi
;

440 
PtjPŒ
->
_eK­·
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eK­·i
;

446 
D–T
;

447 
D–T
=
RegiÚ
.
_CÚŒŞSPH
.
_D–T
;

448 
PtNum
=
RegiÚ
.
_C®Li¡
.
	`size
();

449 ** 
A
;

450 * 
b
;

454 
b
=
Ãw
 [
PtNum
];

455 
A
 = (**è
Ãw
 * [
PtNum
];

456 
i
 = 0; i !ğ
PtNum
; ++i)

458 
A
[
i
] = 
Ãw
 [
PtNum
];

461 
i
=0;i!=
PtNum
;++i)

463 
b
[
i
]=0.0;

465 
j
=0;j!=
PtNum
;++j)

467 
A
[
i
][
j
]=0.0;

471 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

473 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHDumPtPaœ
)

475 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

476 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

477 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

479 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

481 
IDi
=
PtiPŒ
->
_ID2
;

482 
IDj
=
PtjPŒ
->
_ID2
;

485 
nÜm
=
KÆPŒ
->
_Ww
*(
PtiPŒ
->
_eK­·
*
D–T
+PtiPŒ->
_eEpsÚ
+
PtjPŒ
->_eKappa*DeltaT+PtjPtr->_eEpsilon);

487 
A
[
IDi
-1][IDi-1]+=
PtjPŒ
->
_mrho
*
nÜm
;

489 if(
PtjPŒ
->
_Ty³
==
’SPHPt
)

491 
A
[
IDj
-1][
IDi
-1]=-
PtjPŒ
->
_mrho
*
nÜm
;

493 if(
PtiPŒ
!=
PtjPŒ
)

495 
A
[
IDj
-1][IDj-1]+=
PtiPŒ
->
_mrho
*
nÜm
;

496 
A
[
IDi
-1][
IDj
-1] =
PtiPŒ
->
_mrho
*
nÜm
;

499 if(
PtjPŒ
->
_Ty³
==
’DumPt
)

501 
b
[
IDi
-1]+=
PtjPŒ
->
_mrho
*
nÜm
*PtjPŒ->
_ePhi
;

508 
IDi
=
PtiPŒ
->
_ID2
;

512 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

514 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]-1];

516 
b
[
Ba£PtPŒ
->
_ID2
-1]-=Ba£PtPŒ->
_eRho
;

519 
n
=
PtNum
;

520 
Ähs
=1;

521 
lda
=
PtNum
;

522 
ldb
=
PtNum
;

523 *
iv
;

524 
šfo
;

526 
iv
=
Ãw
 [
PtNum
];

531 if(
šfo
!=0)

532 
cout
<<"EHD†š—¸equ Ax=b c®cuÏtiÚ fŸËd!"<<
’dl
;

535 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

537 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[RegiÚ.
_C®Li¡
[
i
]-1];

539 
Ba£PtPŒ
->
_ePhi
=
b
[Ba£PtPŒ->
_ID2
-1];

546 
d–‘e
[] 
A
;

547 
d–‘e
[] 
b
;

548 
d–‘e
[] 
iv
;

551 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

553 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHDumPtPaœ
)

555 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

556 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

557 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

559 
PtiPŒ
->
_eEpsÚ
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eEpsÚj
;

561 
PtiPŒ
->
_eK­·
+=
PtjPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eK­·j
;

563 if(
PtiPŒ
!=
PtjPŒ
)

565 
PtjPŒ
->
_eEpsÚ
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eEpsÚi
;

567 
PtjPŒ
->
_eK­·
+=
PtiPŒ
->
_mrho
*
KÆPŒ
->
_W
*
eK­·i
;

572 
	}
}

577 
	gCSPHEHD
::
	$ouut
(** 
a
, * 
b
, 
n
)

579 
of¡»am
 
outfe
;

580 
o¡ršg¡»am
 
outf’ame
;

581 
outf’ame
<<"Matrix-ehd"<<".dat";

582 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

584 ià(!
outfe
)

586 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

590 
size_t
 
i
=0;i<
n
;i++)

592 
size_t
 
j
=0;j!=
n
;++j)

594 
outfe


595 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

596 <<
	`£»cisiÚ
(16)

597 <<
	`£tw
(26)<<
a
[
j
][
i
]<<" ";

600 
outfe


601 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

602 <<
	`£»cisiÚ
(16)

603 <<
	`£tw
(26)<<
b
[
i
]<<" "

604 <<
’dl
;

609 
cout
<<"Ouuˆfha b“Àwr™‹n."<<
’dl
;

611 
outfe
.
	`şo£
();

612 
	}
}

615 
	gCSPHEHD
::
	$ouut2
(
QM©rix
 & 
a
, 
VeùÜ
 & 
x
, VeùÜ & 
b
 ,
¡ršg
 
ouuŠame
)

618 
of¡»am
 
outfe
;

619 
o¡ršg¡»am
 
outf’ame
;

620 
outf’ame
<<
ouuŠame
<<".dat";

621 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

623 ià(!
outfe
)

625 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

629 
size_t
 
n
=
	`Q_G‘Dim
(&
a
);

630 
size_t
 
i
=0;i<
n
;i++)

632 
size_t
 
j
=0;j!=
n
;++j)

634 
outfe


635 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

636 <<
	`£»cisiÚ
(16)

637 <<
	`£tw
(26)<<
	`Q_G‘El
(&
a
, 
i
+1, 
j
+1)<<" ";

640 
outfe


641 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

642 <<
	`£»cisiÚ
(16)

643 <<
	`£tw
(26)<<
	`V_G‘Cmp
(&
x
, 
i
+1)<<" "

644 <<
	`£tw
(26)<<
	`V_G‘Cmp
(&
b
, 
i
+1)<<" "

645 <<
’dl
;

650 
cout
<<"Ouut2 fha b“Àwr™‹n."<<
’dl
;

652 
outfe
.
	`şo£
();

653 
	}
}

656 
	gCSPHEHD
::
	$ouutV
(
VeùÜ
 & 
x
 ,
¡ršg
 
ouuŠame
)

659 
of¡»am
 
outfe
;

660 
o¡ršg¡»am
 
outf’ame
;

661 
outf’ame
<<
ouuŠame
<<".dat";

662 
outfe
.
	`İ’
(
outf’ame
.
	`¡r
().
	`d©a
(),
ios
::
out
);

664 ià(!
outfe
)

666 
û¼
<<"Ouˆpuˆfcould‚Ù bİ’."<<
’dl
<<"tecplot.dat"<<endl;

670 
size_t
 
n
=
	`V_G‘Dim
(&
x
);

671 
size_t
 
i
=0;i<
n
;i++)

673 
outfe


674 <<
	`£tiosæags
(
ios_ba£
::
sc›Áific
)

675 <<
	`£»cisiÚ
(16)

676 <<
	`£tw
(26)<<
	`V_G‘Cmp
(&
x
, 
i
+1)<<" "

677 <<
’dl
;

681 
cout
<<
ouuŠame
<<" fha b“Àwr™‹n."<<
’dl
;

683 
outfe
.
	`şo£
();

684 
	}
}

	@SPHEHD.h

16 #iâdeà
_SPHEHD_H_


17 
	#_SPHEHD_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"Ba£Pt.h
"

21 
	~"SPHPt.h
"

22 
	~"P¬t.h
"

23 
	~"commÚ.h
"

24 
	~"CSPM.h
"

25 
	~"KFe.h
"

27 
	~<veùÜ
>

28 
	~<io¡»am
>

29 
	~<f¡»am
>

30 
	~<iomª
>

31 
	~<cm©h
>

35 
	~<Ï¥ack/™”sŞv.h
>

36 
	~<Ï¥ack/¹c.h
>

38 
usšg
 
Çme¥aû
 
¡d
;

40 şas 
	cCSPHEHD


42 
	mpublic
:

43 
CSPHEHD
();

45 ~
CSPHEHD
();

47 
SŞve
(
CRegiÚ
 & 
RegiÚ
);

49 
SŞve2
(
CRegiÚ
 & 
RegiÚ
);

51 
	m´iv©e
:

53 
ouut
(** 
a
, * 
b
, 
n
);

55 
ouut2
(
QM©rix
 & 
a
, 
VeùÜ
 & 
x
, VeùÜ & 
b
 ,
¡ršg
 
ouuŠame
);

57 
ouutV
(
VeùÜ
 & 
x
, 
¡ršg
 
ouuŠame
);

59 
CCSPM
 
	m_CSPMEHD
;

	@SPHEOS.cpp

1 
	~"SPHEOS.h
"

3 
	gCSPHEOS
::
	$CSPHEOS
()

5 
	}
}

7 
CSPHEOS
::~
	$CSPHEOS
()

9 
	}
}

11 
CSPHEOS
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
jj
;

14 
CP¬t
 * 
P¬tPŒ
;

15 
CSPHPt
 * 
SPHPtPŒ
;

16 
CBa£Pt
 * 
Ba£PtPŒ
;

17 
CEOS
 * 
EOSPŒ
;

18 
ID
,
PID
;

20 
size_t
 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

22 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

26 
PID
=
Ba£PtPŒ
->
_PID
;

28 
EOSPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PID
-1].
_EOSID
-1];

30 if(
EOSPŒ
->
	`Ty³
()==
’Id—lGas
)

32 ((
CId—lGas
 *)
EOSPŒ
)->
	`EOS
(
Ba£PtPŒ
->
_rho
,Ba£PtPŒ->
_e
,Ba£PtPŒ->
_p
,Ba£PtPŒ->
_Cs
);

34 if(
EOSPŒ
->
	`Ty³
()==
’W—klyCom´ess
)

36 ((
CW—klyCom´ess
 *)
EOSPŒ
)->
	`EOS
(
Ba£PtPŒ
->
_rho0
,Ba£PtPŒ->
_rho
,Ba£PtPŒ->
_p
);

41 
	}
}

	@SPHEOS.h

16 #iâdeà
_SPHEOS_H_


17 
	#_SPHEOS_H_


	)

19 
	~"Id—lGas.h
"

20 
	~"W—klyCom´ess.h
"

21 
	~"RegiÚ.h
"

22 
	~"SPHPt.h
"

23 
	~"P¬t.h
"

24 
	~"EOS.h
"

25 
	~<veùÜ
>

27 şas 
	cCSPHEOS


29 
	mpublic
:

30 
CSPHEOS
();

32 ~
CSPHEOS
();

34 
SŞve
(
CRegiÚ
 &
RegiÚ
);

36 
	m´iv©e
:

	@SPHEqu.cpp

1 
	~"SPHEqu.h
"

3 
	gCSPHEqu
::
	$CSPHEqu
()

5 
	}
}

7 
CSPHEqu
::~
	$CSPHEqu
()

9 
	}
}

12 
CSPHEqu
::
	$AcûË¿‹
(
CRegiÚ
 &
RegiÚ
,
D–T
,
TimeS‹ps
)

56 
_SPHEHD
.
	`SŞve
(
RegiÚ
);

59 
RTC
=1.0e-8;

60 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==0)

62 
_EquSŞve
.
	`BICGSŞve
(
RegiÚ
.
_SPHAm
,RegiÚ.
_SPHu
,RegiÚ.
_SPHbu
,20,
RTC
);

63 
_EquSŞve
.
	`BICGSŞve
(
RegiÚ
.
_SPHAm
,RegiÚ.
_SPHv
,RegiÚ.
_SPHbv
,20,
RTC
);

65 
	}
}

	@SPHEqu.h

16 #iâdeà
_SPHEQU_H_


17 
	#_SPHEQU_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"SPHSh—ršgFÜû.h
"

22 
	~"SPHViscÛÏ¡ic.h
"

23 
	~"SPHViscos™y.h
"

24 
	~"SPHP»ssu».h
"

25 
	~"ExtFÜû.h
"

26 
	~"SPHASŒess.h
"

27 
	~"SPHAVFÜû.h
"

28 
	~"SPHSmoÙhšgEqu.h
"

29 
	~"Un¡—dyT”m.h
"

30 
	~"EquSŞve.h
"

31 
	~"KFe.h
"

32 
	~"SPHSTFÜû.h
"

33 
	~"BndFÜû.h
"

34 
	~"SPHEHD.h
"

36 şas 
	cCSPHEqu


38 
	mpublic
:

39 
CSPHEqu
();

41 ~
CSPHEqu
();

43 
AcûË¿‹
(
CRegiÚ
 & 
RegiÚ
,
D–T
,
TimeS‹ps
);

45 
	m´iv©e
:

47 
CSPHSh—ršgFÜû
 
_SPHSh—ršgFÜû
;

51 
CSPHViscos™y
 
	m_SPHViscoc™y
;

53 
CSPHP»ssu»
 
	m_SPHP»ssu»
;

55 
CExtFÜû
 
	m_ExtFÜû
;

57 
CSPHSTFÜû
 
	m_SPHSTFÜû
;

59 
CSPHASŒess
 
	m_SPHASŒess
;

61 
CSPHAVFÜû
 
	m_SPHAVFÜû
;

63 
CSPHSmoÙhšgEqu
 
	m_SPHSmoÙhšgEqu
;

65 
CUn¡—dyT”m
 
	m_Un¡—dyT”m
;

67 
CEquSŞve
 
	m_EquSŞve
;

69 
CBndFÜû
 
	m_BndFÜû
;

71 
CSPHEHD
 
	m_SPHEHD
;

73 
CKFe
 
	m_KFe
;

	@SPHIPCS.cpp

1 
	~"SPHIPCS.h
"

3 
	gCSPHIPCS
::
	$CSPHIPCS
(
EOSID
,
c
,
somega
,
bomega
,
SurçûBoŞ
,
SurçûCÛff
,
Sh—ršgBoŞ
,
Viscoc™yEs
)

4 :
	`CEOS
(
’IPCS
,
EOSID
),
	`_c
(
c
),
	`_somega
(
somega
),
	`_bomega
(
bomega
),
	`_SurçûBoŞ
(
SurçûBoŞ
),
	`_SurçûCÛff
(
SurçûCÛff
),
	`_Sh—ršgBoŞ
(
Sh—ršgBoŞ
),

5 
	$_Viscoc™yEs
(
Viscoc™yEs
)

7 
	}
}

9 
	gCSPHIPCS
::~
	$CSPHIPCS
()

11 
	}
}

13 
CSPHIPCS
::
	$G‘D–P
(
CSPHPt
 *
PtiPŒ
,CSPHPˆ*
PtjPŒ
,
CKÆ
 * 
KÆPŒ
,
D–T
)

15 
uij
;

16 
vij
;

17 
wij
;

18 
‹mp
;

20 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

21 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

22 
wij
=
PtiPŒ
->
_w
-
PtjPŒ
->_w;

23 
‹mp
=
uij
*
KÆPŒ
->
_Wx
+
vij
*KÆPŒ->
_Wy
+
wij
*KÆPŒ->
_Wz
;

25 
PtiPŒ
->
_d–p1
+=
_c
*_c*
D–T
*
PtjPŒ
->
_m
*
‹mp
;

26 if(
PtiPŒ
!=
PtjPŒ
)

28 
PtjPŒ
->
_d–p1
+=
_c
*_c*
D–T
*
PtiPŒ
->
_m
*
‹mp
;

30 
	}
}

32 
	gCSPHIPCS
::
	$ReIn™
(
CSPHPt
 * 
SPHPtPŒ
)

34 
SPHPtPŒ
->
_d–p
=SPHPtPŒ->
_d–p1
;

36 
SPHPtPŒ
->
_d–p1
=0.0;

37 
SPHPtPŒ
->
_d–u
=0.0;

38 
SPHPtPŒ
->
_d–v
=0.0;

39 
SPHPtPŒ
->
_d–w
=0.0;

40 
	}
}

42 
	gCSPHIPCS
::
	$G‘D–V
(
CSPHPt
 *
PtiPŒ
, CSPHPˆ*
PtjPŒ
, 
CKÆ
 *
KÆPŒ
, 
D–T
)

44 
PtiPŒ
->
_d–u
-=(
D–T
/PtiPŒ->
_rho
)*(
PtjPŒ
->
_m
/PtjPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wx
;

45 
PtiPŒ
->
_d–v
-=(
D–T
/PtiPŒ->
_rho
)*(
PtjPŒ
->
_m
/PtjPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wy
;

46 
PtiPŒ
->
_d–w
-=(
D–T
/PtiPŒ->
_rho
)*(
PtjPŒ
->
_m
/PtjPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wz
;

48 if(
PtiPŒ
!=
PtjPŒ
)

50 
PtjPŒ
->
_d–u
-=(
D–T
/PtjPŒ->
_rho
)*(
PtiPŒ
->
_m
/PtiPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wx
;

51 
PtjPŒ
->
_d–v
-=(
D–T
/PtjPŒ->
_rho
)*(
PtiPŒ
->
_m
/PtiPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wy
;

52 
PtjPŒ
->
_d–w
-=(
D–T
/PtjPŒ->
_rho
)*(
PtiPŒ
->
_m
/PtiPŒ->_rho)*(PtjPŒ->
_d–p
-PtiPŒ->_d–p)*
KÆPŒ
->
_Wz
;

54 
	}
}

56 
	gCSPHIPCS
::
	$Upd©eV
(
CSPHPt
 *
SPHPtPŒ
)

58 
SPHPtPŒ
->
_u
+=
_bomega
*SPHPtPŒ->
_d–u
;

59 
SPHPtPŒ
->
_v
+=
_bomega
*SPHPtPŒ->
_d–v
;

60 
SPHPtPŒ
->
_w
+=
_bomega
*SPHPtPŒ->
_d–w
;

61 
	}
}

63 
	gCSPHIPCS
::
	$G‘SMax
(
CSPHPt
 *
SPHPtPŒ
,&
SMax
)

65 
S
;

67 if(
SPHPtPŒ
->
_d–p1
>=SPHPtPŒ->
_d–p
)

69 
S
=
SPHPtPŒ
->
_d–p1
-SPHPtPŒ->
_d–p
;

73 
S
=
SPHPtPŒ
->
_d–p
-SPHPtPŒ->
_d–p1
;

75 if(
S
>
SMax
)

77 
SMax
=
S
;

79 
	}
}

81 
	gCSPHIPCS
::
	$Upd©eP
(
CSPHPt
 *
SPHPtPŒ
)

83 
SPHPtPŒ
->
_p
+=
_somega
*SPHPtPŒ->
_d–p
;

84 
	}
}

	@SPHIPCS.h

16 #iâdeà
_SPHIPCS_H_


17 
	#_SPHIPCS_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"EOS.h
"

23 şas 
	cCSPHIPCS
:
public
 
CEOS


25 
public
:

26 
CSPHIPCS
(
EOSID
,
c
,
somega
,
bomega
,
SurçûBoŞ
,
SurçûCÛff
,
Sh—ršgBoŞ
,
Viscoc™yEs
);

28 ~
CSPHIPCS
();

30 
	m_SurçûBoŞ
;

32 
	m_SurçûCÛff
;

34 
	m_Sh—ršgBoŞ
;

36 
	m_Viscoc™yEs
;

38 
G‘D–P
(
CSPHPt
 *
PtiPŒ
,CSPHPˆ*
PtjPŒ
,
CKÆ
 * 
KÆPŒ
,
D–T
);

40 
ReIn™
(
CSPHPt
 * 
SPHPtPŒ
);

42 
G‘D–V
(
CSPHPt
 *
PtiPŒ
,CSPHPˆ*
PtjPŒ
,
CKÆ
 * 
KÆPŒ
,
D–T
);

44 
Upd©eV
(
CSPHPt
 * 
SPHPtPŒ
);

46 
G‘SMax
(
CSPHPt
 * 
SPHPtPŒ
,&
SMax
);

48 
Upd©eP
(
CSPHPt
 * 
SPHPtPŒ
);

50 
	m´iv©e
:

51 
_c
;

53 
	m_somega
;

55 
	m_bomega
;

57 
	m_D–T
;

	@SPHIPCSEqu.cpp

1 
	~"SPHIPCSEqu.h
"

3 
	gCSPHIPCSEqu
::
	$CSPHIPCSEqu
()

5 
	}
}

7 
CSPHIPCSEqu
::~
	$CSPHIPCSEqu
()

9 
	}
}

11 
CSPHIPCSEqu
::
	$In™
(
CRegiÚ
 &
RegiÚ
)

13 
CSPHPt
 * 
SPHPtPŒ
;

14 
CP¬t
 * 
P¬tPŒ
;

16 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

18 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

20 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


21 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

23 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tPtLi¡
.
	`size
();j++)

25 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
j
];

27 
SPHPtPŒ
->
_d–p
=0.0;

28 
SPHPtPŒ
->
_d–p1
=0.0;

29 
SPHPtPŒ
->
_d–u
=0.0;

30 
SPHPtPŒ
->
_d–v
=0.0;

31 
SPHPtPŒ
->
_d–w
=0.0;

35 
	}
}

37 
	gCSPHIPCSEqu
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
,
D–T
)

39 
CP¬t
 * 
P¬tPŒ
;

40 
CSPHPt
 * 
SPHPtPŒ
;

41 
CEOS
 * 
EOSPŒ
;

42 
CSPHPt
 *
PtiPŒ
,*
PtjPŒ
;

43 
CKÆ
 *
KÆPŒ
;

44 
CEOS
 *
EOSiPŒ
,*
EOSjPŒ
;

46 
SMax
;

48 
	`In™
(
RegiÚ
);

50 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

52 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

54 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

55 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

56 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

58 
EOSiPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_EOSID
-1];

59 
EOSjPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_EOSID
-1];

60 if(
EOSiPŒ
==
EOSjPŒ
)

62 if(
EOSiPŒ
->
	`Ty³
()==
’IPCS
)

64 ((
CSPHIPCS
 *)
EOSiPŒ
)->
	`G‘D–P
(
PtiPŒ
,
PtjPŒ
,
KÆPŒ
,
D–T
);

72 
SMax
=0.0000;

73 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

75 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

76 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


77 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

79 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tPtLi¡
.
	`size
();j++)

81 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
j
];

82 
EOSPŒ
=
RegiÚ
.
_EOSLi¡
[
P¬tPŒ
->
_EOSID
-1];

84 if(
EOSPŒ
->
	`Ty³
()==
’IPCS
)

86 ((
CSPHIPCS
 *)
EOSPŒ
)->
	`ReIn™
(
SPHPtPŒ
);

92 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

94 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

96 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

97 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

98 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

100 
EOSiPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_EOSID
-1];

101 
EOSjPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_EOSID
-1];

102 if(
EOSiPŒ
==
EOSjPŒ
)

104 if(
EOSiPŒ
->
	`Ty³
()==
’IPCS
)

106 ((
CSPHIPCS
 *)
EOSiPŒ
)->
	`G‘D–V
(
PtiPŒ
,
PtjPŒ
,
KÆPŒ
,
D–T
);

112 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

114 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

115 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


116 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

118 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tPtLi¡
.
	`size
();j++)

120 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
j
];

121 
EOSPŒ
=
RegiÚ
.
_EOSLi¡
[
P¬tPŒ
->
_EOSID
-1];

123 if(
EOSPŒ
->
	`Ty³
()==
’IPCS
)

125 ((
CSPHIPCS
 *)
EOSPŒ
)->
	`Upd©eV
(
SPHPtPŒ
);

131 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

133 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

135 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

136 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

137 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

139 
EOSiPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_EOSID
-1];

140 
EOSjPŒ
=
RegiÚ
.
_EOSLi¡
[RegiÚ.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_EOSID
-1];

141 if(
EOSiPŒ
==
EOSjPŒ
)

143 if(
EOSiPŒ
->
	`Ty³
()==
’IPCS
)

145 ((
CSPHIPCS
 *)
EOSiPŒ
)->
	`G‘D–P
(
PtiPŒ
,
PtjPŒ
,
KÆPŒ
,
D–T
);

151 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

153 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

154 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


155 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

157 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tPtLi¡
.
	`size
();j++)

159 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
j
];

160 
EOSPŒ
=
RegiÚ
.
_EOSLi¡
[
P¬tPŒ
->
_EOSID
-1];

162 if(
EOSPŒ
->
	`Ty³
()==
’IPCS
)

164 ((
CSPHIPCS
 *)
EOSPŒ
)->
	`G‘SMax
(
SPHPtPŒ
,
SMax
);

169 }
SMax
>100.0);

171 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

173 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

174 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


175 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

177 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tPtLi¡
.
	`size
();j++)

179 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
j
];

180 
EOSPŒ
=
RegiÚ
.
_EOSLi¡
[
P¬tPŒ
->
_EOSID
-1];

182 if(
EOSPŒ
->
	`Ty³
()==
’IPCS
)

184 ((
CSPHIPCS
 *)
EOSPŒ
)->
	`Upd©eP
(
SPHPtPŒ
);

189 
	}
}

	@SPHIPCSEqu.h

16 #iâdeà
_SPHIPCSEQU_H_


17 
	#_SPHIPCSEQU_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"SPHIPCS.h
"

23 şas 
	cCSPHIPCSEqu


25 
	mpublic
:

26 
CSPHIPCSEqu
();

28 ~
CSPHIPCSEqu
();

30 
SŞve
(
CRegiÚ
 & 
RegiÚ
,
D–T
);

32 
	m´iv©e
:

34 
In™
(
CRegiÚ
 & 
RegiÚ
);

	@SPHInit.cpp

1 
	~"SPHIn™.h
"

4 
	gCSPHIn™
::
	$CSPHIn™
()

6 
	}
}

8 
CSPHIn™
::~
	$CSPHIn™
()

10 
	}
}

12 
CSPHIn™
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
)

14 
jj
;

15 
CSPHPt
 * 
SPHPtPŒ
;

16 
CP¬t
 * 
P¬tPŒ
;

17 
CBa£Pt
 * 
Ba£PtPŒ
;

20 
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag1
=0;

21 
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
=0;

24 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

27 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

29 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

32 
Ba£PtPŒ
->
_du
=0.0;

33 
Ba£PtPŒ
->
_dv
=0.0;

34 
Ba£PtPŒ
->
_dw
=0.0;

35 
Ba£PtPŒ
->
_de
=0.0;

36 
Ba£PtPŒ
->
_dh
=0.0;

37 
Ba£PtPŒ
->
_drho
=0.0;

39 
Ba£PtPŒ
->
_CSPMCÛf
=0.0;

40 
Ba£PtPŒ
->
_CSPMAxx
=0.0;

41 
Ba£PtPŒ
->
_CSPMAyx
=0.0;

42 
Ba£PtPŒ
->
_CSPMAzx
=0.0;

43 
Ba£PtPŒ
->
_CSPMAxy
=0.0;

44 
Ba£PtPŒ
->
_CSPMAyy
=0.0;

45 
Ba£PtPŒ
->
_CSPMAzy
=0.0;

46 
Ba£PtPŒ
->
_CSPMAxz
=0.0;

47 
Ba£PtPŒ
->
_CSPMAyz
=0.0;

48 
Ba£PtPŒ
->
_CSPMAzz
=0.0;

50 
Ba£PtPŒ
->
_CSPMmšLambda
=0.0;

52 
Ba£PtPŒ
->
_sxx
=0.0;

53 
Ba£PtPŒ
->
_sxy
=0.0;

54 
Ba£PtPŒ
->
_sxz
=0.0;

55 
Ba£PtPŒ
->
_syy
=0.0;

56 
Ba£PtPŒ
->
_syz
=0.0;

57 
Ba£PtPŒ
->
_szz
=0.0;

59 
Ba£PtPŒ
->
_AccBndx
=0.0;

60 
Ba£PtPŒ
->
_AccBndy
=0.0;

62 
Ba£PtPŒ
->
_NumNegbÜ
=0;

63 
Ba£PtPŒ
->
_r0
=0.0;

64 
Ba£PtPŒ
->
_PtSháCÛfu
=0.0;

65 
Ba£PtPŒ
->
_PtSháCÛfv
=0.0;

66 
Ba£PtPŒ
->
_PtSháCÛfw
=0.0;

69 
Ba£PtPŒ
->
_eEpsÚ
=0.0;

70 
Ba£PtPŒ
->
_eK­·
=0.0;

71 
Ba£PtPŒ
->
_deRho
=0.0;

72 
Ba£PtPŒ
->
_geEpsÚx
=0.0;

73 
Ba£PtPŒ
->
_geEpsÚy
=0.0;

74 
Ba£PtPŒ
->
_Fex
=0.0;

75 
Ba£PtPŒ
->
_Fey
=0.0;

77 
Ba£PtPŒ
->
_mrho
=Ba£PtPŒ->
_m
/Ba£PtPŒ->
_rho
;

79 ià(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
||Ba£PtPŒ->_Ty³==
’NULLPt
)

81 
Ba£PtPŒ
->
_nx
=0.0;

82 
Ba£PtPŒ
->
_ny
=0.0;

83 
Ba£PtPŒ
->
_nz
=0.0;

84 
Ba£PtPŒ
->
_Nnx
=0.0;

85 
Ba£PtPŒ
->
_Nny
=0.0;

86 
Ba£PtPŒ
->
_Nnz
=0.0;

87 
Ba£PtPŒ
->
_Curv©u»
=0.0;

88 
Ba£PtPŒ
->
_midcurve
=0.0;

89 
Ba£PtPŒ
->
_midcÜ»ù
=0.0;

90 
Ba£PtPŒ
->
_C
=0.0;

96 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==0)

99 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

101 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

104 
Ba£PtPŒ
->
_du
=0.0;

105 
Ba£PtPŒ
->
_dv
=0.0;

106 
Ba£PtPŒ
->
_dw
=0.0;

107 
Ba£PtPŒ
->
_de
=0.0;

108 
Ba£PtPŒ
->
_dh
=0.0;

109 
Ba£PtPŒ
->
_drho
=0.0;

111 
Ba£PtPŒ
->
_CSPMCÛf
=0.0;

112 
Ba£PtPŒ
->
_CSPMAxx
=0.0;

113 
Ba£PtPŒ
->
_CSPMAyx
=0.0;

114 
Ba£PtPŒ
->
_CSPMAzx
=0.0;

115 
Ba£PtPŒ
->
_CSPMAxy
=0.0;

116 
Ba£PtPŒ
->
_CSPMAyy
=0.0;

117 
Ba£PtPŒ
->
_CSPMAzy
=0.0;

118 
Ba£PtPŒ
->
_CSPMAxz
=0.0;

119 
Ba£PtPŒ
->
_CSPMAyz
=0.0;

120 
Ba£PtPŒ
->
_CSPMAzz
=0.0;

122 
Ba£PtPŒ
->
_CSPMmšLambda
=0.0;

124 
Ba£PtPŒ
->
_sxx
=0.0;

125 
Ba£PtPŒ
->
_sxy
=0.0;

126 
Ba£PtPŒ
->
_sxz
=0.0;

127 
Ba£PtPŒ
->
_syy
=0.0;

128 
Ba£PtPŒ
->
_syz
=0.0;

129 
Ba£PtPŒ
->
_szz
=0.0;

131 
Ba£PtPŒ
->
_AccBndx
=0.0;

132 
Ba£PtPŒ
->
_AccBndy
=0.0;

134 
Ba£PtPŒ
->
_NumNegbÜ
=0;

135 
Ba£PtPŒ
->
_r0
=0.0;

136 
Ba£PtPŒ
->
_PtSháCÛfu
=0.0;

137 
Ba£PtPŒ
->
_PtSháCÛfv
=0.0;

138 
Ba£PtPŒ
->
_PtSháCÛfw
=0.0;

140 ià(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
||Ba£PtPŒ->_Ty³==
’NULLPt
)

142 
Ba£PtPŒ
->
_nx
=0.0;

143 
Ba£PtPŒ
->
_ny
=0.0;

144 
Ba£PtPŒ
->
_nz
=0.0;

145 
Ba£PtPŒ
->
_Nnx
=0.0;

146 
Ba£PtPŒ
->
_Nny
=0.0;

147 
Ba£PtPŒ
->
_Nnz
=0.0;

148 
Ba£PtPŒ
->
_Curv©u»
=0.0;

149 
Ba£PtPŒ
->
_midcurve
=0.0;

150 
Ba£PtPŒ
->
_midcÜ»ù
=0.0;

151 
Ba£PtPŒ
->
_C
=0.0;

155 
RegiÚ
.
_SPHAm
.
	`»size
(RegiÚ.
_StD©aLi¡
.
_InvŞvedFluidNum
);

156 
RegiÚ
.
_SPHu
.
	`»size
(RegiÚ.
_StD©aLi¡
.
_InvŞvedFluidNum
);

157 
RegiÚ
.
_SPHv
.
	`»size
(RegiÚ.
_StD©aLi¡
.
_InvŞvedFluidNum
);

158 
RegiÚ
.
_SPHbu
.
	`»size
(RegiÚ.
_StD©aLi¡
.
_InvŞvedFluidNum
);

159 
RegiÚ
.
_SPHbv
.
	`»size
(RegiÚ.
_StD©aLi¡
.
_InvŞvedFluidNum
);

162 
icouÁ
=0;

163 
i
=0;i!=
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
;++i)

165 
icouÁ
++;

167 
RegiÚ
.
_SPHAm
[
i
].
_RowID
=
icouÁ
;

168 
RegiÚ
.
_SPHAm
[
i
].
_CŞID
=
icouÁ
;

169 
RegiÚ
.
_SPHAm
[
i
].
_EË
=0.0;

171 
RegiÚ
.
_SPHbu
[
i
]=0.0;

172 
RegiÚ
.
_SPHbv
[
i
]=0.0;

174 if(
TimeS‹ps
==
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
)

176 
RegiÚ
.
_SPHu
[
i
]=0.0;

177 
RegiÚ
.
_SPHv
[
i
]=0.0;

181 
ID
;

182 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

184 
RegiÚ
.
_SPHu
[
i
]=RegiÚ.
_PtLi¡
[
ID
].
_u
;

185 
RegiÚ
.
_SPHv
[
i
]=RegiÚ.
_PtLi¡
[
ID
].
_v
;

189 
	}
}

	@SPHInit.h

16 #iâdeà
_SPHINIT_H_


17 
	#_SPHINIT_H_


	)

19 
	~"Ba£Pt.h
"

20 
	~"RegiÚ.h
"

21 
	~<veùÜ
>

23 şas 
	cCSPHIn™


25 
	mpublic
:

27 
CSPHIn™
();

29 ~
CSPHIn™
();

31 
SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
);

33 
	m´iv©e
:

	@SPHPressure.cpp

1 
	~"SPHP»ssu».h
"

3 
	gCSPHP»ssu»
::
	$CSPHP»ssu»
()

5 
	}
}

7 
CSPHP»ssu»
::~
	$CSPHP»ssu»
()

9 
	}
}

11 
CSPHP»ssu»
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

16 
nÜm
;

17 
nÜmx
,
nÜmy
;

18 
uij
,
vij
,
wij
;

19 
IDi
,
IDj
;

20 
wxc
,
wyc
,
wzc
;

21 
Vi
,
Vj
;

22 
·v”g
;

24 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

26 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
!=
’SPHBndPtPaœ
&&RegiÚ._PtPaœLi¡[i]._Ty³!=
’SPHDumPtPaœ
)

28 
PtiPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

29 
PtjPŒ
=(
CSPHPt
*)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

30 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

33 
nÜm
=(
PtiPŒ
->
_p
+
PtjPŒ
->_p)/(PtiPŒ->
_rho
*PtjPtr->_rho);

43 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

44 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

46 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

51 
PtiPŒ
->
_du
-=
PtjPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wx
;

52 
PtiPŒ
->
_dv
-=
PtjPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wy
;

54 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

59 
PtjPŒ
->
_du
+=
PtiPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wx
;

60 
PtjPŒ
->
_dv
+=
PtiPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wy
;

66 
IDi
=
PtiPŒ
->
_ID2
;

73 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wx
;

74 
RegiÚ
.
_SPHbv
[
IDi
-1]-=
PtjPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wy
;

83 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

85 
IDj
=
PtjPŒ
->
_ID2
;

92 
RegiÚ
.
_SPHbu
[
IDj
-1]+=
PtiPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wx
;

93 
RegiÚ
.
_SPHbv
[
IDj
-1]+=
PtiPŒ
->
_m
*
nÜm
*
KÆPŒ
->
_Wy
;

101 
	}
}

	@SPHPressure.h

16 #iâdeà
_SPHPRESSURE_H_


17 
	#_SPHPRESSURE_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

21 
	~"G‘KÆLi¡.h
"

23 şas 
	cCSPHP»ssu»


25 
	mpublic
:

26 
CSPHP»ssu»
();

28 ~
CSPHP»ssu»
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
);

32 
	m´iv©e
:

34 
CG‘KÆLi¡
 
_G‘KÆLi¡P
;

	@SPHPt.cpp

1 
	~"SPHPt.h
"

5 
	gCSPHPt
::
	$CSPHPt
(
ID
,
PID
)

6 :
	$CBa£Pt
(
ID
,
PID
)

8 
	}
}

10 
	gCSPHPt
::~
	$CSPHPt
()

12 
	}
}

	@SPHPt.h

16 #iâdeà
_SPHPT_H_


17 
	#_SPHPT_H_


	)

19 
	~"Ba£Pt.h
"

20 
	~<veùÜ
>

22 şas 
	cCSPHPt
 : 
public
 
CBa£Pt


24 
public
:

26 
CSPHPt
(
ID
,
PID
);

28 ~
CSPHPt
();

31 
	m_Fxx
;

32 
	m_Fxy
;

33 
	m_Fxz
;

34 
	m_Fyx
;

35 
	m_Fyy
;

36 
	m_Fyz
;

37 
	m_Fzx
;

38 
	m_Fzy
;

39 
	m_Fzz
;

41 
	m_Cx
;

42 
	m_Cy
;

43 
	m_Cz
;

46 
	m_Gx
;

47 
	m_Gy
;

48 
	m_Gz
;

49 
	m_Gxx
;

50 
	m_Gxy
;

51 
	m_Gxz
;

52 
	m_Gyx
;

53 
	m_Gyy
;

54 
	m_Gyz
;

55 
	m_Gzx
;

56 
	m_Gzy
;

57 
	m_Gzz
;

58 
	m_Mm
;

59 
	m_Mmx
;

60 
	m_Mmy
;

61 
	m_Mmz
;

62 
	m_Mx
;

63 
	m_My
;

64 
	m_Mz
;

65 
	m_Mxx
;

66 
	m_Mxy
;

67 
	m_Mxz
;

68 
	m_Myy
;

69 
	m_Myx
;

70 
	m_Myz
;

71 
	m_Mzx
;

72 
	m_Mzy
;

73 
	m_Mzz
;

77 
	m_d–p
;

78 
	m_d–p1
;

80 
	m_d–u
;

81 
	m_d–v
;

82 
	m_d–w
;

84 
	m_sfx
;

85 
	m_sfy
;

86 
	m_sfz
;

89 
	m_Rxy
;

90 
	m_Rxz
;

91 
	m_Ryz
;

92 
	m_J2
;

95 
	m_kxx
;

96 
	m_kxy
;

97 
	m_kxz
;

98 
	m_kyx
;

99 
	m_kyy
;

100 
	m_kyz
;

101 
	m_kzx
;

102 
	m_kzy
;

103 
	m_kzz
;

105 
	m_sigmaxx
;

106 
	m_sigmaxy
;

107 
	m_sigmaxz
;

108 
	m_sigmayy
;

109 
	m_sigmayz
;

110 
	m_sigmazz
;

113 
	m_d•sÚxx
;

114 
	m_d•sÚxy
;

115 
	m_d•sÚxz
;

116 
	m_d•sÚyy
;

117 
	m_d•sÚyz
;

118 
	m_d•sÚzz
;

120 
	m_dsxx
;

121 
	m_dsxy
;

122 
	m_dsxz
;

123 
	m_dsyy
;

124 
	m_dsyz
;

125 
	m_dszz
;

	@SPHSTForce.cpp

1 
	~"SPHSTFÜû.h
"

3 
	gCSPHSTFÜû
::
	$CSPHSTFÜû
()

5 
	}
}

7 
CSPHSTFÜû
::~
	$CSPHSTFÜû
()

9 
	}
}

11 
CSPHSTFÜû
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CBa£Pt
 * 
Ba£PŒ
;

15 
CKÆ
 * 
KÆPŒ
;

17 
mi
,
mj
;

18 
rhoi
,
rhoj
;

19 
Nnxx
,
Nnyy
;

20 
C0i
,
C0j
;

21 
IDi
,
IDj
;

22 
ID
,
ID2
;

23 
PID
;

24 
Axx
,
Ayx
,
Axy
,
Ayy
;

25 
xij
,
yij
;

26 
nÜmx
,
nÜmy
;

28 
veùÜ
<> 
bx
;

29 
veùÜ
<> 
by
;

30 
veùÜ
<> 
N
;

32 
bx
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

33 
by
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

34 
N
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0);

37 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

39 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

40 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

41 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

43 
C0i
=
RegiÚ
.
_P¬tLi¡
[
PtiPŒ
->
_PID
-1].
_C0
;

44 
C0j
=
RegiÚ
.
_P¬tLi¡
[
PtjPŒ
->
_PID
-1].
_C0
;

46 
PtiPŒ
->
_C
+=
PtjPŒ
->
_m
/PtjPŒ->
_rho
*
KÆPŒ
->
_W
*
C0j
;

48 if(
PtiPŒ
!=
PtjPŒ
)

50 
PtjPŒ
->
_C
+=
PtiPŒ
->
_m
/PtiPŒ->
_rho
*
KÆPŒ
->
_W
*
C0i
;

56 if(
RegiÚ
.
_CÚŒŞSPH
.
_CSPMIæag2
==0)

58 
_CSPMST
.
	`G‘CSPMG¿dCÜùCÛf
(
RegiÚ
);

62 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

64 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

66 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

67 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

68 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

70 
IDi
=
PtiPŒ
->
_ID2
;

71 
IDj
=
PtjPŒ
->
_ID2
;

73 
mi
=
PtiPŒ
->
_m
;

74 
mj
=
PtjPŒ
->
_m
;

76 
rhoi
=
PtiPŒ
->
_rho
;

77 
rhoj
=
PtjPŒ
->
_rho
;

79 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

80 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

82 
bx
[
IDi
-1]+=
nÜmx
*(
PtiPŒ
->
_C
-
PtjPŒ
->_C);

83 
by
[
IDi
-1]+=
nÜmy
*(
PtiPŒ
->
_C
-
PtjPŒ
->_C);

85 if(
PtiPŒ
!=
PtjPŒ
)

87 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

88 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

90 
bx
[
IDj
-1]-=
nÜmx
*(
PtjPŒ
->
_C
-
PtiPŒ
->_C);

91 
by
[
IDj
-1]-=
nÜmy
*(
PtjPŒ
->
_C
-
PtiPŒ
->_C);

97 
mod
;

98 
xi
;

99 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

101 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

103 
Ba£PŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

105 
ID2
=
Ba£PŒ
->
_ID2
;

107 
Axx
=
Ba£PŒ
->
_CSPMAxx
;

108 
Ayx
=
Ba£PŒ
->
_CSPMAyx
;

109 
Axy
=
Ba£PŒ
->
_CSPMAxy
;

110 
Ayy
=
Ba£PŒ
->
_CSPMAyy
;

112 
_O³¿tÜST
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,&Axx,&Ayx,&Axy,&Ayy);

114 
Ba£PŒ
->
_nx
=
Axx
*
bx
[
ID2
-1]+
Ayx
*
by
[ID2-1];

115 
Ba£PŒ
->
_ny
=
Axy
*
bx
[
ID2
-1]+
Ayy
*
by
[ID2-1];

118 
Axx
=-Axx; 
Ayx
=-Ayx;

119 
Axy
=-Axy; 
Ayy
=-Ayy;

121 
_O³¿tÜST
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,&Axx,&Ayx,&Axy,&Ayy);

123 
Ba£PŒ
->
_CSPMmšLambda
=
_O³¿tÜST
.
	`MšEig2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
);

126 
mod
=
	`sq¹
(
Ba£PŒ
->
_nx
*Ba£PŒ->_nx+Ba£PŒ->
_ny
*BasePtr->_ny);

128 
xi
=0.01/
Ba£PŒ
->
_h
;

130 if(
mod
>
xi
)

132 
N
[
ID2
-1]=1;

133 
Ba£PŒ
->
_Nnx
=Ba£PŒ->
_nx
/
mod
;

134 
Ba£PŒ
->
_Nny
=Ba£PŒ->
_ny
/
mod
;

139 
N
[
ID2
-1]=0;

140 
Ba£PŒ
->
_Nnx
=0.0;

141 
Ba£PŒ
->
_Nny
=0.0;

145 
bx
.
	`ş—r
();

146 
by
.
	`ş—r
();

150 
veùÜ
<> 
bxx
;

151 
veùÜ
<> 
bxy
;

152 
veùÜ
<> 
byx
;

153 
veùÜ
<> 
byy
;

155 
bxx
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

156 
bxy
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

157 
byx
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

158 
byy
.
	`»size
(
RegiÚ
.
_C®Li¡
.
	`size
(),0.0);

159 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

161 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

163 
Ba£PŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

165 
Ba£PŒ
->
_CSPMAxx
=0.0;

166 
Ba£PŒ
->
_CSPMAyx
=0.0;

167 
Ba£PŒ
->
_CSPMAxy
=0.0;

168 
Ba£PŒ
->
_CSPMAyy
=0.0;

171 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡2
.
	`size
();++i)

173 if(
RegiÚ
.
_PtPaœLi¡2
[
i
].
_Ty³
==
’SPHPtPaœ
)

175 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡2
[
i
].
_PtiPŒ
;

176 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡2
[
i
].
_PtjPŒ
;

177 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡2
[
i
];

179 
IDi
=
PtiPŒ
->
_ID2
;

180 
IDj
=
PtjPŒ
->
_ID2
;

182 if(
N
[
IDi
-1]==1&&N[
IDj
-1]==1)

184 
mi
=
PtiPŒ
->
_m
;

185 
mj
=
PtjPŒ
->
_m
;

187 
rhoi
=
PtiPŒ
->
_rho
;

188 
rhoj
=
PtjPŒ
->
_rho
;

190 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

191 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

193 
PtiPŒ
->
_CSPMAxx
+=(PtiPŒ->
_x
-
PtjPŒ
->_x)*
nÜmx
;

194 
PtiPŒ
->
_CSPMAyx
+=(PtiPŒ->
_y
-
PtjPŒ
->_y)*
nÜmx
;

195 
PtiPŒ
->
_CSPMAxy
+=(PtiPŒ->
_x
-
PtjPŒ
->_x)*
nÜmy
;

196 
PtiPŒ
->
_CSPMAyy
+=(PtiPŒ->
_y
-
PtjPŒ
->_y)*
nÜmy
;

198 
bxx
[
IDi
-1]+=(
PtiPŒ
->
_Nnx
-
PtjPŒ
->_Nnx)*
nÜmx
;

199 
bxy
[
IDi
-1]+=(
PtiPŒ
->
_Nnx
-
PtjPŒ
->_Nnx)*
nÜmy
;

201 
byx
[
IDi
-1]+=(
PtiPŒ
->
_Nny
-
PtjPŒ
->_Nny)*
nÜmx
;

202 
byy
[
IDi
-1]+=(
PtiPŒ
->
_Nny
-
PtjPŒ
->_Nny)*
nÜmy
;

204 if(
PtiPŒ
!=
PtjPŒ
)

206 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

207 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

209 
PtjPŒ
->
_CSPMAxx
-=(PtjPŒ->
_x
-
PtiPŒ
->_x)*
nÜmx
;

210 
PtjPŒ
->
_CSPMAyx
-=(PtjPŒ->
_y
-
PtiPŒ
->_y)*
nÜmx
;

211 
PtjPŒ
->
_CSPMAxy
-=(PtjPŒ->
_x
-
PtiPŒ
->_x)*
nÜmy
;

212 
PtjPŒ
->
_CSPMAyy
-=(PtjPŒ->
_y
-
PtiPŒ
->_y)*
nÜmy
;

214 
bxx
[
IDj
-1]-=(
PtjPŒ
->
_Nnx
-
PtiPŒ
->_Nnx)*
nÜmx
;

215 
bxy
[
IDj
-1]-=(
PtjPŒ
->
_Nnx
-
PtiPŒ
->_Nnx)*
nÜmy
;

217 
byx
[
IDj
-1]-=(
PtjPŒ
->
_Nny
-
PtiPŒ
->_Nny)*
nÜmx
;

218 
byy
[
IDj
-1]-=(
PtjPŒ
->
_Nny
-
PtiPŒ
->_Nny)*
nÜmy
;

225 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

227 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

229 
Ba£PŒ
=&
RegiÚ
.
_PtLi¡
[
ID
];

231 
ID2
=
Ba£PŒ
->
_ID2
;

233 
Axx
=
Ba£PŒ
->
_CSPMAxx
;

234 
Ayx
=
Ba£PŒ
->
_CSPMAyx
;

235 
Axy
=
Ba£PŒ
->
_CSPMAxy
;

236 
Ayy
=
Ba£PŒ
->
_CSPMAyy
;

238 
_O³¿tÜST
.
	`Reve2ndM©
(
Axx
,
Ayx
,
Axy
,
Ayy
,&Axx,&Ayx,&Axy,&Ayy);

240 
Nnxx
=
Axx
*
bxx
[
ID2
-1]+
Ayx
*
bxy
[ID2-1];

241 
Nnyy
=
Axy
*
byx
[
ID2
-1]+
Ayy
*
byy
[ID2-1];

243 
Ba£PŒ
->
_Curv©u»
=-(
Nnxx
+
Nnyy
);

247 
sigma
;

248 
PID
=
Ba£PŒ
->
_PID
;

249 
sigma
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_STSigma
;

251 
nÜmx
=
sigma
/
Ba£PŒ
->
_rho
*Ba£PŒ->
_Curv©u»
*Ba£PŒ->
_nx
;

252 
nÜmy
=
sigma
/
Ba£PŒ
->
_rho
*Ba£PŒ->
_Curv©u»
*Ba£PŒ->
_ny
;

254 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

256 
Ba£PŒ
->
_du
+=
nÜmx
;

257 
Ba£PŒ
->
_dv
+=
nÜmy
;

262 
RegiÚ
.
_SPHbu
[
ID2
-1]+=
nÜmx
;

263 
RegiÚ
.
_SPHbv
[
ID2
-1]+=
nÜmy
;

267 
bxx
.
	`ş—r
();

268 
bxy
.
	`ş—r
();

269 
byx
.
	`ş—r
();

270 
byy
.
	`ş—r
();

272 
N
.
	`ş—r
();

273 
	}
}

	@SPHSTForce.h

16 #iâdeà
_SPHSTFORCE_H_


17 
	#_SPHSTFORCE_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"Ba£Pt.h
"

21 
	~"SPHPt.h
"

22 
	~"CSPM.h
"

23 
	~"O³¿tÜ.h
"

24 
	~<veùÜ
>

26 şas 
	cCSPHSTFÜû


28 
	mpublic
:

29 
CSPHSTFÜû
();

31 ~
CSPHSTFÜû
();

33 
SŞve
(
CRegiÚ
 &
RegiÚ
);

35 
	m´iv©e
:

37 
CCSPM
 
_CSPMST
;

39 
CO³¿tÜ
 
	m_O³¿tÜST
;

	@SPHShearingForce.cpp

1 
	~"SPHSh—ršgFÜû.h
"

3 
	gCSPHSh—ršgFÜû
::
	$CSPHSh—ršgFÜû
()

5 
	}
}

7 
CSPHSh—ršgFÜû
::~
	$CSPHSh—ršgFÜû
()

9 
	}
}

11 
CSPHSh—ršgFÜû
::
	$Upd©eDs
(
CRegiÚ
 &
RegiÚ
)

165 
	}
}

	@SPHShearingForce.h

16 #iâdeà
_SPHSHEARINGFORCE_H_


17 
	#_SPHSHEARINGFORCE_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~<cm©h
>

23 şas 
	cCSPHSh—ršgFÜû


25 
	mpublic
:

26 
CSPHSh—ršgFÜû
();

28 ~
CSPHSh—ršgFÜû
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
,
D–T
);

32 
	m´iv©e
:

33 
Upd©eDs
(
CRegiÚ
 &
RegiÚ
);

35 
Upd©eS
(
CRegiÚ
 &
RegiÚ
,
D–T
);

	@SPHSmoothingEqu.cpp

1 
	~"SPHSmoÙhšgEqu.h
"

3 
	gCSPHSmoÙhšgEqu
::
	$CSPHSmoÙhšgEqu
()

5 
	}
}

7 
CSPHSmoÙhšgEqu
::~
	$CSPHSmoÙhšgEqu
()

9 
	}
}

11 
CSPHSmoÙhšgEqu
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
jj
;

14 
CSPHPt
 * 
SPHPtPŒ
;

15 
CP¬t
 * 
P¬tPŒ
;

17 
size_t
 
i
=0;i<
RegiÚ
.
_P¬tLi¡
.
	`size
();i++)

19 
P¬tPŒ
=&
RegiÚ
.
_P¬tLi¡
[
i
];

21 if(
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚSPH


22 ||
RegiÚ
.
_SeùiÚLi¡
[
P¬tPŒ
->
_SECID
-1]->
	`Ty³
()==
’SeùiÚNULL
)

24 
size_t
 
j
=0;j<
P¬tPŒ
->
_P¬tC®Li¡
.
	`size
();j++)

26 
jj
=
P¬tPŒ
->
_P¬tC®Li¡
[
j
];

27 
SPHPtPŒ
=
P¬tPŒ
->
_P¬tPtLi¡
[
jj
];

28 
SPHPtPŒ
->
_dh
=-0.5*SPHPtPŒ->
_h
*SPHPtPŒ->
_drho
/SPHPtPŒ->
_rho
;

32 
	}
}

	@SPHSmoothingEqu.h

16 #iâdeà
_SPHSMOOTHINGEQU_H_


17 
	#_SPHSMOOTHINGEQU_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"SPHPt.h
"

22 şas 
	cCSPHSmoÙhšgEqu


24 
	mpublic
:

25 
CSPHSmoÙhšgEqu
();

27 ~
CSPHSmoÙhšgEqu
();

29 
SŞve
(
CRegiÚ
 &
RegiÚ
);

31 
	m´iv©e
:

	@SPHSolver.cpp

1 
	~"SPHSŞv”.h
"

3 
	gCSPHSŞv”
::
	$CSPHSŞv”
()

4 :
	`_Ttime
(0.0),
	$_TimeS‹ps
(0)

6 
	}
}

8 
	gCSPHSŞv”
::~
	$CSPHSŞv”
()

10 
	}
}

12 
CSPHSŞv”
::
	$IÅut
()

15 
_RegiÚ
.
_CÚŒŞSPH
.
_InfeName
=

28 
_KFe
.
	`IÅut
(
_RegiÚ
);

30 
_Mod–
.
	`EHDPÏÂ¬
(
_RegiÚ
);

38 
_KFe
.
	`OutTeılÙ2
(
_RegiÚ
,0,"ehdplanner-init");

39 
cout
<<"-----------------------------------"<<
’dl
;

41 
cout
<<"ThtÙ®…¬tişnumb” is"<<
_RegiÚ
.
_PtLi¡
.
	`size
()<<
’dl
;

43 
_NblSch
.
	`ResizeBox
(
_RegiÚ
.
_CÚŒŞSPH
.
_C–lNumx
,_RegiÚ._CÚŒŞSPH.
_C–lNumy
);

46 
	}
}

48 
	gCSPHSŞv”
::
	$Ouut
()

50 
_KFe
.
	`OutTeılÙ
(
_RegiÚ
,
_TimeS‹ps
);

51 
	}
}

53 
	gCSPHSŞv”
::
	$Run
()

55 
_TimeS‹ps
=
_RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
;

57 
_Ttime
=
_RegiÚ
.
_CÚŒŞSPH
.
_D–T
*
_TimeS‹ps
;

59 ;
_Ttime
<
_RegiÚ
.
_CÚŒŞSPH
.
_Fš®Time
;)

61 
cout
<<"thtim¡• is"<<
_TimeS‹ps
<<
’dl
;

63 
cout
<<"thtÙ®imis"<<
_Ttime
<<
’dl
;

74 
cout
<<"0.P»·¿tiÚ: Upd©C®cuÏtiÚ Rªg& In™Ÿliz©iÚ."<<
’dl
;

76 
_C®cuÏ‹Rªge
.
	`_Upd©eRªge
(
_RegiÚ
,
_TimeS‹ps
);

78 
_SPHIn™
.
	`SŞve
(
_RegiÚ
,
_TimeS‹ps
);

80 
cout
<<"0.P»·¿tiÚ ha b“ÀdÚe."<<
’dl
;

82 
cout
<<"thnumb” oà·¹işe švŞved iÀÿlcuÏtiÚ is"<<
_RegiÚ
.
_C®Li¡
.
	`size
()<<
’dl
;

84 
cout
<<"1.¡¬ˆÃighbÜ…¬tişe £¬chšg."<<
’dl
;

86 
_NblSch
.
	`G‘Nbl
(
_RegiÚ
);

88 
cout
<<"1.ÃighbÜ s—rchšg ha b“ÀdÚÑÙ®‚eighbÜ…aœs:"<<
_RegiÚ
.
_PtPaœLi¡
.
	`size
()<<")"<<
’dl
;

90 
cout
<<"2.¡¬ˆg‘tšg kÆli¡."<<
’dl
;

92 
_G‘KÆLi¡
.
	`G‘KÆLi¡
(
_RegiÚ
);

94 
cout
<<"2.kÆli¡ ha b“ÀgÙ."<<
’dl
;

102 
_D–T
.
	`G‘D–T
(
_RegiÚ
);

104 
cout
<<"D–T:"<<
_D–T
.
_D–T1
<<
’dl
;

106 
cout
<<"3.¡¬ˆÿlcuÏtšg cÚtšu™yƒqu©iÚ."<<
’dl
;

110 
cout
<<"3.cÚtšu™yƒqu©iÚ ha b“ÀsŞved."<<
’dl
;

112 
cout
<<"4.¡¬ˆsŞvšgƒqu©iÚ oà¡©iÚ"<<
’dl
;

116 
cout
<<"4.equ©iÚ oà¡©iÚ ha b“ÀsŞved."<<
’dl
;

121 
cout
<<"5.¡¬ˆsŞvšg mom’tumƒqu©iÚ."<<
’dl
;

123 
_SPHEqu
.
	`AcûË¿‹
(
_RegiÚ
,
_D–T
.
_D–T1
,
_TimeS‹ps
);

125 
cout
<<"5.mom’tumƒqu©iÚ ha b“ÀsŞved."<<
’dl
;

127 
	`Ouut
();

129 
cout
<<"6.¡¬ˆupd©th·¹işpos™iÚ."<<
’dl
;

131 if(
_RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

133 
_Upd©ePos™iÚ
.
	`L—pFrogUpd©e
(
_RegiÚ
,
_D–T
._D–T,_D–T.
_D–T1
,
_TimeS‹ps
);

137 
_Upd©ePos™iÚ
.
	`Im¶ic™Upd©e
(
_RegiÚ
);

139 
cout
<<"6.·¹işpos™iÚ ha b“Àupd©ed."<<
’dl
;

141 
_Ttime
+=
_D–T
.
_D–T1
;

143 
_TimeS‹ps
++;

145 
cout
<<
_TimeS‹ps
<<"im¡•s' c®cuÏtiÚ ha b“ÀdÚe"<<
’dl
;

147 
cout
<<"----------------------------------------------------------"<<
’dl
;

149 if(
_TimeS‹ps
%(
_RegiÚ
.
_CÚŒŞSPH
.
_OuutS‹ps
)==0)

151 
	`Ouut
();

154 
_NblSch
.
	`CË¬
(
_RegiÚ
);

156 
_G‘KÆLi¡
.
	`CË¬KÆLi¡
(
_RegiÚ
);

158 
_C®cuÏ‹Rªge
.
	`_CË¬
(
_RegiÚ
);

160 
	}
}

162 
	gCSPHSŞv”
::
	$DÚe
()

164 
_NblSch
.
	`CË¬
(
_RegiÚ
);

166 
_G‘KÆLi¡
.
	`CË¬KÆLi¡
(
_RegiÚ
);

168 
_KFe
.
	`CË¬
(
_RegiÚ
);

170 if(
_RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==0)

172 
_RegiÚ
.
_SPHAm
.
	`ş—r
();

174 
_RegiÚ
.
_SPHu
.
	`ş—r
();

175 
_RegiÚ
.
_SPHv
.
	`ş—r
();

176 
_RegiÚ
.
_SPHw
.
	`ş—r
();

178 
_RegiÚ
.
_SPHbu
.
	`ş—r
();

179 
_RegiÚ
.
_SPHbv
.
	`ş—r
();

180 
_RegiÚ
.
_SPHbw
.
	`ş—r
();

182 
	}
}

	@SPHSolver.h

16 #iâdeà
_SPHSOLVER_H_


17 
	#_SPHSOLVER_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"KFe.h
"

21 
	~"SPHEOS.h
"

22 
	~"NblSch.h
"

23 
	~"G‘KÆLi¡.h
"

24 
	~"SPHEqu.h
"

25 
	~"D–T.h
"

26 
	~"CÚŒŞSPH.h
"

27 
	~"SPHIPCSEqu.h
"

28 
	~"C®cuÏ‹Rªge.h
"

29 
	~"CÚtšu™yEqu.h
"

30 
	~"O³¿tÜ.h
"

31 
	~"Upd©ePos™iÚ.h
"

32 
	~"SPHIn™.h
"

33 
	~"Id’tPtLoÿl.h
"

34 
	~"Remesh.h
"

35 
	~"G‘DumPrİ”ty.h
"

36 
	~"C®BndNÜm.h
"

37 
	~"Mod–.h
"

39 
	~<io¡»am
>

40 
	~<veùÜ
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

44 şas 
	cCSPHSŞv”


46 
	mpublic
:

47 
CSPHSŞv”
();

49 ~
CSPHSŞv”
();

51 
IÅut
();

53 
Run
();

55 
DÚe
();

57 
	m´iv©e
:

59 
_Ttime
;

61 
size_t
 
	m_TimeS‹ps
;

63 
Ouut
();

65 
CRegiÚ
 
	m_RegiÚ
;

67 
CKFe
 
	m_KFe
;

69 
CD–T
 
	m_D–T
;

71 
CUpd©ePos™iÚ
 
	m_Upd©ePos™iÚ
;

73 
CSPHEOS
 
	m_SPHEOS
;

75 
CSPHIPCSEqu
 
	m_SPHIPCSEqu
;

77 
CCÚtšu™yEqu
 
	m_CÚtšu™yEqu
;

79 
CSPHEqu
 
	m_SPHEqu
;

81 
CNblSch
 
	m_NblSch
;

83 
CG‘KÆLi¡
 
	m_G‘KÆLi¡
;

87 
CC®cuÏ‹Rªge
 
	m_C®cuÏ‹Rªge
;

89 
CSPHIn™
 
	m_SPHIn™
;

91 
CId’tPtLoÿl
 
	m_Id’tPtLoÿl
;

93 
CRemesh
 
	m_Remesh
;

95 
CG‘DumPrİ”ty
 
	m_G‘DumPrİ”ty
;

97 
CC®BndNÜm
 
	m_C®BndNÜm
;

99 
CMod–
 
	m_Mod–
;

	@SPHViscoelastic.cpp

1 
	~"SPHViscÛÏ¡ic.h
"

3 
	gCSPHViscÛÏ¡ic
::
	$CSPHViscÛÏ¡ic
()

5 
	}
}

7 
CSPHViscÛÏ¡ic
::~
	$CSPHViscÛÏ¡ic
()

9 
	}
}

11 
CSPHViscÛÏ¡ic
::
	$Upd©eDs
(
CRegiÚ
 &
RegiÚ
)

124 
	}
}

126 
CSPHViscÛÏ¡ic
::
	$Upd©eS
(
CRegiÚ
 &
RegiÚ
,
D–T
)

159 
	}
}

161 
	gCSPHViscÛÏ¡ic
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
,
D–T
)

199 
	}
}

	@SPHViscoelastic.h

16 #iâdeà
_SPHVISCOELASTIC_H_


17 
	#_SPHVISCOELASTIC_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~<cm©h
>

23 şas 
	cCSPHViscÛÏ¡ic


25 
	mpublic
:

26 
CSPHViscÛÏ¡ic
();

28 ~
CSPHViscÛÏ¡ic
();

30 
SŞve
(
CRegiÚ
 &
RegiÚ
,
D–T
);

32 
Upd©eDs
(
CRegiÚ
 &
RegiÚ
);

34 
Upd©eS
(
CRegiÚ
 &
RegiÚ
,
D–T
);

36 
	m´iv©e
:

	@SPHViscosity.cpp

1 
	~"SPHViscos™y.h
"

3 
	gCSPHViscos™y
::
	$CSPHViscos™y
()

5 
	}
}

7 
CSPHViscos™y
::~
	$CSPHViscos™y
()

9 
	}
}

12 
CSPHViscos™y
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
)

14 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

15 
CKÆ
 * 
KÆPŒ
;

17 
uij
,
vij
,
wij
;

18 
xij
,
yij
,
zij
;

19 
mi
,
mj
;

20 
rhoi
,
rhoj
;

21 
rhßv
;

22 
‘ai
,
‘aj
;

23 
vi¢Üm
;

24 
IDi
,
IDj
;

25 
wxc
,
wyc
,
wzc
;

26 
MAXX
,
MINX
;

28 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

30 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

31 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

35 
	`SŞveE
(
RegiÚ
,
TimeS‹ps
);

37 
size_t
 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

39 
PtiPŒ
=(
CSPHPt
 *)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

40 
PtjPŒ
=(
CSPHPt
 *)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

41 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

43 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

45 if(
PtiPŒ
!=
PtjPŒ
)

47 
IDi
=
PtiPŒ
->
_ID2
;

48 
IDj
=
PtjPŒ
->
_ID2
;

50 
mi
=
PtiPŒ
->
_m
;

51 
mj
=
PtjPŒ
->
_m
;

53 
rhoi
=
PtiPŒ
->
_rho
;

54 
rhoj
=
PtjPŒ
->
_rho
;

57 
‘ai
=
PtiPŒ
->
_VisE
;

58 
‘aj
=
PtjPŒ
->
_VisE
;

60 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

61 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

63 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

65 ià(
xij
>1.2*
PtiPŒ
->
_r
)

67 
xij
-=(
MAXX
-
MINX
);

69 ià(
xij
<-1.2*
PtiPŒ
->
_r
)

71 
xij
+=(
MAXX
-
MINX
);

75 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

77 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

78 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

81 
vi¢Üm
=
mj
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

86 
PtiPŒ
->
_du
+=
uij
*
vi¢Üm
;

87 
PtiPŒ
->
_dv
+=
vij
*
vi¢Üm
;

90 
vi¢Üm
=
mi
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

95 
PtjPŒ
->
_du
-=
uij
*
vi¢Üm
;

96 
PtjPŒ
->
_dv
-=
vij
*
vi¢Üm
;

101 
CM©rix
 
TempM
;

105 
vi¢Üm
=
mj
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

117 
RegiÚ
.
_SPHAm
[
IDi
-1].
_EË
-=
vi¢Üm
;

119 
TempM
.
_EË
=
vi¢Üm
;

120 
TempM
.
_RowID
=
IDi
;

121 
TempM
.
_CŞID
=
IDj
;

122 
RegiÚ
.
_SPHAm
.
	`push_back
(
TempM
);

127 
vi¢Üm
=
mi
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

138 
RegiÚ
.
_SPHAm
[
IDj
-1].
_EË
-=
vi¢Üm
;

140 
TempM
.
_EË
=
vi¢Üm
;

141 
TempM
.
_RowID
=
IDj
;

142 
TempM
.
_CŞID
=
IDi
;

143 
RegiÚ
.
_SPHAm
.
	`push_back
(
TempM
);

150 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHNULLPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHBndPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHDumPtPaœ
)

152 
IDi
=
PtiPŒ
->
_ID2
;

153 
IDj
=
PtjPŒ
->
_ID2
;

155 
mi
=
PtiPŒ
->
_m
;

156 
mj
=
PtjPŒ
->
_m
;

158 
rhoi
=
PtiPŒ
->
_rho
;

159 
rhoj
=
PtjPŒ
->
_rho
;

162 
‘ai
=
PtiPŒ
->
_VisE
;

163 
‘aj
=
PtjPŒ
->
_VisE
;

165 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

166 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

168 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

170 ià(
xij
>1.2*
PtiPŒ
->
_r
)

172 
xij
-=(
MAXX
-
MINX
);

174 ià(
xij
<-1.2*
PtiPŒ
->
_r
)

176 
xij
+=(
MAXX
-
MINX
);

180 if(
RegiÚ
.
_CÚŒŞSPH
.
_RunMod
==1)

182 
uij
=
PtiPŒ
->
_u
-
PtjPŒ
->_u;

183 
vij
=
PtiPŒ
->
_v
-
PtjPŒ
->_v;

186 
vi¢Üm
=
mj
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

191 
PtiPŒ
->
_du
+=
uij
*
vi¢Üm
;

192 
PtiPŒ
->
_dv
+=
vij
*
vi¢Üm
;

197 
CM©rix
 
TempM
;

201 
vi¢Üm
=
mj
*(
‘ai
+
‘aj
)/(
rhoi
*
rhoj
)*
KÆPŒ
->
_Ww
;

213 
RegiÚ
.
_SPHAm
[
IDi
-1].
_EË
-=
vi¢Üm
;

215 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_u
*
vi¢Üm
;

216 
RegiÚ
.
_SPHbu
[
IDi
-1]-=
PtjPŒ
->
_v
*
vi¢Üm
;

221 
	}
}

223 
	gCSPHViscos™y
::
	$SŞveE
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
)

225 
Ww
;

226 
xji
,
yji
,
zji
;

227 
uji
,
vji
,
wji
;

228 
mi
,
rhoi
;

229 
mj
,
rhoj
;

230 
nÜmx
,
nÜmy
,
nÜmz
;

231 
wxc
,
wyc
,
wzc
;

233 
IDi
,
IDj
;

234 
ID
,
PID
;

236 
CSPHPt
 * 
PtiPŒ
,* 
PtjPŒ
;

237 
CKÆ
 * 
KÆPŒ
;

239 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHPV
==0&&
TimeS‹ps
==RegiÚ._CÚŒŞSPH.
_S¹S‹p
)

241 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

243 
PID
=
RegiÚ
.
_PtLi¡
[
i
].
_PID
;

245 
RegiÚ
.
_PtLi¡
[
i
].
_VisE
=RegiÚ.
_P¬tLi¡
[
PID
-1].
_VisK
;

250 if(
RegiÚ
.
_CÚŒŞSPH
.
_SPHPV
==1)

253 
_G¿dux
.
	`»size
(
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
,0.0);

254 
_G¿duy
.
	`»size
(
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
,0.0);

255 
_G¿dvx
.
	`»size
(
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
,0.0);

256 
_G¿dvy
.
	`»size
(
RegiÚ
.
_StD©aLi¡
.
_InvŞvedFluidNum
,0.0);

261 
i
=0;i<
RegiÚ
.
_PtPaœLi¡
.
	`size
();i++)

263 
PtiPŒ
=(
CSPHPt
 *)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

264 
PtjPŒ
=(
CSPHPt
 *)
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

265 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
i
];

267 
IDi
=
PtiPŒ
->
_ID2
;

268 
IDj
=
PtjPŒ
->
_ID2
;

270 
rhoi
=
PtiPŒ
->
_rho
;

271 
rhoj
=
PtjPŒ
->
_rho
;

273 
mi
=
PtiPŒ
->
_m
;

274 
mj
=
PtjPŒ
->
_m
;

276 
uji
=
PtjPŒ
->
_u
-
PtiPŒ
->_u;

277 
vji
=
PtjPŒ
->
_v
-
PtiPŒ
->_v;

279 
xji
=
PtjPŒ
->
_x
-
PtiPŒ
->_x;

280 
yji
=
PtjPŒ
->
_y
-
PtiPŒ
->_y;

282 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
)

286 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

287 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

296 
_G¿dux
[
IDi
-1]+=
nÜmx
*
uji
;

297 
_G¿duy
[
IDi
-1]+=
nÜmy
*
uji
;

298 
_G¿dvx
[
IDi
-1]+=
nÜmx
*
vji
;

299 
_G¿dvy
[
IDi
-1]+=
nÜmy
*
vji
;

302 
nÜmx
=
mi
/
rhoi
*
KÆPŒ
->
_Wx
;

303 
nÜmy
=
mi
/
rhoi
*
KÆPŒ
->
_Wy
;

311 
_G¿dux
[
IDj
-1]+=
nÜmx
*
uji
;

312 
_G¿duy
[
IDj
-1]+=
nÜmy
*
uji
;

313 
_G¿dvx
[
IDj
-1]+=
nÜmx
*
vji
;

314 
_G¿dvy
[
IDj
-1]+=
nÜmy
*
vji
;

318 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHNULLPtPaœ
)

322 
nÜmx
=
mj
/
rhoj
*
KÆPŒ
->
_Wx
;

323 
nÜmy
=
mj
/
rhoj
*
KÆPŒ
->
_Wy
;

332 
_G¿dux
[
IDi
-1]+=
nÜmx
*
uji
;

333 
_G¿duy
[
IDi
-1]+=
nÜmy
*
uji
;

334 
_G¿dvx
[
IDi
-1]+=
nÜmx
*
vji
;

335 
_G¿dvy
[
IDi
-1]+=
nÜmy
*
vji
;

360 
Pow”Lawk
,
Pow”Lawn
;

363 
i
=0;i<
RegiÚ
.
_C®Li¡
.
	`size
();i++)

365 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

367 if(
RegiÚ
.
_PtLi¡
[
ID
].
_Ty³
==
’SPHPt
)

369 
IDi
=
RegiÚ
.
_PtLi¡
[
ID
].
_ID2
;

372 
RegiÚ
.
_PtLi¡
[
ID
].
_VisGamma
=
	`sq¹
(2*
_G¿dux
[
IDi
-1]*_G¿dux[IDi-1]+2*
_G¿dvy
[IDi-1]*_Gradvy[IDi-1]

373 +(
_G¿dvx
[
IDi
-1]+
_G¿duy
[IDi-1])*(_Gradvx[IDi-1]+_Graduy[IDi-1]));

377 
PID
=
RegiÚ
.
_PtLi¡
[
ID
].
_PID
;

379 
Pow”Lawk
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_VisK
;

380 
Pow”Lawn
=
RegiÚ
.
_P¬tLi¡
[
PID
-1].
_VisN
;

382 if(
RegiÚ
.
_PtLi¡
[
ID
].
_VisGamma
==0)

383 
RegiÚ
.
_PtLi¡
[
ID
].
_VisE
=10000;

385 
RegiÚ
.
_PtLi¡
[
ID
].
_VisE
=
Pow”Lawk
*
	`pow
(RegiÚ._PtLi¡[ID].
_VisGamma
,
Pow”Lawn
-1);

387 if(
RegiÚ
.
_PtLi¡
[
ID
].
_VisE
>10000)

388 
RegiÚ
.
_PtLi¡
[
ID
].
_VisE
=10000;

429 
_G¿dux
.
	`ş—r
();

430 
_G¿duy
.
	`ş—r
();

431 
_G¿dvx
.
	`ş—r
();

432 
_G¿dvy
.
	`ş—r
();

434 
	}
}

	@SPHViscosity.h

16 #iâdeà
_SPHVISCOSITY_H_


17 
	#_SPHVISCOSITY_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"SPHIPCS.h
"

22 
	~"W—klyCom´ess.h
"

23 
	~"M©rix.h
"

24 
	~"G‘KÆLi¡.h
"

25 
	~"CSPM.h
"

26 
	~<cm©h
>

28 şas 
	cCSPHViscos™y


30 
	mpublic
:

32 
CSPHViscos™y
();

34 ~
CSPHViscos™y
();

36 
SŞve
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
);

38 
	m´iv©e
:

40 
¡d
::
veùÜ
<> 
_G¿dux
;

41 
	m¡d
::
veùÜ
<> 
_G¿duy
;

42 
	m¡d
::
veùÜ
<> 
_G¿duz
;

43 
	m¡d
::
veùÜ
<> 
_G¿dvx
;

44 
	m¡d
::
veùÜ
<> 
_G¿dvy
;

45 
	m¡d
::
veùÜ
<> 
_G¿dvz
;

46 
	m¡d
::
veùÜ
<> 
_G¿dwx
;

47 
	m¡d
::
veùÜ
<> 
_G¿dwy
;

48 
	m¡d
::
veùÜ
<> 
_G¿dwz
;

50 
CG‘KÆLi¡
 
	m_G‘KÆLi¡V
;

52 
CCSPM
 
	m_CSPMV
;

54 
SŞveE
(
CRegiÚ
 &
RegiÚ
,
TimeS‹ps
);

	@Section.cpp

1 
	~"SeùiÚ.h
"

3 
	gCSeùiÚ
::
	$CSeùiÚ
(
’SECTIONTYPE
 
Ty³
,
SECID
)

4 :
	`_Ty³
(
Ty³
),
	$_SECID
(
SECID
)

6 
	}
}

8 
	gCSeùiÚ
::~
	$CSeùiÚ
()

10 
	}
}

12 
’SECTIONTYPE
 
CSeùiÚ
::
	$Ty³
()

14  
_Ty³
;

15 
	}
}

	@Section.h

16 #iâdeà
_SECTION_H_


17 
	#_SECTION_H_


	)

19 
	e’SECTIONTYPE
 {
	m’SeùiÚSPH
,
	m’SeùiÚNULL
};

21 şas 
	cCSeùiÚ


23 
	mpublic
:

24 
CSeùiÚ
(
’SECTIONTYPE
 
Ty³
,
SECID
=0);

26 ~
CSeùiÚ
();

28 
’SECTIONTYPE
 
Ty³
();

30 
	m_SECID
;

32 
	m´iv©e
:

33 
’SECTIONTYPE
 
_Ty³
;

	@SectionNULL.cpp

1 
	~"SeùiÚNULL.h
"

3 
	gCSeùiÚNULL
::
	$CSeùiÚNULL
(
SECID
)

4 :
	`CSeùiÚ
(
’SeùiÚNULL
,
SECID
),
	$_CSLH
(0.0)

6 
	}
}

8 
	gCSeùiÚNULL
::~
	$CSeùiÚNULL
()

10 
	}
}

	@SectionNULL.h

16 #iâdeà
_SECTIONNULL_H_


17 
	#_SECTIONNULL_H_


	)

19 
	~"SeùiÚ.h
"

21 şas 
	cCSeùiÚNULL
:
public
 
CSeùiÚ


23 
public
:

25 
CSeùiÚNULL
(
SECID
=0);

27 ~
CSeùiÚNULL
();

29 
	m_CSLH
;

	@SectionSPH.cpp

1 
	~"SeùiÚSPH.h
"

3 
	gCSeùiÚSPH
::
	$CSeùiÚSPH
(
SECID
)

4 :
	`CSeùiÚ
(
’SeùiÚSPH
,
SECID
),
	$_CSLH
(0.0)

6 
	}
}

8 
	gCSeùiÚSPH
::~
	$CSeùiÚSPH
()

10 
	}
}

	@SectionSPH.h

16 #iâdeà
_SECTIONSPH_H_


17 
	#_SECTIONSPH_H_


	)

19 
	~"SeùiÚ.h
"

21 şas 
	cCSeùiÚSPH
:
public
 
CSeùiÚ


23 
public
:

25 
CSeùiÚSPH
(
SECID
=0);

27 ~
CSeùiÚSPH
();

29 
	m_CSLH
;

	@StatData.cpp

1 
	~"StD©a.h
"

3 
	gCStD©a
::
	$CStD©a
()

5 
	}
}

7 
CStD©a
::~
	$CStD©a
()

9 
	}
}

	@StatData.h

16 #iâdeà
_STATDATA_H_


17 
	#_STATDATA_H_


	)

19 
	~<veùÜ
>

21 
usšg
 
Çme¥aû
 
	g¡d
;

23 şas 
	cCStD©a


25 
	mpublic
:

27 
CStD©a
();

29 ~
CStD©a
();

31 
	m_P¬tNum
;

33 
	m_SPHNum
;

35 
	m_SPHFluidNum
;

37 
	m_InvŞvedFluidNum0
;

38 
	m_InvŞvedFluidNum
;

40 
	m_NuÎPtNum
;

42 
	m_BndPtNum
;

44 
	m_Gho¡PtNum
;

46 
	m_PtPaœNum
;

48 
	m_PtPaœNum2
;

50 
	m_SPHPtPaœNum
;

52 
	m_Gho¡PtPaœNum
;

54 
	m_MshPtPaœNum
;

56 
	m_KÆNum
;

58 * 
	m_NumNeighbÜ
;

60 * 
	m_NeighbÜID
;

62 
	m_MaxNeighbÜNum
;

64 
	m_TÙ®NeighbÜNum
;

68 
	m´iv©e
:

	@UnsteadyTerm.cpp

1 
	~"Un¡—dyT”m.h
"

3 
	gCUn¡—dyT”m
::
	$CUn¡—dyT”m
()

5 
	}
}

7 
CUn¡—dyT”m
::~
	$CUn¡—dyT”m
()

9 
	}
}

11 
CUn¡—dyT”m
::
	$SŞve
(
CRegiÚ
 &
RegiÚ
)

13 
CSPHPt
 * 
SPHPtPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

17 
IDi
,
IDj
;

18 
ID
;

19 
ID2
;

20 
D–T
;

22 
D–T
=
RegiÚ
.
_CÚŒŞSPH
.
_D–T
;

25 
i
=0;i<
RegiÚ
.
_C®Li¡
.
	`size
();i++)

27 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

29 
ID2
=
RegiÚ
.
_PtLi¡
[
ID
].
_ID2
;

32 
RegiÚ
.
_SPHbu
[
ID2
-1]+=RegiÚ.
_PtLi¡
[
ID
].
_u
/
D–T
;

33 
RegiÚ
.
_SPHbv
[
ID2
-1]+=RegiÚ.
_PtLi¡
[
ID
].
_v
/
D–T
;

36 
RegiÚ
.
_SPHAm
[
ID2
-1].
_EË
+=1/
D–T
;

38 
	}
}

	@UnsteadyTerm.h

16 #iâdeà
_UNSTEADYTERM_H_


17 
	#_UNSTEADYTERM_H_


	)

19 
	~"SPHPt.h
"

20 
	~"RegiÚ.h
"

21 
	~"M©rix.h
"

22 
	~<cm©h
>

24 şas 
	cCUn¡—dyT”m


26 
	mpublic
:

28 
CUn¡—dyT”m
();

30 ~
CUn¡—dyT”m
();

32 
SŞve
(
CRegiÚ
 &
RegiÚ
);

34 
	m´iv©e
:

	@UpdatePosition.cpp

1 
	~"Upd©ePos™iÚ.h
"

3 
	gCUpd©ePos™iÚ
::
	$CUpd©ePos™iÚ
()

5 
	}
}

7 
CUpd©ePos™iÚ
::~
	$CUpd©ePos™iÚ
()

9 
	}
}

11 
CUpd©ePos™iÚ
::
	$L—pFrogUpd©e
(
CRegiÚ
 & 
RegiÚ
, 
D–T
,
D–T1
,
TimeS‹ps
)

13 
CBa£Pt
 * 
PtiPŒ
,* 
PtjPŒ
;

14 
CKÆ
 * 
KÆPŒ
;

15 
CBa£Pt
 *
PtPŒ
;

16 
CBa£Pt
 * 
Ba£PtPŒ
;

17 
D–THf
;

18 
D–TAv”
;

19 
i
,
j
;

20 
ID
;

22 
Av”Rho
;

23 
uij
,
vij
;

24 
XSPHEpsÚ
;

27 
Maxv
;

28 
vi
;

29 
rij
;

30 
xij
,
yij
,
zij
;

31 
PtSháB‘a
;

33 
D–THf
=
D–T1
*0.5;

34 
D–TAv”
=(
D–T
+
D–T1
)*0.5;

36 if(
TimeS‹ps
==
RegiÚ
.
_CÚŒŞSPH
.
_S¹S‹p
)

38 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

40 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

41 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

43 
Ba£PtPŒ
->
_rhoHf
=Ba£PtPŒ->
_rho
+Ba£PtPŒ->
_drho
*
D–THf
;

44 
Ba£PtPŒ
->
_uHf
=Ba£PtPŒ->
_u
+Ba£PtPŒ->
_du
*
D–THf
;

45 
Ba£PtPŒ
->
_vHf
=Ba£PtPŒ->
_v
+Ba£PtPŒ->
_dv
*
D–THf
;

48 
Ba£PtPŒ
->
_hHf
=Ba£PtPŒ->
_h
+Ba£PtPŒ->
_dh
*
D–THf
;

63 if(
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
!=0)

66 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

68 
RegiÚ
.
_PtLi¡
[
j
].
_uXSPHCÛf
=0;

69 
RegiÚ
.
_PtLi¡
[
j
].
_vXSPHCÛf
=0;

72 
j
=0;j<
RegiÚ
.
_PtPaœLi¡
.
	`size
();j++)

74 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
)

76 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtiPŒ
;

77 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtjPŒ
;

79 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
j
];

81 
uij
=
PtiPŒ
->
_uHf
-
PtjPŒ
->_uHf;

82 
vij
=
PtiPŒ
->
_vHf
-
PtjPŒ
->_vHf;

84 
Av”Rho
=0.5*(
PtiPŒ
->
_rho
+
PtjPŒ
->_rho);

86 
PtiPŒ
->
_uXSPHCÛf
+=
PtjPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

87 
PtiPŒ
->
_vXSPHCÛf
+=
PtjPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

89 if(
PtiPŒ
!=
PtjPŒ
)

91 
PtjPŒ
->
_uXSPHCÛf
-=
PtiPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

92 
PtjPŒ
->
_vXSPHCÛf
-=
PtiPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

97 
XSPHEpsÚ
=
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
;

99 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

101 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

103 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

105 
Ba£PtPŒ
->
_x
+=(Ba£PtPŒ->
_uHf
-
XSPHEpsÚ
*Ba£PtPŒ->
_uXSPHCÛf
)*
D–T1
;

106 
Ba£PtPŒ
->
_y
+=(Ba£PtPŒ->
_vHf
-
XSPHEpsÚ
*Ba£PtPŒ->
_vXSPHCÛf
)*
D–T1
;

113 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

115 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

117 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

119 
Ba£PtPŒ
->
_x
+=Ba£PtPŒ->
_uHf
*
D–T1
;

120 
Ba£PtPŒ
->
_y
+=Ba£PtPŒ->
_vHf
*
D–T1
;

128 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

130 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

132 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

134 
Ba£PtPŒ
->
_rhoHf
+=Ba£PtPŒ->
_drho
*
D–TAv”
;

135 
Ba£PtPŒ
->
_uHf
+=Ba£PtPŒ->
_du
*
D–TAv”
;

136 
Ba£PtPŒ
->
_vHf
+=Ba£PtPŒ->
_dv
*
D–TAv”
;

139 
Ba£PtPŒ
->
_hHf
+=Ba£PtPŒ->
_dh
*
D–TAv”
;

155 if(
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
!=0)

158 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

160 
RegiÚ
.
_PtLi¡
[
j
].
_uXSPHCÛf
=0;

161 
RegiÚ
.
_PtLi¡
[
j
].
_vXSPHCÛf
=0;

164 
j
=0;j<
RegiÚ
.
_PtPaœLi¡
.
	`size
();j++)

166 if(
RegiÚ
.
_PtPaœLi¡
[
i
].
_Ty³
==
’SPHPtPaœ
||RegiÚ._PtPaœLi¡[i]._Ty³==
’SPHNULLPtPaœ
)

168 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtiPŒ
;

169 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtjPŒ
;

171 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
j
];

173 
uij
=
PtiPŒ
->
_uHf
-
PtjPŒ
->_uHf;

174 
vij
=
PtiPŒ
->
_vHf
-
PtjPŒ
->_vHf;

176 
Av”Rho
=0.5*(
PtiPŒ
->
_rho
+
PtjPŒ
->_rho);

178 
PtiPŒ
->
_uXSPHCÛf
+=
PtjPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

179 
PtiPŒ
->
_vXSPHCÛf
+=
PtjPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

181 if(
PtiPŒ
!=
PtjPŒ
)

183 
PtjPŒ
->
_uXSPHCÛf
-=
PtiPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

184 
PtjPŒ
->
_vXSPHCÛf
-=
PtiPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

189 
XSPHEpsÚ
=
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
;

191 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

193 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

195 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

197 
Ba£PtPŒ
->
_x
+=(Ba£PtPŒ->
_uHf
-
XSPHEpsÚ
*Ba£PtPŒ->
_uXSPHCÛf
)*
D–T1
;

198 
Ba£PtPŒ
->
_y
+=(Ba£PtPŒ->
_vHf
-
XSPHEpsÚ
*Ba£PtPŒ->
_vXSPHCÛf
)*
D–T1
;

205 ià(
RegiÚ
.
_CÚŒŞSPH
.
_PtSháB‘a
!=0)

208 
Maxv
=0.0;

209 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

211 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

213 
vi
=
	`sq¹
(
RegiÚ
.
_PtLi¡
[
ID
].
_uHf
*RegiÚ._PtLi¡[ID]._uHf+RegiÚ._PtLi¡[ID].
_vHf
*Region._PtList[ID]._vHf);

215 ià(
vi
>
Maxv
)

217 
Maxv
=
vi
;

223 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

225 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

226 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

228 
rij
=
	`sq¹
(
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
);

230 
PtiPŒ
->
_r0
+=
rij
/PtiPŒ->
_NumNegbÜ
;

232 ià(
PtiPŒ
!=
PtjPŒ
)

234 
PtjPŒ
->
_r0
+=
rij
/PtjPŒ->
_NumNegbÜ
;

239 
PtSháB‘a
=
RegiÚ
.
_CÚŒŞSPH
.
_PtSháB‘a
;

240 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

242 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

243 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

245 ià(
PtiPŒ
!=
PtjPŒ
)

247 
rij
=
	`sq¹
(
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
);

248 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

249 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

251 
PtiPŒ
->
_PtSháCÛfu
+=
PtSháB‘a
*
xij
/(
rij
*rij*rij)*PtiPŒ->
_r0
*PtiPŒ->_r0*
Maxv
;

252 
PtiPŒ
->
_PtSháCÛfv
+=
PtSháB‘a
*
yij
/(
rij
*rij*rij)*PtiPŒ->
_r0
*PtiPŒ->_r0*
Maxv
;

254 
PtjPŒ
->
_PtSháCÛfu
-=
PtSháB‘a
*
xij
/(
rij
*rij*rij)*PtjPŒ->
_r0
*PtjPŒ->_r0*
Maxv
;

255 
PtjPŒ
->
_PtSháCÛfv
-=
PtSháB‘a
*
yij
/(
rij
*rij*rij)*PtjPŒ->
_r0
*PtjPŒ->_r0*
Maxv
;

259 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

261 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

263 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

265 
Ba£PtPŒ
->
_x
+=(Ba£PtPŒ->
_uHf
+Ba£PtPŒ->
_PtSháCÛfu
)*
D–T1
;

266 
Ba£PtPŒ
->
_y
+=(Ba£PtPŒ->
_vHf
+Ba£PtPŒ->
_PtSháCÛfv
)*
D–T1
;

272 ià(
RegiÚ
.
_CÚŒŞSPH
.
_PtSháB‘a
!=0)

275 
Maxv
=0.0;

276 
i
=0;i!=
RegiÚ
.
_C®Li¡
.
	`size
();++i)

278 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

280 
vi
=
	`sq¹
(
RegiÚ
.
_PtLi¡
[
ID
].
_uHf
*RegiÚ._PtLi¡[ID]._uHf+RegiÚ._PtLi¡[ID].
_vHf
*Region._PtList[ID]._vHf);

282 ià(
vi
>
Maxv
)

284 
Maxv
=
vi
;

290 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

292 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

293 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

295 
rij
=
	`sq¹
(
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
);

297 
PtiPŒ
->
_r0
+=
rij
/PtiPŒ->
_NumNegbÜ
;

299 ià(
PtiPŒ
!=
PtjPŒ
)

301 
PtjPŒ
->
_r0
+=
rij
/PtjPŒ->
_NumNegbÜ
;

306 
PtSháB‘a
=
RegiÚ
.
_CÚŒŞSPH
.
_PtSháB‘a
;

307 
i
=0;i!=
RegiÚ
.
_PtPaœLi¡
.
	`size
();++i)

309 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtiPŒ
;

310 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
i
].
_PtjPŒ
;

312 ià(
PtiPŒ
!=
PtjPŒ
)

314 
rij
=
	`sq¹
(
RegiÚ
.
_PtPaœLi¡
[
i
].
_drŸc2
);

315 
xij
=
PtiPŒ
->
_x
-
PtjPŒ
->_x;

316 
yij
=
PtiPŒ
->
_y
-
PtjPŒ
->_y;

318 
PtiPŒ
->
_PtSháCÛfu
+=
PtSháB‘a
*
xij
/(
rij
*rij*rij)*PtiPŒ->
_r0
*PtiPŒ->_r0*
Maxv
;

319 
PtiPŒ
->
_PtSháCÛfv
+=
PtSháB‘a
*
yij
/(
rij
*rij*rij)*PtiPŒ->
_r0
*PtiPŒ->_r0*
Maxv
;

321 
PtjPŒ
->
_PtSháCÛfu
-=
PtSháB‘a
*
xij
/(
rij
*rij*rij)*PtjPŒ->
_r0
*PtjPŒ->_r0*
Maxv
;

322 
PtjPŒ
->
_PtSháCÛfv
-=
PtSháB‘a
*
yij
/(
rij
*rij*rij)*PtjPŒ->
_r0
*PtjPŒ->_r0*
Maxv
;

326 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

328 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

330 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

332 
Ba£PtPŒ
->
_x
+=(Ba£PtPŒ->
_uHf
+Ba£PtPŒ->
_PtSháCÛfu
)*
D–T1
;

333 
Ba£PtPŒ
->
_y
+=(Ba£PtPŒ->
_vHf
+Ba£PtPŒ->
_PtSháCÛfv
)*
D–T1
;

340 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

342 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

344 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

346 
Ba£PtPŒ
->
_x
+=Ba£PtPŒ->
_uHf
*
D–T1
;

347 
Ba£PtPŒ
->
_y
+=Ba£PtPŒ->
_vHf
*
D–T1
;

353 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

355 
Ba£PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

356 if(
Ba£PtPŒ
->
_Ty³
==
’SPHPt
)

358 
Ba£PtPŒ
->
_rho
=Ba£PtPŒ->
_rhoHf
+Ba£PtPŒ->
_drho
*
D–THf
;

359 
Ba£PtPŒ
->
_u
=Ba£PtPŒ->
_uHf
+Ba£PtPŒ->
_du
*
D–THf
;

360 
Ba£PtPŒ
->
_v
=Ba£PtPŒ->
_vHf
+Ba£PtPŒ->
_dv
*
D–THf
;

363 
Ba£PtPŒ
->
_h
=Ba£PtPŒ->
_hHf
+Ba£PtPŒ->
_dh
*
D–THf
;

364 
Ba£PtPŒ
->
_r
=2.0*Ba£PtPŒ->
_h
;

383 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

385 
MAXX
,
MINX
;

386 
dp
;

388 
dp
=
	`sq¹
(
RegiÚ
.
_PtLi¡
[0].
_VŞume
);

390 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

391 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

393 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

395 ià(
RegiÚ
.
_PtLi¡
[
i
].
_x
>=
MAXX
+
dp
)

397 
RegiÚ
.
_PtLi¡
[
i
].
_x
-=(
MAXX
-
MINX
);

485 
	}
}

487 
	gCUpd©ePos™iÚ
::
	$Im¶ic™Upd©e
(
CRegiÚ
 & 
RegiÚ
)

489 
i
,
j
;

490 
ID
,
ID2
;

491 
IDi
,
IDj
;

492 
CBa£Pt
 *
PtPŒ
;

493 
CBa£Pt
 * 
PtiPŒ
,*
PtjPŒ
;

494 
CKÆ
 * 
KÆPŒ
;

495 
uij
,
vij
;

496 
xx
;

497 
accu¿cy
;

498 
Av”Rho
;

499 
XSPHEpsÚ
;

502 if(
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
==0)

504 
i
=0;i<
RegiÚ
.
_PtLi¡
.
	`size
();i++)

506 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
i
];

508 if(
PtPŒ
->
_Ty³
==
’SPHPt
&&PtPŒ->
_Iæag
==1)

510 
ID
=
PtPŒ
->
_ID2
;

512 
PtPŒ
->
_x
+=0.5*
RegiÚ
.
_CÚŒŞSPH
.
_D–T
*(PtPŒ->
_u
+RegiÚ.
_SPHu
[
ID
-1]);

513 
PtPŒ
->
_y
+=0.5*
RegiÚ
.
_CÚŒŞSPH
.
_D–T
*(PtPŒ->
_v
+RegiÚ.
_SPHv
[
ID
-1]);

526 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

528 if((
RegiÚ
.
_PtLi¡
[
j
].
_Ty³
==
’SPHPt
||RegiÚ._PtLi¡[j]._Ty³==
’NULLPt
)&&RegiÚ._PtLi¡[j].
_Iæag
==1)

530 
RegiÚ
.
_PtLi¡
[
j
].
_uXSPHCÛf
=0.0;

531 
RegiÚ
.
_PtLi¡
[
j
].
_vXSPHCÛf
=0.0;

535 
j
=0;j<
RegiÚ
.
_PtPaœLi¡
.
	`size
();j++)

537 if(
RegiÚ
.
_PtPaœLi¡
[
j
].
_Ty³
!=
’SPHBndPtPaœ
)

539 
PtiPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtiPŒ
;

540 
PtjPŒ
=
RegiÚ
.
_PtPaœLi¡
[
j
].
_PtjPŒ
;

542 
KÆPŒ
=&
RegiÚ
.
_KÆLi¡
[
j
];

544 
IDi
=
PtiPŒ
->
_ID2
;

545 
IDj
=
PtjPŒ
->
_ID2
;

547 
uij
=0.5*(
PtiPŒ
->
_u
+
RegiÚ
.
_SPHu
[
IDi
-1])-0.5*(
PtjPŒ
->_u+RegiÚ._SPHu[
IDj
-1]);

548 
vij
=0.5*(
PtiPŒ
->
_v
+
RegiÚ
.
_SPHv
[
IDi
-1])-0.5*(
PtjPŒ
->_v+RegiÚ._SPHv[
IDj
-1]);

550 
Av”Rho
=0.5*(
PtiPŒ
->
_rho
+
PtjPŒ
->_rho);

552 
PtiPŒ
->
_uXSPHCÛf
+=
PtjPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

553 
PtiPŒ
->
_vXSPHCÛf
+=
PtjPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

555 if((
PtiPŒ
!=
PtjPŒ
)&&PtjPŒ->
_Ty³
==
’SPHPt
)

557 
PtjPŒ
->
_uXSPHCÛf
-=
PtiPŒ
->
_m
*
uij
*
KÆPŒ
->
_W
/
Av”Rho
;

558 
PtjPŒ
->
_vXSPHCÛf
-=
PtiPŒ
->
_m
*
vij
*
KÆPŒ
->
_W
/
Av”Rho
;

563 
XSPHEpsÚ
=
RegiÚ
.
_CÚŒŞSPH
.
_XSPHEpsÚ
;

565 
j
=0;j<
RegiÚ
.
_PtLi¡
.
	`size
();j++)

567 
PtPŒ
=&
RegiÚ
.
_PtLi¡
[
j
];

569 if(
RegiÚ
.
_PtLi¡
[
j
].
_Ty³
==
’SPHPt
&&RegiÚ._PtLi¡[j].
_Iæag
==1)

571 
ID
=
PtPŒ
->
_ID2
;

573 
PtPŒ
->
_x
+=(0.5*(PtPŒ->
_u
+
RegiÚ
.
_SPHu
[
ID
-1])-
XSPHEpsÚ
*PtPŒ->
_uXSPHCÛf
)*RegiÚ.
_CÚŒŞSPH
.
_D–T
;

574 
PtPŒ
->
_y
+=(0.5*(PtPŒ->
_v
+
RegiÚ
.
_SPHv
[
ID
-1])-
XSPHEpsÚ
*PtPŒ->
_vXSPHCÛf
)*RegiÚ.
_CÚŒŞSPH
.
_D–T
;

586 
i
=0;i<
RegiÚ
.
_C®Li¡
.
	`size
();i++)

588 
ID
=
RegiÚ
.
_C®Li¡
[
i
];

590 
RegiÚ
.
_PtLi¡
[
ID
].
_u
=RegiÚ.
_SPHu
[
i
];

591 
RegiÚ
.
_PtLi¡
[
ID
].
_v
=RegiÚ.
_SPHv
[
i
];

595 ià(
RegiÚ
.
_CÚŒŞSPH
.
_P”dBnd
==1)

597 
MAXX
,
MINX
;

598 
dp
;

600 
dp
=
	`sq¹
(
RegiÚ
.
_PtLi¡
[0].
_VŞume
);

602 
MAXX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMaxX
;

603 
MINX
=
RegiÚ
.
_CÚŒŞSPH
.
_P”dBndMšX
;

605 
i
=0;i!=
RegiÚ
.
_PtLi¡
.
	`size
();++i)

607 ià(
RegiÚ
.
_PtLi¡
[
i
].
_x
>=
MAXX
+
dp
)

609 
RegiÚ
.
_PtLi¡
[
i
].
_x
-=(
MAXX
-
MINX
);

651 
	}
}

	@UpdatePosition.h

16 #iâdeà
_UPDATEPOSITION_H_


17 
	#_UPDATEPOSITION_H_


	)

19 
	~"RegiÚ.h
"

20 
	~"D–T.h
"

21 
	~"SPHPt.h
"

22 
	~"Ba£Pt.h
"

23 
	~"KÆ.h
"

24 
	~<cm©h
>

26 şas 
	cCUpd©ePos™iÚ


28 
	mpublic
:

29 
CUpd©ePos™iÚ
();

31 ~
CUpd©ePos™iÚ
();

33 
L—pFrogUpd©e
(
CRegiÚ
 & 
RegiÚ
, 
D–T
,
D–T1
,
TimeS‹ps
);

35 
Im¶ic™Upd©e
(
CRegiÚ
 & 
RegiÚ
);

37 
	m´iv©e
:

	@WeaklyCompress.cpp

1 
	~"W—klyCom´ess.h
"

3 
	gCW—klyCom´ess
::
	$CW—klyCom´ess
(
P0
,
gamma
,
ExtP
,
EOSID
)

4 :
	`CEOS
(
’W—klyCom´ess
,
EOSID
),
	`_P0
(
P0
),
	`_gamma
(
gamma
),
	$_ExtP
(
ExtP
)

6 
	}
}

8 
	gCW—klyCom´ess
::~
	$CW—klyCom´ess
()

10 
	}
}

12 
CW—klyCom´ess
::
	$EOS
(
rho0
,
rho
,&
p
)

14 
rhŞ
;

15 
rhŞ
=
rho
/
rho0
;

16 
p
=
_P0
*(
	`pow
(
rhŞ
,
_gamma
)-1)+
_ExtP
;

17 
	}
}

19 
	gCW—klyCom´ess
::
	$EOS2
Ğ
cs
,
rho
,&
p
 )

22 
p
=
cs
*cs*
rho
;

24 
	}
}

	@WeaklyCompress.h

16 #iâdeà
_WEAKLYCOMPRESS_H_


17 
	#_WEAKLYCOMPRESS_H_


	)

19 
	~"EOS.h
"

20 
	~<cm©h
>

22 şas 
	cCW—klyCom´ess
:
public
 
CEOS


24 
public
:

25 
CW—klyCom´ess
(
P0
,
gamma
,
ExtP
,
EOSID
);

27 ~
CW—klyCom´ess
();

29 
	m_SurçûBoŞ
;

30 
	m_SurçûCÛff
;

32 
EOS
(
rho0
,
rho
,&
p
);

33 
EOS2
(
cs
,
rho
,&
p
);

35 
	m´iv©e
:

36 
_P0
;

38 
	m_gamma
;

40 
	m_ExtP
;

	@common.h

9 #iâdeà
_COMMON_H_


10 
	#_COMMON_H_


	)

12 
	~<m©h.h
>

13 
	~<æßt.h
>

15 
	#LOGICAL_TRUE
 1

	)

16 
	#LOGICAL_FALSE
 0

	)

17 
	#LOGICAL_ERROR
 -1

	)

19 
	#PI
 3.14159265358979323846264

	)

21 
	#LMAX
(
A
,
B
è((A)>(Bè? (A):(B))

	)

22 
	#LMIN
(
A
,
B
è((A)<(Bè? (A):(B))

	)

24 
	#LABS
(
X
è((Xè< 0 ? -(X):(X))

	)

26 
	#LSGN
(
X
è((Xè< 0 ? -(1):(1))

	)

28 
	#ISZERO
(
X
è(
	`çbs
(Xè< 10.0 * 
DBL_MIN
)

	)

29 
	#ISONE
(
X
è(
	`çbs
(X - 1.0è< 10.0 * 
DBL_EPSILON
)

	)

31 
	#SMALL
 1E-15

	)

32 
	#VSMALL
 1E-300

	)

34 
	#GREAT
 1E+15

	)

35 
	#VGREAT
 1E+300

	)

37 
	#MAXFACES
 6

	)

42 
	#NBPARTICLE
 2000

43 
	#NBGHOSTPARTICLE
 2000

44 
	#NBPARTICLEPAIR
 250000

45 
	#NBPART
 1

46 
	#NBSECTION
 2

47 
	#NBEXTFORCE
 1

48 

	)

49 
	#NBCELLX
 100

50 
	#NBCELLY
 40

51 
	#MINX
 0

52 
	#MAXX
 2.5e-3

53 
	#MINY
 0

54 
	#MAXY
 1.0E-3

55 

	)

56 
	#MshSizeX
 2.5E-5

57 
	#MshSizeY
 2.5E-5

58 

	)

59 
	#MaxPtP”Msh
 1

60 

	)

61 
	#SOR®phaP
 0.5

62 
	#SOR®phaU
 0.7

63 
	#SOR®phaV
 0.7

64 

	)

	@main.cpp

1 
	~"SPHSŞv”.h
"

3 
	$maš
()

6 
cout
<<
’dl
;

7 
cout
<<"*****************************************"<<
’dl
;

8 
cout
<<"* *"<<
’dl
;

9 
cout
<<"* SPH_2D C++ Ed™iÚ *"<<
’dl
;

10 
cout
<<"* by Rich¬d Liu *"<<
’dl
;

11 
cout
<<"* *"<<
’dl
;

12 
cout
<<"*****************************************"<<
’dl
;

13 
cout
<<
’dl
;

15 
CSPHSŞv”
 
¥hsŞv”
;

16 
¥hsŞv”
.
	`IÅut
();

17 
¥hsŞv”
.
	`Run
();

18 
¥hsŞv”
.
	`DÚe
();

19 
	}
}

	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 #ià
defšed
 
log
 && defšed 
__GNUC__


30 #w¬nšg 
A
 
maüo
 
ÿÎed
 
log
 
was
 
®»ady
 
defšed
 
wh’
 <
m©h
.
h
> wa 
šşuded
.

31 #w¬nšg 
This
 
wl
 
ÿu£
 
comp©iÚ
 
´obËms
.

34 
	g__BEGIN_DECLS


37 
	~<b™s/ty³s.h
>

40 
	~<b™s/m©h-veùÜ.h
>

43 
	~<b™s/æßŠ.h
>

47 #ià
__GNUC_PREREQ
 (3, 3)

48 
	#HUGE_VAL
 (
	`__butš_huge_v®
 ())

	)

55 
	#HUGE_VAL
 1e10000

	)

57 #ifdeà
__USE_ISOC99


58 #ià
__GNUC_PREREQ
 (3, 3)

59 
	#HUGE_VALF
 (
	`__butš_huge_v®f
 ())

	)

60 
	#HUGE_VALL
 (
	`__butš_huge_v®l
 ())

	)

62 
	#HUGE_VALF
 1e10000f

	)

63 
	#HUGE_VALL
 1e10000L

	)

66 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

67 
	#HUGE_VAL_F16
 (
	`__butš_huge_v®f16
 ())

	)

69 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

70 
	#HUGE_VAL_F32
 (
	`__butš_huge_v®f32
 ())

	)

72 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

73 
	#HUGE_VAL_F64
 (
	`__butš_huge_v®f64
 ())

	)

75 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

76 
	#HUGE_VAL_F128
 (
	`__butš_huge_v®f128
 ())

	)

78 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

79 
	#HUGE_VAL_F32X
 (
	`__butš_huge_v®f32x
 ())

	)

81 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

82 
	#HUGE_VAL_F64X
 (
	`__butš_huge_v®f64x
 ())

	)

84 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

85 
	#HUGE_VAL_F128X
 (
	`__butš_huge_v®f128x
 ())

	)

88 #ifdeà
__USE_ISOC99


90 #ià
__GNUC_PREREQ
 (3, 3)

91 
	#INFINITY
 (
	`__butš_šff
 ())

	)

93 
	#INFINITY
 
HUGE_VALF


	)

97 #ià
__GNUC_PREREQ
 (3, 3)

98 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

103 
	#NAN
 (0.0à/ 0.0f)

	)

107 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

109 #ià
__GNUC_PREREQ
 (3, 3)

110 
	#SNANF
 (
	`__butš_Çnsf
 (""))

	)

111 
	#SNAN
 (
	`__butš_Çns
 (""))

	)

112 
	#SNANL
 (
	`__butš_Çn¦
 (""))

	)

115 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

116 
	#SNANF16
 (
	`__butš_Çnsf16
 (""))

	)

118 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

119 
	#SNANF32
 (
	`__butš_Çnsf32
 (""))

	)

121 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

122 
	#SNANF64
 (
	`__butš_Çnsf64
 (""))

	)

124 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

125 
	#SNANF128
 (
	`__butš_Çnsf128
 (""))

	)

127 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

128 
	#SNANF32X
 (
	`__butš_Çnsf32x
 (""))

	)

130 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

131 
	#SNANF64X
 (
	`__butš_Çnsf64x
 (""))

	)

133 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
	#SNANF128X
 (
	`__butš_Çnsf128x
 (""))

	)

138 
	~<b™s/æt-ev®-m‘hod.h
>

140 #ifdeà
__USE_ISOC99


148 #ià
__GLIBC_FLT_EVAL_METHOD
 == 0 || __GLIBC_FLT_EVAL_METHOD == 16

149 
	tæßt_t
;

150 
	tdoubË_t
;

151 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 1

152 
	tæßt_t
;

153 
	tdoubË_t
;

154 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 2

155 
	tæßt_t
;

156 
	tdoubË_t
;

157 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 32

158 
_Flßt32
 
	tæßt_t
;

159 
	tdoubË_t
;

160 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 33

161 
_Flßt32x
 
	tæßt_t
;

162 
_Flßt32x
 
	tdoubË_t
;

163 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 64

164 
_Flßt64
 
	tæßt_t
;

165 
_Flßt64
 
	tdoubË_t
;

166 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 65

167 
_Flßt64x
 
	tæßt_t
;

168 
_Flßt64x
 
	tdoubË_t
;

169 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 128

170 
_Flßt128
 
	tæßt_t
;

171 
_Flßt128
 
	tdoubË_t
;

172 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 129

173 
_Flßt128x
 
	tæßt_t
;

174 
_Flßt128x
 
	tdoubË_t
;

190 
	~<b™s/å-logb.h
>

191 #ifdeà
__USE_ISOC99


192 #ià
__FP_LOGB0_IS_MIN


193 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

195 
	#FP_ILOGB0
 (-2147483647)

	)

197 #ià
__FP_LOGBNAN_IS_MIN


198 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

200 
	#FP_ILOGBNAN
 2147483647

	)

203 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

204 #ià
__WORDSIZE
 == 32

205 
	#__FP_LONG_MAX
 0x7fffffffL

	)

207 
	#__FP_LONG_MAX
 0x7fffffffffffffffL

	)

209 #ià
__FP_LOGB0_IS_MIN


210 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
 - 1)

	)

212 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
)

	)

214 #ià
__FP_LOGBNAN_IS_MIN


215 
	#FP_LLOGBNAN
 (-
__FP_LONG_MAX
 - 1)

	)

217 
	#FP_LLOGBNAN
 
__FP_LONG_MAX


	)

233 
	~<b™s/å-ç¡.h
>

235 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

239 
	mFP_INT_UPWARD
 =

240 
	#FP_INT_UPWARD
 0

	)

241 
FP_INT_UPWARD
,

242 
	mFP_INT_DOWNWARD
 =

243 
	#FP_INT_DOWNWARD
 1

	)

244 
FP_INT_DOWNWARD
,

245 
	mFP_INT_TOWARDZERO
 =

246 
	#FP_INT_TOWARDZERO
 2

	)

247 
FP_INT_TOWARDZERO
,

248 
	mFP_INT_TONEARESTFROMZERO
 =

249 
	#FP_INT_TONEARESTFROMZERO
 3

	)

250 
FP_INT_TONEARESTFROMZERO
,

251 
	mFP_INT_TONEAREST
 =

252 
	#FP_INT_TONEAREST
 4

	)

253 
FP_INT_TONEAREST
,

262 
	#__SIMD_DECL
(
funùiÚ
è
	`__CONCAT
 (
__DECL_SIMD_
, funùiÚ)

	)

264 
	#__MATHCALL_VEC
(
funùiÚ
, 
suffix
, 
¬gs
) \

265 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

266 
	`__MATHCALL
 (
funùiÚ
, 
suffix
, 
¬gs
)

	)

268 
	#__MATHDECL_VEC
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

269 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

270 
	`__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
)

	)

272 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

273 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

274 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

275 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

276 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

277 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

278 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

279 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

280 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

281 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

282 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

283 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

285 
	#_MdoubË_
 

	)

286 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

287 
	#__MATH_DECLARING_DOUBLE
 1

	)

288 
	#__MATH_DECLARING_FLOATN
 0

	)

289 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

290 
	~<b™s/m©hÿÎs.h
>

291 #undeà
_MdoubË_


292 #undeà
__MATH_PRECNAME


293 #undeà
__MATH_DECLARING_DOUBLE


294 #undeà
__MATH_DECLARING_FLOATN


296 #ifdeà
__USE_ISOC99


302 
	#_MdoubË_
 

	)

303 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

304 
	#__MATH_DECLARING_DOUBLE
 0

	)

305 
	#__MATH_DECLARING_FLOATN
 0

	)

306 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

307 
	~<b™s/m©hÿÎs.h
>

308 #undeà
_MdoubË_


309 #undeà
__MATH_PRECNAME


310 #undeà
__MATH_DECLARING_DOUBLE


311 #undeà
__MATH_DECLARING_FLOATN


313 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

314 || 
defšed
 
__LDBL_COMPAT
 \

315 || 
defšed
 
_LIBC_TEST


316 #ifdeà
__LDBL_COMPAT


318 #ifdeà
__USE_ISOC99


319 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

320 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

321 #ifdeà
__REDIRECT_NTH


322 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

323 
__Ædbl_Ãx‰ow¬df
)

324 
	`__©Œibu‹__
 ((
__cÚ¡__
));

325 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

326 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

327 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

328 (
__x
, 
__y
),

329 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

333 #undeà
__MATHDECL_1


334 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

335 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

336 
¬gs
, 
®Ÿs
)

	)

337 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

338 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

344 
	#_MdoubË_
 

	)

345 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

346 
	#__MATH_DECLARING_DOUBLE
 0

	)

347 
	#__MATH_DECLARING_FLOATN
 0

	)

348 
	#__MATH_DECLARE_LDOUBLE
 1

	)

349 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

350 
	~<b™s/m©hÿÎs.h
>

351 #undeà
_MdoubË_


352 #undeà
__MATH_PRECNAME


353 #undeà
__MATH_DECLARING_DOUBLE


354 #undeà
__MATH_DECLARING_FLOATN


363 #ià
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)

364 
	#_MdoubË_
 
_Flßt16


	)

365 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f16
##
	)
r

366 
	#__MATH_DECLARING_DOUBLE
 0

	)

367 
	#__MATH_DECLARING_FLOATN
 1

	)

368 #ià
__HAVE_DISTINCT_FLOAT16


369 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

371 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

372 
	~<b™s/m©hÿÎs.h
>

374 #undeà
_MdoubË_


375 #undeà
__MATH_PRECNAME


376 #undeà
__MATH_DECLARING_DOUBLE


377 #undeà
__MATH_DECLARING_FLOATN


380 #ià
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)

381 
	#_MdoubË_
 
_Flßt32


	)

382 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32
##
	)
r

383 
	#__MATH_DECLARING_DOUBLE
 0

	)

384 
	#__MATH_DECLARING_FLOATN
 1

	)

385 #ià
__HAVE_DISTINCT_FLOAT32


386 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

388 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

389 
	~<b™s/m©hÿÎs.h
>

391 #undeà
_MdoubË_


392 #undeà
__MATH_PRECNAME


393 #undeà
__MATH_DECLARING_DOUBLE


394 #undeà
__MATH_DECLARING_FLOATN


397 #ià
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)

398 
	#_MdoubË_
 
_Flßt64


	)

399 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64
##
	)
r

400 
	#__MATH_DECLARING_DOUBLE
 0

	)

401 
	#__MATH_DECLARING_FLOATN
 1

	)

402 #ià
__HAVE_DISTINCT_FLOAT64


403 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

405 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

406 
	~<b™s/m©hÿÎs.h
>

408 #undeà
_MdoubË_


409 #undeà
__MATH_PRECNAME


410 #undeà
__MATH_DECLARING_DOUBLE


411 #undeà
__MATH_DECLARING_FLOATN


414 #ià
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)

415 
	#_MdoubË_
 
_Flßt128


	)

416 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128
##
	)
r

417 
	#__MATH_DECLARING_DOUBLE
 0

	)

418 
	#__MATH_DECLARING_FLOATN
 1

	)

419 #ià
__HAVE_DISTINCT_FLOAT128


420 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

422 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

423 
	~<b™s/m©hÿÎs.h
>

425 #undeà
_MdoubË_


426 #undeà
__MATH_PRECNAME


427 #undeà
__MATH_DECLARING_DOUBLE


428 #undeà
__MATH_DECLARING_FLOATN


431 #ià
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)

432 
	#_MdoubË_
 
_Flßt32x


	)

433 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32x
##
	)
r

434 
	#__MATH_DECLARING_DOUBLE
 0

	)

435 
	#__MATH_DECLARING_FLOATN
 1

	)

436 #ià
__HAVE_DISTINCT_FLOAT32X


437 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

439 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

440 
	~<b™s/m©hÿÎs.h
>

442 #undeà
_MdoubË_


443 #undeà
__MATH_PRECNAME


444 #undeà
__MATH_DECLARING_DOUBLE


445 #undeà
__MATH_DECLARING_FLOATN


448 #ià
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)

449 
	#_MdoubË_
 
_Flßt64x


	)

450 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64x
##
	)
r

451 
	#__MATH_DECLARING_DOUBLE
 0

	)

452 
	#__MATH_DECLARING_FLOATN
 1

	)

453 #ià
__HAVE_DISTINCT_FLOAT64X


454 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

456 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

457 
	~<b™s/m©hÿÎs.h
>

459 #undeà
_MdoubË_


460 #undeà
__MATH_PRECNAME


461 #undeà
__MATH_DECLARING_DOUBLE


462 #undeà
__MATH_DECLARING_FLOATN


465 #ià
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)

466 
	#_MdoubË_
 
_Flßt128x


	)

467 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128x
##
	)
r

468 
	#__MATH_DECLARING_DOUBLE
 0

	)

469 
	#__MATH_DECLARING_FLOATN
 1

	)

470 #ià
__HAVE_DISTINCT_FLOAT128X


471 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

473 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

474 
	~<b™s/m©hÿÎs.h
>

476 #undeà
_MdoubË_


477 #undeà
__MATH_PRECNAME


478 #undeà
__MATH_DECLARING_DOUBLE


479 #undeà
__MATH_DECLARING_FLOATN


482 #undeà
__MATHDECL_1


483 #undeà
__MATHDECL


484 #undeà
__MATHCALL


487 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


489 
signgam
;

492 #ià(
__HAVE_DISTINCT_FLOAT16
 \

493 || 
__HAVE_DISTINCT_FLOAT32
 \

494 || 
__HAVE_DISTINCT_FLOAT64
 \

495 || 
__HAVE_DISTINCT_FLOAT32X
 \

496 || 
__HAVE_DISTINCT_FLOAT64X
 \

497 || 
__HAVE_DISTINCT_FLOAT128X
)

510 #ifdeà
__NO_LONG_DOUBLE_MATH


511 #ià
__HAVE_DISTINCT_FLOAT128


514 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

515 ( (
TG_ARG
è=ğ (è? 
FUNC
 ## 
f
 
ARGS
 : FUNC ARGS)

	)

516 #–ià
__HAVE_DISTINCT_FLOAT128


517 #ià
__HAVE_GENERIC_SELECTION


518 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT32


519 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
è
_Flßt32
: FUNC ## 
f
 ARGS,

	)

521 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
)

	)

523 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT64X


524 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


525 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
l
 ARGS,

	)

527 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
f128
 ARGS,

	)

530 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
)

	)

532 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

533 
	`_G’”ic
 ((
TG_ARG
), \

534 : 
FUNC
 ## 
f
 
ARGS
, \

535 
	`__MATH_TG_F32
 (
FUNC
, 
ARGS
) \

536 : 
FUNC
 
ARGS
, \

537 : 
FUNC
 ## 
l
 
ARGS
, \

538 
	`__MATH_TG_F64X
 (
FUNC
, 
ARGS
) \

539 
_Flßt128
: 
FUNC
 ## 
f128
 
ARGS
)

	)

541 #ià
__HAVE_FLOATN_NOT_TYPEDEF


544 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

545 
__butš_choo£_ex´
 \

546 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

547 
FUNC
 ## 
f
 
ARGS
, \

548 
__butš_choo£_ex´
 \

549 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

550 
FUNC
 
ARGS
, \

551 
__butš_choo£_ex´
 \

552 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

553 
FUNC
 ## 
l
 
ARGS
, \

554 
FUNC
 ## 
f128
 
ARGS
)))

	)

557 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

558 ( (
TG_ARG
) ==  () \

559 ? 
FUNC
 ## 
f
 
ARGS
 \

560 :  (
TG_ARG
) ==  () \

561 ? 
FUNC
 
ARGS
 \

562 : 
FUNC
 ## 
l
 
ARGS
)

	)

566 #ifdeà
__USE_ISOC99


571 
FP_NAN
 =

572 
	#FP_NAN
 0

	)

573 
FP_NAN
,

574 
FP_INFINITE
 =

575 
	#FP_INFINITE
 1

	)

576 
FP_INFINITE
,

577 
FP_ZERO
 =

578 
	#FP_ZERO
 2

	)

579 
FP_ZERO
,

580 
FP_SUBNORMAL
 =

581 
	#FP_SUBNORMAL
 3

	)

582 
FP_SUBNORMAL
,

583 
FP_NORMAL
 =

584 
	#FP_NORMAL
 4

	)

585 
FP_NORMAL


593 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__
 \

594 && (!
defšed
 
__OPTIMIZE_SIZE__
 || defšed 
__ılu¥lus
)

601 
	#åşassify
(
x
è
	`__butš_åşassify
 (
FP_NAN
, 
FP_INFINITE
, \

602 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

604 
	#åşassify
(
x
è
	`__MATH_TG
 ((x), 
__åşassify
, (x))

	)

608 #ià
	`__GNUC_PREREQ
 (6,0)

609 
	#signb™
(
x
è
	`__butš_signb™
 (x)

	)

610 #–ià
defšed
 
__ılu¥lus


618 
	#signb™
(
x
è
	`__butš_signb™l
 (x)

	)

619 #–ià
	`__GNUC_PREREQ
 (4,0)

620 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__butš_signb™
, (x))

	)

622 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__signb™
, (x))

	)

626 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


627 
	#isfš™e
(
x
è
	`__butš_isfš™e
 (x)

	)

629 
	#isfš™e
(
x
è
	`__MATH_TG
 ((x), 
__fš™e
, (x))

	)

633 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


634 
	#i¢Üm®
(
x
è
	`__butš_i¢Üm®
 (x)

	)

636 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

641 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


642 
	#i¢ª
(
x
è
	`__butš_i¢ª
 (x)

	)

644 
	#i¢ª
(
x
è
	`__MATH_TG
 ((x), 
__i¢ª
, (x))

	)

648 #ià
__HAVE_DISTINCT_FLOAT128
 && !
	`__GNUC_PREREQ
 (7,0) \

649 && !
defšed
 
__SUPPORT_SNAN__
 && !defšed 
__ılu¥lus


655 
	#isšf
(
x
) \

656 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
x
), 
_Flßt128
) \

657 ? 
	`__isšff128
 (
x
è: 
	`__butš_isšf_sign
 (x))

	)

658 #–ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


659 
	#isšf
(
x
è
	`__butš_isšf_sign
 (x)

	)

661 
	#isšf
(
x
è
	`__MATH_TG
 ((x), 
__isšf
, (x))

	)

665 
	#MATH_ERRNO
 1

	)

666 
	#MATH_ERREXCEPT
 2

	)

673 #ifdeà
__FAST_MATH__


674 
	#m©h_”rhªdlšg
 0

	)

675 #–ià
defšed
 
__NO_MATH_ERRNO__


676 
	#m©h_”rhªdlšg
 (
MATH_ERREXCEPT
)

	)

678 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

683 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

684 
	~<b™s/isÿnÚiÿl.h
>

687 #iâdeà
__ılu¥lus


688 
	#issigÇlšg
(
x
è
	`__MATH_TG
 ((x), 
__issigÇlšg
, (x))

	)

697 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšgf
 (__val); }

698 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšg
 (__val); }

699 
šlše
 

700 
	`issigÇlšg
 (
__v®
)

702 #ifdeà
__NO_LONG_DOUBLE_MATH


703  
	`__issigÇlšg
 (
__v®
);

705  
	`__issigÇlšgl
 (
__v®
);

708 #ià
__HAVE_DISTINCT_FLOAT128


709 
šlše
 
	`issigÇlšg
 (
_Flßt128
 
__v®
è{  
	`__issigÇlšgf128
 (__val); }

711 
	}
}

715 
	#issubnÜm®
(
x
è(
	`åşassify
 (xè=ğ
FP_SUBNORMAL
)

	)

718 #iâdeà
__ılu¥lus


719 #ifdeà
__SUPPORT_SNAN__


720 
	#isz”o
(
x
è(
	`åşassify
 (xè=ğ
FP_ZERO
)

	)

722 
	#isz”o
(
x
è(((
	`__ty³of
 (x)è(x)è=ğ0)

	)

726 #ifdeà
__SUPPORT_SNAN__


727 
šlše
 

728 
isz”o
 (
__v®
)

730  
__åşassifyf
 (
__v®
è=ğ
FP_ZERO
;

732 
šlše
 

733 
isz”o
 (
__v®
)

735  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

737 
šlše
 

738 
isz”o
 (
__v®
)

740 #ifdeà
__NO_LONG_DOUBLE_MATH


741  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

743  
__åşassifyl
 (
__v®
è=ğ
FP_ZERO
;

746 #ià
__HAVE_DISTINCT_FLOAT128


747 
šlše
 

748 
isz”o
 (
_Flßt128
 
__v®
)

750  
__åşassifyf128
 (
__v®
è=ğ
FP_ZERO
;

754 
‹m¶©e
 <
şass
 
__T
> 
šlše
 
boŞ


755 
isz”o
 (
__T
 
__v®
)

757  
__v®
 == 0;

764 #ifdeà
__USE_XOPEN


766 
	#MAXFLOAT
 3.40282347e+38F

	)

771 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


772 
	#M_E
 2.7182818284590452354

	)

773 
	#M_LOG2E
 1.4426950408889634074

	)

774 
	#M_LOG10E
 0.43429448190325182765

	)

775 
	#M_LN2
 0.69314718055994530942

	)

776 
	#M_LN10
 2.30258509299404568402

	)

777 
	#M_PI
 3.14159265358979323846

	)

778 
	#M_PI_2
 1.57079632679489661923

	)

779 
	#M_PI_4
 0.78539816339744830962

	)

780 
	#M_1_PI
 0.31830988618379067154

	)

781 
	#M_2_PI
 0.63661977236758134308

	)

782 
	#M_2_SQRTPI
 1.12837916709551257390

	)

783 
	#M_SQRT2
 1.41421356237309504880

	)

784 
	#M_SQRT1_2
 0.70710678118654752440

	)

790 #ifdeà
__USE_GNU


791 
	#M_El
 2.718281828459045235360287471352662498L

	)

792 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

793 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

794 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

795 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

796 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

797 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

798 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

799 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

800 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

801 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

802 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

803 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

806 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


807 
	#M_Ef16
 
	`__f16
 (2.718281828459045235360287471352662498è

	)

808 
	#M_LOG2Ef16
 
	`__f16
 (1.442695040888963407359924681001892137è

	)

809 
	#M_LOG10Ef16
 
	`__f16
 (0.434294481903251827651128918916605082è

	)

810 
	#M_LN2f16
 
	`__f16
 (0.693147180559945309417232121458176568è

	)

811 
	#M_LN10f16
 
	`__f16
 (2.302585092994045684017991454684364208è

	)

812 
	#M_PIf16
 
	`__f16
 (3.141592653589793238462643383279502884è

	)

813 
	#M_PI_2f16
 
	`__f16
 (1.570796326794896619231321691639751442è

	)

814 
	#M_PI_4f16
 
	`__f16
 (0.785398163397448309615660845819875721è

	)

815 
	#M_1_PIf16
 
	`__f16
 (0.318309886183790671537767526745028724è

	)

816 
	#M_2_PIf16
 
	`__f16
 (0.636619772367581343075535053490057448è

	)

817 
	#M_2_SQRTPIf16
 
	`__f16
 (1.128379167095512573896158903121545172è

	)

818 
	#M_SQRT2f16
 
	`__f16
 (1.414213562373095048801688724209698079è

	)

819 
	#M_SQRT1_2f16
 
	`__f16
 (0.707106781186547524400844362104849039è

	)

822 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


823 
	#M_Ef32
 
	`__f32
 (2.718281828459045235360287471352662498è

	)

824 
	#M_LOG2Ef32
 
	`__f32
 (1.442695040888963407359924681001892137è

	)

825 
	#M_LOG10Ef32
 
	`__f32
 (0.434294481903251827651128918916605082è

	)

826 
	#M_LN2f32
 
	`__f32
 (0.693147180559945309417232121458176568è

	)

827 
	#M_LN10f32
 
	`__f32
 (2.302585092994045684017991454684364208è

	)

828 
	#M_PIf32
 
	`__f32
 (3.141592653589793238462643383279502884è

	)

829 
	#M_PI_2f32
 
	`__f32
 (1.570796326794896619231321691639751442è

	)

830 
	#M_PI_4f32
 
	`__f32
 (0.785398163397448309615660845819875721è

	)

831 
	#M_1_PIf32
 
	`__f32
 (0.318309886183790671537767526745028724è

	)

832 
	#M_2_PIf32
 
	`__f32
 (0.636619772367581343075535053490057448è

	)

833 
	#M_2_SQRTPIf32
 
	`__f32
 (1.128379167095512573896158903121545172è

	)

834 
	#M_SQRT2f32
 
	`__f32
 (1.414213562373095048801688724209698079è

	)

835 
	#M_SQRT1_2f32
 
	`__f32
 (0.707106781186547524400844362104849039è

	)

838 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


839 
	#M_Ef64
 
	`__f64
 (2.718281828459045235360287471352662498è

	)

840 
	#M_LOG2Ef64
 
	`__f64
 (1.442695040888963407359924681001892137è

	)

841 
	#M_LOG10Ef64
 
	`__f64
 (0.434294481903251827651128918916605082è

	)

842 
	#M_LN2f64
 
	`__f64
 (0.693147180559945309417232121458176568è

	)

843 
	#M_LN10f64
 
	`__f64
 (2.302585092994045684017991454684364208è

	)

844 
	#M_PIf64
 
	`__f64
 (3.141592653589793238462643383279502884è

	)

845 
	#M_PI_2f64
 
	`__f64
 (1.570796326794896619231321691639751442è

	)

846 
	#M_PI_4f64
 
	`__f64
 (0.785398163397448309615660845819875721è

	)

847 
	#M_1_PIf64
 
	`__f64
 (0.318309886183790671537767526745028724è

	)

848 
	#M_2_PIf64
 
	`__f64
 (0.636619772367581343075535053490057448è

	)

849 
	#M_2_SQRTPIf64
 
	`__f64
 (1.128379167095512573896158903121545172è

	)

850 
	#M_SQRT2f64
 
	`__f64
 (1.414213562373095048801688724209698079è

	)

851 
	#M_SQRT1_2f64
 
	`__f64
 (0.707106781186547524400844362104849039è

	)

854 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


855 
	#M_Ef128
 
	`__f128
 (2.718281828459045235360287471352662498è

	)

856 
	#M_LOG2Ef128
 
	`__f128
 (1.442695040888963407359924681001892137è

	)

857 
	#M_LOG10Ef128
 
	`__f128
 (0.434294481903251827651128918916605082è

	)

858 
	#M_LN2f128
 
	`__f128
 (0.693147180559945309417232121458176568è

	)

859 
	#M_LN10f128
 
	`__f128
 (2.302585092994045684017991454684364208è

	)

860 
	#M_PIf128
 
	`__f128
 (3.141592653589793238462643383279502884è

	)

861 
	#M_PI_2f128
 
	`__f128
 (1.570796326794896619231321691639751442è

	)

862 
	#M_PI_4f128
 
	`__f128
 (0.785398163397448309615660845819875721è

	)

863 
	#M_1_PIf128
 
	`__f128
 (0.318309886183790671537767526745028724è

	)

864 
	#M_2_PIf128
 
	`__f128
 (0.636619772367581343075535053490057448è

	)

865 
	#M_2_SQRTPIf128
 
	`__f128
 (1.128379167095512573896158903121545172è

	)

866 
	#M_SQRT2f128
 
	`__f128
 (1.414213562373095048801688724209698079è

	)

867 
	#M_SQRT1_2f128
 
	`__f128
 (0.707106781186547524400844362104849039è

	)

870 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


871 
	#M_Ef32x
 
	`__f32x
 (2.718281828459045235360287471352662498è

	)

872 
	#M_LOG2Ef32x
 
	`__f32x
 (1.442695040888963407359924681001892137è

	)

873 
	#M_LOG10Ef32x
 
	`__f32x
 (0.434294481903251827651128918916605082è

	)

874 
	#M_LN2f32x
 
	`__f32x
 (0.693147180559945309417232121458176568è

	)

875 
	#M_LN10f32x
 
	`__f32x
 (2.302585092994045684017991454684364208è

	)

876 
	#M_PIf32x
 
	`__f32x
 (3.141592653589793238462643383279502884è

	)

877 
	#M_PI_2f32x
 
	`__f32x
 (1.570796326794896619231321691639751442è

	)

878 
	#M_PI_4f32x
 
	`__f32x
 (0.785398163397448309615660845819875721è

	)

879 
	#M_1_PIf32x
 
	`__f32x
 (0.318309886183790671537767526745028724è

	)

880 
	#M_2_PIf32x
 
	`__f32x
 (0.636619772367581343075535053490057448è

	)

881 
	#M_2_SQRTPIf32x
 
	`__f32x
 (1.128379167095512573896158903121545172è

	)

882 
	#M_SQRT2f32x
 
	`__f32x
 (1.414213562373095048801688724209698079è

	)

883 
	#M_SQRT1_2f32x
 
	`__f32x
 (0.707106781186547524400844362104849039è

	)

886 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


887 
	#M_Ef64x
 
	`__f64x
 (2.718281828459045235360287471352662498è

	)

888 
	#M_LOG2Ef64x
 
	`__f64x
 (1.442695040888963407359924681001892137è

	)

889 
	#M_LOG10Ef64x
 
	`__f64x
 (0.434294481903251827651128918916605082è

	)

890 
	#M_LN2f64x
 
	`__f64x
 (0.693147180559945309417232121458176568è

	)

891 
	#M_LN10f64x
 
	`__f64x
 (2.302585092994045684017991454684364208è

	)

892 
	#M_PIf64x
 
	`__f64x
 (3.141592653589793238462643383279502884è

	)

893 
	#M_PI_2f64x
 
	`__f64x
 (1.570796326794896619231321691639751442è

	)

894 
	#M_PI_4f64x
 
	`__f64x
 (0.785398163397448309615660845819875721è

	)

895 
	#M_1_PIf64x
 
	`__f64x
 (0.318309886183790671537767526745028724è

	)

896 
	#M_2_PIf64x
 
	`__f64x
 (0.636619772367581343075535053490057448è

	)

897 
	#M_2_SQRTPIf64x
 
	`__f64x
 (1.128379167095512573896158903121545172è

	)

898 
	#M_SQRT2f64x
 
	`__f64x
 (1.414213562373095048801688724209698079è

	)

899 
	#M_SQRT1_2f64x
 
	`__f64x
 (0.707106781186547524400844362104849039è

	)

902 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


909 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


910 
	#__NO_MATH_INLINES
 1

	)

913 #ifdeà
__USE_ISOC99


914 #ià
__GNUC_PREREQ
 (3, 1)

921 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

922 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

923 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

924 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

925 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

926 
	#isunÜd”ed
(
x
, 
y
è
	`__butš_isunÜd”ed
(x, y)

	)

928 
	#isg»©”
(
x
, 
y
) \

929 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

930 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; }))

	)

931 
	#isg»©”equ®
(
x
, 
y
) \

932 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

933 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

934 
	#i¦ess
(
x
, 
y
) \

935 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

936 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

937 
	#i¦es£qu®
(
x
, 
y
) \

938 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

939 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

940 
	#i¦essg»©”
(
x
, 
y
) \

941 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

942 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x !ğ__y; }))

	)

944 
	#isunÜd”ed
(
x
, 
y
) \

945 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__u
 = (x); __ty³of__ (
y
è
__v
 = (y); \

946 
__u
 !ğ
__v
 && (__u !ğ__u || __v !ğ__v); }))

	)

951 #ifdeà
__USE_EXTERN_INLINES


952 
	~<b™s/m©hšlše.h
>

957 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

960 
	#_MdoubË_
 

	)

961 
	#__MATH_DECLARING_DOUBLE
 1

	)

962 
	#__MATH_DECLARING_FLOATN
 0

	)

963 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

964 
funùiÚ
 ## 
»’Œªt


	)

965 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

966 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

967 
	~<b™s/m©h-fš™e.h
>

968 #undeà
_MdoubË_


969 #undeà
__MATH_DECLARING_DOUBLE


970 #undeà
__MATH_DECLARING_FLOATN


971 #undeà
__REDIRFROM_X


972 #undeà
__REDIRTO_X


976 #ifdeà
__USE_ISOC99


979 
	#_MdoubË_
 

	)

980 
	#__MATH_DECLARING_DOUBLE
 0

	)

981 
	#__MATH_DECLARING_FLOATN
 0

	)

982 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

983 
funùiÚ
 ## 
f
 ## 
»’Œªt


	)

984 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

985 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

986 
	~<b™s/m©h-fš™e.h
>

987 #undeà
_MdoubË_


988 #undeà
__MATH_DECLARING_DOUBLE


989 #undeà
__MATH_DECLARING_FLOATN


990 #undeà
__REDIRFROM_X


991 #undeà
__REDIRTO_X


994 #ifdeà
__MATH_DECLARE_LDOUBLE


995 
	#_MdoubË_
 

	)

996 
	#__MATH_DECLARING_DOUBLE
 0

	)

997 
	#__MATH_DECLARING_FLOATN
 0

	)

998 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

999 
funùiÚ
 ## 
l
 ## 
»’Œªt


	)

1000 #ifdeà
__NO_LONG_DOUBLE_MATH


1001 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1002 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1004 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1005 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1007 
	~<b™s/m©h-fš™e.h
>

1008 #undeà
_MdoubË_


1009 #undeà
__MATH_DECLARING_DOUBLE


1010 #undeà
__MATH_DECLARING_FLOATN


1011 #undeà
__REDIRFROM_X


1012 #undeà
__REDIRTO_X


1019 #ià(
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)) \

1020 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1021 
	#_MdoubË_
 
_Flßt16


	)

1022 
	#__MATH_DECLARING_DOUBLE
 0

	)

1023 
	#__MATH_DECLARING_FLOATN
 1

	)

1024 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1025 
funùiÚ
 ## 
f16
 ## 
»’Œªt


	)

1026 #ià
__HAVE_DISTINCT_FLOAT16


1027 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1028 
__
 ## 
funùiÚ
 ## 
f16
 ## 
»’Œªt
 ## 
_fš™e


	)

1032 
	~<b™s/m©h-fš™e.h
>

1033 #undeà
_MdoubË_


1034 #undeà
__MATH_DECLARING_DOUBLE


1035 #undeà
__MATH_DECLARING_FLOATN


1036 #undeà
__REDIRFROM_X


1037 #undeà
__REDIRTO_X


1040 #ià(
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)) \

1041 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1042 
	#_MdoubË_
 
_Flßt32


	)

1043 
	#__MATH_DECLARING_DOUBLE
 0

	)

1044 
	#__MATH_DECLARING_FLOATN
 1

	)

1045 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1046 
funùiÚ
 ## 
f32
 ## 
»’Œªt


	)

1047 #ià
__HAVE_DISTINCT_FLOAT32


1048 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1049 
__
 ## 
funùiÚ
 ## 
f32
 ## 
»’Œªt
 ## 
_fš™e


	)

1051 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1052 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

1054 
	~<b™s/m©h-fš™e.h
>

1055 #undeà
_MdoubË_


1056 #undeà
__MATH_DECLARING_DOUBLE


1057 #undeà
__MATH_DECLARING_FLOATN


1058 #undeà
__REDIRFROM_X


1059 #undeà
__REDIRTO_X


1062 #ià(
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)) \

1063 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1064 
	#_MdoubË_
 
_Flßt64


	)

1065 
	#__MATH_DECLARING_DOUBLE
 0

	)

1066 
	#__MATH_DECLARING_FLOATN
 1

	)

1067 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1068 
funùiÚ
 ## 
f64
 ## 
»’Œªt


	)

1069 #ià
__HAVE_DISTINCT_FLOAT64


1070 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1071 
__
 ## 
funùiÚ
 ## 
f64
 ## 
»’Œªt
 ## 
_fš™e


	)

1073 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1074 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1076 
	~<b™s/m©h-fš™e.h
>

1077 #undeà
_MdoubË_


1078 #undeà
__MATH_DECLARING_DOUBLE


1079 #undeà
__MATH_DECLARING_FLOATN


1080 #undeà
__REDIRFROM_X


1081 #undeà
__REDIRTO_X


1084 #ià(
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)) \

1085 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1086 
	#_MdoubË_
 
_Flßt128


	)

1087 
	#__MATH_DECLARING_DOUBLE
 0

	)

1088 
	#__MATH_DECLARING_FLOATN
 1

	)

1089 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1090 
funùiÚ
 ## 
f128
 ## 
»’Œªt


	)

1091 #ià
__HAVE_DISTINCT_FLOAT128


1092 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1093 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1095 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1096 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1098 
	~<b™s/m©h-fš™e.h
>

1099 #undeà
_MdoubË_


1100 #undeà
__MATH_DECLARING_DOUBLE


1101 #undeà
__MATH_DECLARING_FLOATN


1102 #undeà
__REDIRFROM_X


1103 #undeà
__REDIRTO_X


1106 #ià(
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)) \

1107 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1108 
	#_MdoubË_
 
_Flßt32x


	)

1109 
	#__MATH_DECLARING_DOUBLE
 0

	)

1110 
	#__MATH_DECLARING_FLOATN
 1

	)

1111 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1112 
funùiÚ
 ## 
f32x
 ## 
»’Œªt


	)

1113 #ià
__HAVE_DISTINCT_FLOAT32X


1114 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1115 
__
 ## 
funùiÚ
 ## 
f32x
 ## 
»’Œªt
 ## 
_fš™e


	)

1117 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1118 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1120 
	~<b™s/m©h-fš™e.h
>

1121 #undeà
_MdoubË_


1122 #undeà
__MATH_DECLARING_DOUBLE


1123 #undeà
__MATH_DECLARING_FLOATN


1124 #undeà
__REDIRFROM_X


1125 #undeà
__REDIRTO_X


1128 #ià(
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)) \

1129 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1130 
	#_MdoubË_
 
_Flßt64x


	)

1131 
	#__MATH_DECLARING_DOUBLE
 0

	)

1132 
	#__MATH_DECLARING_FLOATN
 1

	)

1133 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1134 
funùiÚ
 ## 
f64x
 ## 
»’Œªt


	)

1135 #ià
__HAVE_DISTINCT_FLOAT64X


1136 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1137 
__
 ## 
funùiÚ
 ## 
f64x
 ## 
»’Œªt
 ## 
_fš™e


	)

1138 #–ià
__HAVE_FLOAT64X_LONG_DOUBLE


1139 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1140 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1142 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1143 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1145 
	~<b™s/m©h-fš™e.h
>

1146 #undeà
_MdoubË_


1147 #undeà
__MATH_DECLARING_DOUBLE


1148 #undeà
__MATH_DECLARING_FLOATN


1149 #undeà
__REDIRFROM_X


1150 #undeà
__REDIRTO_X


1153 #ià(
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)) \

1154 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1155 
	#_MdoubË_
 
_Flßt128x


	)

1156 
	#__MATH_DECLARING_DOUBLE
 0

	)

1157 
	#__MATH_DECLARING_FLOATN
 1

	)

1158 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1159 
funùiÚ
 ## 
f128x
 ## 
»’Œªt


	)

1160 #ià
__HAVE_DISTINCT_FLOAT128X


1161 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1162 
__
 ## 
funùiÚ
 ## 
f128x
 ## 
»’Œªt
 ## 
_fš™e


	)

1166 
	~<b™s/m©h-fš™e.h
>

1167 #undeà
_MdoubË_


1168 #undeà
__MATH_DECLARING_DOUBLE


1169 #undeà
__MATH_DECLARING_FLOATN


1170 #undeà
__REDIRFROM_X


1171 #undeà
__REDIRTO_X


1176 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

1179 #ià
__FLT_EVAL_METHOD__
 == 2 || __FLT_EVAL_METHOD__ > 64

1180 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0L)

	)

1181 #–ià
__FLT_EVAL_METHOD__
 == 1 || __FLT_EVAL_METHOD__ > 32

1182 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0)

	)

1183 #–ià
__FLT_EVAL_METHOD__
 == 0 || __FLT_EVAL_METHOD__ == 32

1184 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0f)

	)

1186 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (y))

	)

1191 #ià!
defšed
 
__ılu¥lus
 || (__ılu¥lu < 201103L && !defšed 
__GNUC__
)

1192 
	#i£qsig
(
x
, 
y
) \

1193 
	`__MATH_TG
 (
	`__MATH_EVAL_FMT2
 (
x
, 
y
), 
__i£qsig
, ((x), (y)))

	)

1206 
‹m¶©e
<
ty³Çme
> 
__i£qsig_ty³
;

1208 
‹m¶©e
<> 
__i£qsig_ty³
<>

1210 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1212  
	`__i£qsigf
 (
__x
, 
__y
);

1216 
‹m¶©e
<> 
__i£qsig_ty³
<>

1218 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1220  
	`__i£qsig
 (
__x
, 
__y
);

1224 
‹m¶©e
<> 
__i£qsig_ty³
<>

1226 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1228 #iâdeà
__NO_LONG_DOUBLE_MATH


1229  
	`__i£qsigl
 (
__x
, 
__y
);

1231  
	`__i£qsig
 (
__x
, 
__y
);

1236 #ià
__HAVE_DISTINCT_FLOAT128


1237 
‹m¶©e
<> 
__i£qsig_ty³
<
_Flßt128
>

1239 
	`__ÿÎ
 (
_Flßt128
 
__x
, _Flßt128 
__y
è
	`throw
 ()

1241  
	`__i£qsigf128
 (
__x
, 
__y
);

1246 
‹m¶©e
<
ty³Çme
 
_T1
,y³Çm
_T2
>

1247 
šlše
 

1248 
	`i£qsig
 (
_T1
 
__x
, 
_T2
 
__y
è
	`throw
 ()

1250 #ià
__ılu¥lus
 >= 201103L

1251 
	`deşty³
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1253 
	`__ty³of
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1255  
__i£qsig_ty³
<
_T3
>::
	`__ÿÎ
 (
__x
, 
__y
);

1258 
	}
}

1263 
__END_DECLS


	@
1
.
1
/usr/include
115
1434
BaseGridNode.cpp
BaseGridNode.h
BasePt.cpp
BasePt.h
BndForce.cpp
BndForce.h
Box.cpp
Box.h
CSPM.cpp
CSPM.h
CalBndNorm.cpp
CalBndNorm.h
CalculateRange.cpp
CalculateRange.h
ContinuityEqu.cpp
ContinuityEqu.h
ControlSPH.cpp
ControlSPH.h
DeltaT.cpp
DeltaT.h
EOS.cpp
EOS.h
EquSolve.cpp
EquSolve.h
ExtForce.cpp
ExtForce.h
Force.cpp
Force.h
GetDumProperty.cpp
GetDumProperty.h
GetKnlList.cpp
GetKnlList.h
IdealGas.cpp
IdealGas.h
IdentPtLocal.cpp
IdentPtLocal.h
KFile.cpp
KFile.h
Knl.cpp
Knl.h
Matrix.cpp
Matrix.h
Mesh.cpp
Mesh.h
Model.cpp
Model.h
NblSch.cpp
NblSch.h
Node.cpp
Node.h
Operator.cpp
Operator.h
Part.cpp
Part.h
PtMshPair.cpp
PtMshPair.h
PtOperate.cpp
PtOperate.h
PtPair.cpp
PtPair.h
Region.cpp
Region.h
Remesh.cpp
Remesh.h
SPHAStress.cpp
SPHAStress.h
SPHAVForce.cpp
SPHAVForce.h
SPHBndPt.cpp
SPHBndPt.h
SPHEHD.cpp
SPHEHD.h
SPHEOS.cpp
SPHEOS.h
SPHEqu.cpp
SPHEqu.h
SPHIPCS.cpp
SPHIPCS.h
SPHIPCSEqu.cpp
SPHIPCSEqu.h
SPHInit.cpp
SPHInit.h
SPHPressure.cpp
SPHPressure.h
SPHPt.cpp
SPHPt.h
SPHSTForce.cpp
SPHSTForce.h
SPHShearingForce.cpp
SPHShearingForce.h
SPHSmoothingEqu.cpp
SPHSmoothingEqu.h
SPHSolver.cpp
SPHSolver.h
SPHViscoelastic.cpp
SPHViscoelastic.h
SPHViscosity.cpp
SPHViscosity.h
Section.cpp
Section.h
SectionNULL.cpp
SectionNULL.h
SectionSPH.cpp
SectionSPH.h
StatData.cpp
StatData.h
UnsteadyTerm.cpp
UnsteadyTerm.h
UpdatePosition.cpp
UpdatePosition.h
WeaklyCompress.cpp
WeaklyCompress.h
common.h
main.cpp
/usr/include/math.h
